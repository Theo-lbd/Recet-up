function dS(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function hS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var z_={exports:{}},Vu={},B_={exports:{}},ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xa=Symbol.for("react.element"),fS=Symbol.for("react.portal"),pS=Symbol.for("react.fragment"),mS=Symbol.for("react.strict_mode"),gS=Symbol.for("react.profiler"),yS=Symbol.for("react.provider"),vS=Symbol.for("react.context"),_S=Symbol.for("react.forward_ref"),wS=Symbol.for("react.suspense"),xS=Symbol.for("react.memo"),ES=Symbol.for("react.lazy"),xy=Symbol.iterator;function IS(t){return t===null||typeof t!="object"?null:(t=xy&&t[xy]||t["@@iterator"],typeof t=="function"?t:null)}var $_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},q_=Object.assign,K_={};function so(t,e,n){this.props=t,this.context=e,this.refs=K_,this.updater=n||$_}so.prototype.isReactComponent={};so.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};so.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function G_(){}G_.prototype=so.prototype;function gp(t,e,n){this.props=t,this.context=e,this.refs=K_,this.updater=n||$_}var yp=gp.prototype=new G_;yp.constructor=gp;q_(yp,so.prototype);yp.isPureReactComponent=!0;var Ey=Array.isArray,W_=Object.prototype.hasOwnProperty,vp={current:null},H_={key:!0,ref:!0,__self:!0,__source:!0};function Q_(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)W_.call(e,r)&&!H_.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),d=0;d<a;d++)l[d]=arguments[d+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Xa,type:t,key:i,ref:o,props:s,_owner:vp.current}}function TS(t,e){return{$$typeof:Xa,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function _p(t){return typeof t=="object"&&t!==null&&t.$$typeof===Xa}function SS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Iy=/\/+/g;function eh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?SS(""+t.key):e.toString(36)}function uc(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Xa:case fS:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+eh(o,0):r,Ey(s)?(n="",t!=null&&(n=t.replace(Iy,"$&/")+"/"),uc(s,e,n,"",function(d){return d})):s!=null&&(_p(s)&&(s=TS(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Iy,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Ey(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+eh(i,a);o+=uc(i,e,n,l,s)}else if(l=IS(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+eh(i,a++),o+=uc(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Fl(t,e,n){if(t==null)return t;var r=[],s=0;return uc(t,r,"","",function(i){return e.call(n,i,s++)}),r}function kS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Et={current:null},dc={transition:null},bS={ReactCurrentDispatcher:Et,ReactCurrentBatchConfig:dc,ReactCurrentOwner:vp};function J_(){throw Error("act(...) is not supported in production builds of React.")}ie.Children={map:Fl,forEach:function(t,e,n){Fl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Fl(t,function(){e++}),e},toArray:function(t){return Fl(t,function(e){return e})||[]},only:function(t){if(!_p(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ie.Component=so;ie.Fragment=pS;ie.Profiler=gS;ie.PureComponent=gp;ie.StrictMode=mS;ie.Suspense=wS;ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bS;ie.act=J_;ie.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=q_({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=vp.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)W_.call(e,l)&&!H_.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var d=0;d<l;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:Xa,type:t.type,key:s,ref:i,props:r,_owner:o}};ie.createContext=function(t){return t={$$typeof:vS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:yS,_context:t},t.Consumer=t};ie.createElement=Q_;ie.createFactory=function(t){var e=Q_.bind(null,t);return e.type=t,e};ie.createRef=function(){return{current:null}};ie.forwardRef=function(t){return{$$typeof:_S,render:t}};ie.isValidElement=_p;ie.lazy=function(t){return{$$typeof:ES,_payload:{_status:-1,_result:t},_init:kS}};ie.memo=function(t,e){return{$$typeof:xS,type:t,compare:e===void 0?null:e}};ie.startTransition=function(t){var e=dc.transition;dc.transition={};try{t()}finally{dc.transition=e}};ie.unstable_act=J_;ie.useCallback=function(t,e){return Et.current.useCallback(t,e)};ie.useContext=function(t){return Et.current.useContext(t)};ie.useDebugValue=function(){};ie.useDeferredValue=function(t){return Et.current.useDeferredValue(t)};ie.useEffect=function(t,e){return Et.current.useEffect(t,e)};ie.useId=function(){return Et.current.useId()};ie.useImperativeHandle=function(t,e,n){return Et.current.useImperativeHandle(t,e,n)};ie.useInsertionEffect=function(t,e){return Et.current.useInsertionEffect(t,e)};ie.useLayoutEffect=function(t,e){return Et.current.useLayoutEffect(t,e)};ie.useMemo=function(t,e){return Et.current.useMemo(t,e)};ie.useReducer=function(t,e,n){return Et.current.useReducer(t,e,n)};ie.useRef=function(t){return Et.current.useRef(t)};ie.useState=function(t){return Et.current.useState(t)};ie.useSyncExternalStore=function(t,e,n){return Et.current.useSyncExternalStore(t,e,n)};ie.useTransition=function(){return Et.current.useTransition()};ie.version="18.3.1";B_.exports=ie;var C=B_.exports;const Lr=hS(C),AS=dS({__proto__:null,default:Lr},[C]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RS=C,NS=Symbol.for("react.element"),CS=Symbol.for("react.fragment"),PS=Object.prototype.hasOwnProperty,DS=RS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,jS={key:!0,ref:!0,__self:!0,__source:!0};function Y_(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)PS.call(e,r)&&!jS.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:NS,type:t,key:i,ref:o,props:s,_owner:DS.current}}Vu.Fragment=CS;Vu.jsx=Y_;Vu.jsxs=Y_;z_.exports=Vu;var u=z_.exports,X_={exports:{}},qt={},Z_={exports:{}},ew={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,K){var J=F.length;F.push(K);e:for(;0<J;){var ne=J-1>>>1,ye=F[ne];if(0<s(ye,K))F[ne]=K,F[J]=ye,J=ne;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var K=F[0],J=F.pop();if(J!==K){F[0]=J;e:for(var ne=0,ye=F.length,Oe=ye>>>1;ne<Oe;){var Cn=2*(ne+1)-1,Pn=F[Cn],Dn=Cn+1,jn=F[Dn];if(0>s(Pn,J))Dn<ye&&0>s(jn,Pn)?(F[ne]=jn,F[Dn]=J,ne=Dn):(F[ne]=Pn,F[Cn]=J,ne=Cn);else if(Dn<ye&&0>s(jn,J))F[ne]=jn,F[Dn]=J,ne=Dn;else break e}}return K}function s(F,K){var J=F.sortIndex-K.sortIndex;return J!==0?J:F.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],d=[],h=1,p=null,g=3,v=!1,T=!1,b=!1,E=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(F){for(var K=n(d);K!==null;){if(K.callback===null)r(d);else if(K.startTime<=F)r(d),K.sortIndex=K.expirationTime,e(l,K);else break;K=n(d)}}function P(F){if(b=!1,I(F),!T)if(n(l)!==null)T=!0,ee(O);else{var K=n(d);K!==null&&ue(P,K.startTime-F)}}function O(F,K){T=!1,b&&(b=!1,_(x),x=-1),v=!0;var J=g;try{for(I(K),p=n(l);p!==null&&(!(p.expirationTime>K)||F&&!N());){var ne=p.callback;if(typeof ne=="function"){p.callback=null,g=p.priorityLevel;var ye=ne(p.expirationTime<=K);K=t.unstable_now(),typeof ye=="function"?p.callback=ye:p===n(l)&&r(l),I(K)}else r(l);p=n(l)}if(p!==null)var Oe=!0;else{var Cn=n(d);Cn!==null&&ue(P,Cn.startTime-K),Oe=!1}return Oe}finally{p=null,g=J,v=!1}}var L=!1,S=null,x=-1,k=5,R=-1;function N(){return!(t.unstable_now()-R<k)}function D(){if(S!==null){var F=t.unstable_now();R=F;var K=!0;try{K=S(!0,F)}finally{K?A():(L=!1,S=null)}}else L=!1}var A;if(typeof y=="function")A=function(){y(D)};else if(typeof MessageChannel<"u"){var rt=new MessageChannel,Zt=rt.port2;rt.port1.onmessage=D,A=function(){Zt.postMessage(null)}}else A=function(){E(D,0)};function ee(F){S=F,L||(L=!0,A())}function ue(F,K){x=E(function(){F(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){T||v||(T=!0,ee(O))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(F){switch(g){case 1:case 2:case 3:var K=3;break;default:K=g}var J=g;g=K;try{return F()}finally{g=J}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,K){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var J=g;g=F;try{return K()}finally{g=J}},t.unstable_scheduleCallback=function(F,K,J){var ne=t.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?ne+J:ne):J=ne,F){case 1:var ye=-1;break;case 2:ye=250;break;case 5:ye=1073741823;break;case 4:ye=1e4;break;default:ye=5e3}return ye=J+ye,F={id:h++,callback:K,priorityLevel:F,startTime:J,expirationTime:ye,sortIndex:-1},J>ne?(F.sortIndex=J,e(d,F),n(l)===null&&F===n(d)&&(b?(_(x),x=-1):b=!0,ue(P,J-ne))):(F.sortIndex=ye,e(l,F),T||v||(T=!0,ee(O))),F},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(F){var K=g;return function(){var J=g;g=K;try{return F.apply(this,arguments)}finally{g=J}}}})(ew);Z_.exports=ew;var VS=Z_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OS=C,Bt=VS;function B(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var tw=new Set,ma={};function qs(t,e){Mi(t,e),Mi(t+"Capture",e)}function Mi(t,e){for(ma[t]=e,t=0;t<e.length;t++)tw.add(e[t])}var Wn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bh=Object.prototype.hasOwnProperty,MS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ty={},Sy={};function LS(t){return Bh.call(Sy,t)?!0:Bh.call(Ty,t)?!1:MS.test(t)?Sy[t]=!0:(Ty[t]=!0,!1)}function FS(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function US(t,e,n,r){if(e===null||typeof e>"u"||FS(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function It(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var nt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){nt[t]=new It(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];nt[e]=new It(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){nt[t]=new It(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){nt[t]=new It(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){nt[t]=new It(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){nt[t]=new It(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){nt[t]=new It(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){nt[t]=new It(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){nt[t]=new It(t,5,!1,t.toLowerCase(),null,!1,!1)});var wp=/[\-:]([a-z])/g;function xp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(wp,xp);nt[e]=new It(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(wp,xp);nt[e]=new It(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(wp,xp);nt[e]=new It(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){nt[t]=new It(t,1,!1,t.toLowerCase(),null,!1,!1)});nt.xlinkHref=new It("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){nt[t]=new It(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ep(t,e,n,r){var s=nt.hasOwnProperty(e)?nt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(US(e,n,s,r)&&(n=null),r||s===null?LS(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var er=OS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ul=Symbol.for("react.element"),fi=Symbol.for("react.portal"),pi=Symbol.for("react.fragment"),Ip=Symbol.for("react.strict_mode"),$h=Symbol.for("react.profiler"),nw=Symbol.for("react.provider"),rw=Symbol.for("react.context"),Tp=Symbol.for("react.forward_ref"),qh=Symbol.for("react.suspense"),Kh=Symbol.for("react.suspense_list"),Sp=Symbol.for("react.memo"),dr=Symbol.for("react.lazy"),sw=Symbol.for("react.offscreen"),ky=Symbol.iterator;function Ao(t){return t===null||typeof t!="object"?null:(t=ky&&t[ky]||t["@@iterator"],typeof t=="function"?t:null)}var Ce=Object.assign,th;function Bo(t){if(th===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);th=e&&e[1]||""}return`
`+th+t}var nh=!1;function rh(t,e){if(!t||nh)return"";nh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{nh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Bo(t):""}function zS(t){switch(t.tag){case 5:return Bo(t.type);case 16:return Bo("Lazy");case 13:return Bo("Suspense");case 19:return Bo("SuspenseList");case 0:case 2:case 15:return t=rh(t.type,!1),t;case 11:return t=rh(t.type.render,!1),t;case 1:return t=rh(t.type,!0),t;default:return""}}function Gh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case pi:return"Fragment";case fi:return"Portal";case $h:return"Profiler";case Ip:return"StrictMode";case qh:return"Suspense";case Kh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case rw:return(t.displayName||"Context")+".Consumer";case nw:return(t._context.displayName||"Context")+".Provider";case Tp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Sp:return e=t.displayName||null,e!==null?e:Gh(t.type)||"Memo";case dr:e=t._payload,t=t._init;try{return Gh(t(e))}catch{}}return null}function BS(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Gh(e);case 8:return e===Ip?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Fr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function iw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function $S(t){var e=iw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function zl(t){t._valueTracker||(t._valueTracker=$S(t))}function ow(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=iw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Oc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Wh(t,e){var n=e.checked;return Ce({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function by(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Fr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function aw(t,e){e=e.checked,e!=null&&Ep(t,"checked",e,!1)}function Hh(t,e){aw(t,e);var n=Fr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Qh(t,e.type,n):e.hasOwnProperty("defaultValue")&&Qh(t,e.type,Fr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Ay(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Qh(t,e,n){(e!=="number"||Oc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var $o=Array.isArray;function ki(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Fr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Jh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(B(91));return Ce({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ry(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(B(92));if($o(n)){if(1<n.length)throw Error(B(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Fr(n)}}function lw(t,e){var n=Fr(e.value),r=Fr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Ny(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function cw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?cw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Bl,uw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Bl=Bl||document.createElement("div"),Bl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Bl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ga(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Zo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qS=["Webkit","ms","Moz","O"];Object.keys(Zo).forEach(function(t){qS.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Zo[e]=Zo[t]})});function dw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Zo.hasOwnProperty(t)&&Zo[t]?(""+e).trim():e+"px"}function hw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=dw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var KS=Ce({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xh(t,e){if(e){if(KS[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(B(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(B(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(B(61))}if(e.style!=null&&typeof e.style!="object")throw Error(B(62))}}function Zh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ef=null;function kp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var tf=null,bi=null,Ai=null;function Cy(t){if(t=tl(t)){if(typeof tf!="function")throw Error(B(280));var e=t.stateNode;e&&(e=Uu(e),tf(t.stateNode,t.type,e))}}function fw(t){bi?Ai?Ai.push(t):Ai=[t]:bi=t}function pw(){if(bi){var t=bi,e=Ai;if(Ai=bi=null,Cy(t),e)for(t=0;t<e.length;t++)Cy(e[t])}}function mw(t,e){return t(e)}function gw(){}var sh=!1;function yw(t,e,n){if(sh)return t(e,n);sh=!0;try{return mw(t,e,n)}finally{sh=!1,(bi!==null||Ai!==null)&&(gw(),pw())}}function ya(t,e){var n=t.stateNode;if(n===null)return null;var r=Uu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(B(231,e,typeof n));return n}var nf=!1;if(Wn)try{var Ro={};Object.defineProperty(Ro,"passive",{get:function(){nf=!0}}),window.addEventListener("test",Ro,Ro),window.removeEventListener("test",Ro,Ro)}catch{nf=!1}function GS(t,e,n,r,s,i,o,a,l){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var ea=!1,Mc=null,Lc=!1,rf=null,WS={onError:function(t){ea=!0,Mc=t}};function HS(t,e,n,r,s,i,o,a,l){ea=!1,Mc=null,GS.apply(WS,arguments)}function QS(t,e,n,r,s,i,o,a,l){if(HS.apply(this,arguments),ea){if(ea){var d=Mc;ea=!1,Mc=null}else throw Error(B(198));Lc||(Lc=!0,rf=d)}}function Ks(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function vw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Py(t){if(Ks(t)!==t)throw Error(B(188))}function JS(t){var e=t.alternate;if(!e){if(e=Ks(t),e===null)throw Error(B(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Py(s),t;if(i===r)return Py(s),e;i=i.sibling}throw Error(B(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(B(189))}}if(n.alternate!==r)throw Error(B(190))}if(n.tag!==3)throw Error(B(188));return n.stateNode.current===n?t:e}function _w(t){return t=JS(t),t!==null?ww(t):null}function ww(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=ww(t);if(e!==null)return e;t=t.sibling}return null}var xw=Bt.unstable_scheduleCallback,Dy=Bt.unstable_cancelCallback,YS=Bt.unstable_shouldYield,XS=Bt.unstable_requestPaint,Le=Bt.unstable_now,ZS=Bt.unstable_getCurrentPriorityLevel,bp=Bt.unstable_ImmediatePriority,Ew=Bt.unstable_UserBlockingPriority,Fc=Bt.unstable_NormalPriority,ek=Bt.unstable_LowPriority,Iw=Bt.unstable_IdlePriority,Ou=null,wn=null;function tk(t){if(wn&&typeof wn.onCommitFiberRoot=="function")try{wn.onCommitFiberRoot(Ou,t,void 0,(t.current.flags&128)===128)}catch{}}var an=Math.clz32?Math.clz32:sk,nk=Math.log,rk=Math.LN2;function sk(t){return t>>>=0,t===0?32:31-(nk(t)/rk|0)|0}var $l=64,ql=4194304;function qo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Uc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=qo(a):(i&=o,i!==0&&(r=qo(i)))}else o=n&~s,o!==0?r=qo(o):i!==0&&(r=qo(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-an(e),s=1<<n,r|=t[n],e&=~s;return r}function ik(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ok(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-an(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=ik(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function sf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Tw(){var t=$l;return $l<<=1,!($l&4194240)&&($l=64),t}function ih(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Za(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-an(e),t[e]=n}function ak(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-an(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Ap(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-an(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var me=0;function Sw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var kw,Rp,bw,Aw,Rw,of=!1,Kl=[],kr=null,br=null,Ar=null,va=new Map,_a=new Map,pr=[],lk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jy(t,e){switch(t){case"focusin":case"focusout":kr=null;break;case"dragenter":case"dragleave":br=null;break;case"mouseover":case"mouseout":Ar=null;break;case"pointerover":case"pointerout":va.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":_a.delete(e.pointerId)}}function No(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=tl(e),e!==null&&Rp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function ck(t,e,n,r,s){switch(e){case"focusin":return kr=No(kr,t,e,n,r,s),!0;case"dragenter":return br=No(br,t,e,n,r,s),!0;case"mouseover":return Ar=No(Ar,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return va.set(i,No(va.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,_a.set(i,No(_a.get(i)||null,t,e,n,r,s)),!0}return!1}function Nw(t){var e=gs(t.target);if(e!==null){var n=Ks(e);if(n!==null){if(e=n.tag,e===13){if(e=vw(n),e!==null){t.blockedOn=e,Rw(t.priority,function(){bw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function hc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=af(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);ef=r,n.target.dispatchEvent(r),ef=null}else return e=tl(n),e!==null&&Rp(e),t.blockedOn=n,!1;e.shift()}return!0}function Vy(t,e,n){hc(t)&&n.delete(e)}function uk(){of=!1,kr!==null&&hc(kr)&&(kr=null),br!==null&&hc(br)&&(br=null),Ar!==null&&hc(Ar)&&(Ar=null),va.forEach(Vy),_a.forEach(Vy)}function Co(t,e){t.blockedOn===e&&(t.blockedOn=null,of||(of=!0,Bt.unstable_scheduleCallback(Bt.unstable_NormalPriority,uk)))}function wa(t){function e(s){return Co(s,t)}if(0<Kl.length){Co(Kl[0],t);for(var n=1;n<Kl.length;n++){var r=Kl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(kr!==null&&Co(kr,t),br!==null&&Co(br,t),Ar!==null&&Co(Ar,t),va.forEach(e),_a.forEach(e),n=0;n<pr.length;n++)r=pr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<pr.length&&(n=pr[0],n.blockedOn===null);)Nw(n),n.blockedOn===null&&pr.shift()}var Ri=er.ReactCurrentBatchConfig,zc=!0;function dk(t,e,n,r){var s=me,i=Ri.transition;Ri.transition=null;try{me=1,Np(t,e,n,r)}finally{me=s,Ri.transition=i}}function hk(t,e,n,r){var s=me,i=Ri.transition;Ri.transition=null;try{me=4,Np(t,e,n,r)}finally{me=s,Ri.transition=i}}function Np(t,e,n,r){if(zc){var s=af(t,e,n,r);if(s===null)mh(t,e,r,Bc,n),jy(t,r);else if(ck(s,t,e,n,r))r.stopPropagation();else if(jy(t,r),e&4&&-1<lk.indexOf(t)){for(;s!==null;){var i=tl(s);if(i!==null&&kw(i),i=af(t,e,n,r),i===null&&mh(t,e,r,Bc,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else mh(t,e,r,null,n)}}var Bc=null;function af(t,e,n,r){if(Bc=null,t=kp(r),t=gs(t),t!==null)if(e=Ks(t),e===null)t=null;else if(n=e.tag,n===13){if(t=vw(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Bc=t,null}function Cw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ZS()){case bp:return 1;case Ew:return 4;case Fc:case ek:return 16;case Iw:return 536870912;default:return 16}default:return 16}}var Er=null,Cp=null,fc=null;function Pw(){if(fc)return fc;var t,e=Cp,n=e.length,r,s="value"in Er?Er.value:Er.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return fc=s.slice(t,1<r?1-r:void 0)}function pc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Gl(){return!0}function Oy(){return!1}function Kt(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Gl:Oy,this.isPropagationStopped=Oy,this}return Ce(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Gl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Gl)},persist:function(){},isPersistent:Gl}),e}var io={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pp=Kt(io),el=Ce({},io,{view:0,detail:0}),fk=Kt(el),oh,ah,Po,Mu=Ce({},el,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Dp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Po&&(Po&&t.type==="mousemove"?(oh=t.screenX-Po.screenX,ah=t.screenY-Po.screenY):ah=oh=0,Po=t),oh)},movementY:function(t){return"movementY"in t?t.movementY:ah}}),My=Kt(Mu),pk=Ce({},Mu,{dataTransfer:0}),mk=Kt(pk),gk=Ce({},el,{relatedTarget:0}),lh=Kt(gk),yk=Ce({},io,{animationName:0,elapsedTime:0,pseudoElement:0}),vk=Kt(yk),_k=Ce({},io,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),wk=Kt(_k),xk=Ce({},io,{data:0}),Ly=Kt(xk),Ek={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ik={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sk(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Tk[t])?!!e[t]:!1}function Dp(){return Sk}var kk=Ce({},el,{key:function(t){if(t.key){var e=Ek[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=pc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Ik[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Dp,charCode:function(t){return t.type==="keypress"?pc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?pc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),bk=Kt(kk),Ak=Ce({},Mu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fy=Kt(Ak),Rk=Ce({},el,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Dp}),Nk=Kt(Rk),Ck=Ce({},io,{propertyName:0,elapsedTime:0,pseudoElement:0}),Pk=Kt(Ck),Dk=Ce({},Mu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),jk=Kt(Dk),Vk=[9,13,27,32],jp=Wn&&"CompositionEvent"in window,ta=null;Wn&&"documentMode"in document&&(ta=document.documentMode);var Ok=Wn&&"TextEvent"in window&&!ta,Dw=Wn&&(!jp||ta&&8<ta&&11>=ta),Uy=" ",zy=!1;function jw(t,e){switch(t){case"keyup":return Vk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var mi=!1;function Mk(t,e){switch(t){case"compositionend":return Vw(e);case"keypress":return e.which!==32?null:(zy=!0,Uy);case"textInput":return t=e.data,t===Uy&&zy?null:t;default:return null}}function Lk(t,e){if(mi)return t==="compositionend"||!jp&&jw(t,e)?(t=Pw(),fc=Cp=Er=null,mi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Dw&&e.locale!=="ko"?null:e.data;default:return null}}var Fk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function By(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Fk[t.type]:e==="textarea"}function Ow(t,e,n,r){fw(r),e=$c(e,"onChange"),0<e.length&&(n=new Pp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var na=null,xa=null;function Uk(t){Ww(t,0)}function Lu(t){var e=vi(t);if(ow(e))return t}function zk(t,e){if(t==="change")return e}var Mw=!1;if(Wn){var ch;if(Wn){var uh="oninput"in document;if(!uh){var $y=document.createElement("div");$y.setAttribute("oninput","return;"),uh=typeof $y.oninput=="function"}ch=uh}else ch=!1;Mw=ch&&(!document.documentMode||9<document.documentMode)}function qy(){na&&(na.detachEvent("onpropertychange",Lw),xa=na=null)}function Lw(t){if(t.propertyName==="value"&&Lu(xa)){var e=[];Ow(e,xa,t,kp(t)),yw(Uk,e)}}function Bk(t,e,n){t==="focusin"?(qy(),na=e,xa=n,na.attachEvent("onpropertychange",Lw)):t==="focusout"&&qy()}function $k(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Lu(xa)}function qk(t,e){if(t==="click")return Lu(e)}function Kk(t,e){if(t==="input"||t==="change")return Lu(e)}function Gk(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var un=typeof Object.is=="function"?Object.is:Gk;function Ea(t,e){if(un(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Bh.call(e,s)||!un(t[s],e[s]))return!1}return!0}function Ky(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Gy(t,e){var n=Ky(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ky(n)}}function Fw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Fw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Uw(){for(var t=window,e=Oc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Oc(t.document)}return e}function Vp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Wk(t){var e=Uw(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Fw(n.ownerDocument.documentElement,n)){if(r!==null&&Vp(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Gy(n,i);var o=Gy(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Hk=Wn&&"documentMode"in document&&11>=document.documentMode,gi=null,lf=null,ra=null,cf=!1;function Wy(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;cf||gi==null||gi!==Oc(r)||(r=gi,"selectionStart"in r&&Vp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ra&&Ea(ra,r)||(ra=r,r=$c(lf,"onSelect"),0<r.length&&(e=new Pp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=gi)))}function Wl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var yi={animationend:Wl("Animation","AnimationEnd"),animationiteration:Wl("Animation","AnimationIteration"),animationstart:Wl("Animation","AnimationStart"),transitionend:Wl("Transition","TransitionEnd")},dh={},zw={};Wn&&(zw=document.createElement("div").style,"AnimationEvent"in window||(delete yi.animationend.animation,delete yi.animationiteration.animation,delete yi.animationstart.animation),"TransitionEvent"in window||delete yi.transitionend.transition);function Fu(t){if(dh[t])return dh[t];if(!yi[t])return t;var e=yi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in zw)return dh[t]=e[n];return t}var Bw=Fu("animationend"),$w=Fu("animationiteration"),qw=Fu("animationstart"),Kw=Fu("transitionend"),Gw=new Map,Hy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gr(t,e){Gw.set(t,e),qs(e,[t])}for(var hh=0;hh<Hy.length;hh++){var fh=Hy[hh],Qk=fh.toLowerCase(),Jk=fh[0].toUpperCase()+fh.slice(1);Gr(Qk,"on"+Jk)}Gr(Bw,"onAnimationEnd");Gr($w,"onAnimationIteration");Gr(qw,"onAnimationStart");Gr("dblclick","onDoubleClick");Gr("focusin","onFocus");Gr("focusout","onBlur");Gr(Kw,"onTransitionEnd");Mi("onMouseEnter",["mouseout","mouseover"]);Mi("onMouseLeave",["mouseout","mouseover"]);Mi("onPointerEnter",["pointerout","pointerover"]);Mi("onPointerLeave",["pointerout","pointerover"]);qs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));qs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));qs("onBeforeInput",["compositionend","keypress","textInput","paste"]);qs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));qs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));qs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ko="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ko));function Qy(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,QS(r,e,void 0,t),t.currentTarget=null}function Ww(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,d=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;Qy(s,a,d),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,d=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;Qy(s,a,d),i=l}}}if(Lc)throw t=rf,Lc=!1,rf=null,t}function Ie(t,e){var n=e[pf];n===void 0&&(n=e[pf]=new Set);var r=t+"__bubble";n.has(r)||(Hw(e,t,2,!1),n.add(r))}function ph(t,e,n){var r=0;e&&(r|=4),Hw(n,t,r,e)}var Hl="_reactListening"+Math.random().toString(36).slice(2);function Ia(t){if(!t[Hl]){t[Hl]=!0,tw.forEach(function(n){n!=="selectionchange"&&(Yk.has(n)||ph(n,!1,t),ph(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Hl]||(e[Hl]=!0,ph("selectionchange",!1,e))}}function Hw(t,e,n,r){switch(Cw(e)){case 1:var s=dk;break;case 4:s=hk;break;default:s=Np}n=s.bind(null,e,n,t),s=void 0,!nf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function mh(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=gs(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}yw(function(){var d=i,h=kp(n),p=[];e:{var g=Gw.get(t);if(g!==void 0){var v=Pp,T=t;switch(t){case"keypress":if(pc(n)===0)break e;case"keydown":case"keyup":v=bk;break;case"focusin":T="focus",v=lh;break;case"focusout":T="blur",v=lh;break;case"beforeblur":case"afterblur":v=lh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=My;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=mk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=Nk;break;case Bw:case $w:case qw:v=vk;break;case Kw:v=Pk;break;case"scroll":v=fk;break;case"wheel":v=jk;break;case"copy":case"cut":case"paste":v=wk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Fy}var b=(e&4)!==0,E=!b&&t==="scroll",_=b?g!==null?g+"Capture":null:g;b=[];for(var y=d,I;y!==null;){I=y;var P=I.stateNode;if(I.tag===5&&P!==null&&(I=P,_!==null&&(P=ya(y,_),P!=null&&b.push(Ta(y,P,I)))),E)break;y=y.return}0<b.length&&(g=new v(g,T,null,n,h),p.push({event:g,listeners:b}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",g&&n!==ef&&(T=n.relatedTarget||n.fromElement)&&(gs(T)||T[Hn]))break e;if((v||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,v?(T=n.relatedTarget||n.toElement,v=d,T=T?gs(T):null,T!==null&&(E=Ks(T),T!==E||T.tag!==5&&T.tag!==6)&&(T=null)):(v=null,T=d),v!==T)){if(b=My,P="onMouseLeave",_="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(b=Fy,P="onPointerLeave",_="onPointerEnter",y="pointer"),E=v==null?g:vi(v),I=T==null?g:vi(T),g=new b(P,y+"leave",v,n,h),g.target=E,g.relatedTarget=I,P=null,gs(h)===d&&(b=new b(_,y+"enter",T,n,h),b.target=I,b.relatedTarget=E,P=b),E=P,v&&T)t:{for(b=v,_=T,y=0,I=b;I;I=ri(I))y++;for(I=0,P=_;P;P=ri(P))I++;for(;0<y-I;)b=ri(b),y--;for(;0<I-y;)_=ri(_),I--;for(;y--;){if(b===_||_!==null&&b===_.alternate)break t;b=ri(b),_=ri(_)}b=null}else b=null;v!==null&&Jy(p,g,v,b,!1),T!==null&&E!==null&&Jy(p,E,T,b,!0)}}e:{if(g=d?vi(d):window,v=g.nodeName&&g.nodeName.toLowerCase(),v==="select"||v==="input"&&g.type==="file")var O=zk;else if(By(g))if(Mw)O=Kk;else{O=$k;var L=Bk}else(v=g.nodeName)&&v.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(O=qk);if(O&&(O=O(t,d))){Ow(p,O,n,h);break e}L&&L(t,g,d),t==="focusout"&&(L=g._wrapperState)&&L.controlled&&g.type==="number"&&Qh(g,"number",g.value)}switch(L=d?vi(d):window,t){case"focusin":(By(L)||L.contentEditable==="true")&&(gi=L,lf=d,ra=null);break;case"focusout":ra=lf=gi=null;break;case"mousedown":cf=!0;break;case"contextmenu":case"mouseup":case"dragend":cf=!1,Wy(p,n,h);break;case"selectionchange":if(Hk)break;case"keydown":case"keyup":Wy(p,n,h)}var S;if(jp)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else mi?jw(t,n)&&(x="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(x="onCompositionStart");x&&(Dw&&n.locale!=="ko"&&(mi||x!=="onCompositionStart"?x==="onCompositionEnd"&&mi&&(S=Pw()):(Er=h,Cp="value"in Er?Er.value:Er.textContent,mi=!0)),L=$c(d,x),0<L.length&&(x=new Ly(x,t,null,n,h),p.push({event:x,listeners:L}),S?x.data=S:(S=Vw(n),S!==null&&(x.data=S)))),(S=Ok?Mk(t,n):Lk(t,n))&&(d=$c(d,"onBeforeInput"),0<d.length&&(h=new Ly("onBeforeInput","beforeinput",null,n,h),p.push({event:h,listeners:d}),h.data=S))}Ww(p,e)})}function Ta(t,e,n){return{instance:t,listener:e,currentTarget:n}}function $c(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ya(t,n),i!=null&&r.unshift(Ta(t,i,s)),i=ya(t,e),i!=null&&r.push(Ta(t,i,s))),t=t.return}return r}function ri(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Jy(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,d=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&d!==null&&(a=d,s?(l=ya(n,i),l!=null&&o.unshift(Ta(n,l,a))):s||(l=ya(n,i),l!=null&&o.push(Ta(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Xk=/\r\n?/g,Zk=/\u0000|\uFFFD/g;function Yy(t){return(typeof t=="string"?t:""+t).replace(Xk,`
`).replace(Zk,"")}function Ql(t,e,n){if(e=Yy(e),Yy(t)!==e&&n)throw Error(B(425))}function qc(){}var uf=null,df=null;function hf(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ff=typeof setTimeout=="function"?setTimeout:void 0,eb=typeof clearTimeout=="function"?clearTimeout:void 0,Xy=typeof Promise=="function"?Promise:void 0,tb=typeof queueMicrotask=="function"?queueMicrotask:typeof Xy<"u"?function(t){return Xy.resolve(null).then(t).catch(nb)}:ff;function nb(t){setTimeout(function(){throw t})}function gh(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),wa(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);wa(e)}function Rr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Zy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var oo=Math.random().toString(36).slice(2),gn="__reactFiber$"+oo,Sa="__reactProps$"+oo,Hn="__reactContainer$"+oo,pf="__reactEvents$"+oo,rb="__reactListeners$"+oo,sb="__reactHandles$"+oo;function gs(t){var e=t[gn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Hn]||n[gn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Zy(t);t!==null;){if(n=t[gn])return n;t=Zy(t)}return e}t=n,n=t.parentNode}return null}function tl(t){return t=t[gn]||t[Hn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function vi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(B(33))}function Uu(t){return t[Sa]||null}var mf=[],_i=-1;function Wr(t){return{current:t}}function Te(t){0>_i||(t.current=mf[_i],mf[_i]=null,_i--)}function we(t,e){_i++,mf[_i]=t.current,t.current=e}var Ur={},mt=Wr(Ur),Ct=Wr(!1),Ss=Ur;function Li(t,e){var n=t.type.contextTypes;if(!n)return Ur;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Pt(t){return t=t.childContextTypes,t!=null}function Kc(){Te(Ct),Te(mt)}function ev(t,e,n){if(mt.current!==Ur)throw Error(B(168));we(mt,e),we(Ct,n)}function Qw(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(B(108,BS(t)||"Unknown",s));return Ce({},n,r)}function Gc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ur,Ss=mt.current,we(mt,t),we(Ct,Ct.current),!0}function tv(t,e,n){var r=t.stateNode;if(!r)throw Error(B(169));n?(t=Qw(t,e,Ss),r.__reactInternalMemoizedMergedChildContext=t,Te(Ct),Te(mt),we(mt,t)):Te(Ct),we(Ct,n)}var Ln=null,zu=!1,yh=!1;function Jw(t){Ln===null?Ln=[t]:Ln.push(t)}function ib(t){zu=!0,Jw(t)}function Hr(){if(!yh&&Ln!==null){yh=!0;var t=0,e=me;try{var n=Ln;for(me=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ln=null,zu=!1}catch(s){throw Ln!==null&&(Ln=Ln.slice(t+1)),xw(bp,Hr),s}finally{me=e,yh=!1}}return null}var wi=[],xi=0,Wc=null,Hc=0,Wt=[],Ht=0,ks=null,Fn=1,Un="";function ls(t,e){wi[xi++]=Hc,wi[xi++]=Wc,Wc=t,Hc=e}function Yw(t,e,n){Wt[Ht++]=Fn,Wt[Ht++]=Un,Wt[Ht++]=ks,ks=t;var r=Fn;t=Un;var s=32-an(r)-1;r&=~(1<<s),n+=1;var i=32-an(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Fn=1<<32-an(e)+s|n<<s|r,Un=i+t}else Fn=1<<i|n<<s|r,Un=t}function Op(t){t.return!==null&&(ls(t,1),Yw(t,1,0))}function Mp(t){for(;t===Wc;)Wc=wi[--xi],wi[xi]=null,Hc=wi[--xi],wi[xi]=null;for(;t===ks;)ks=Wt[--Ht],Wt[Ht]=null,Un=Wt[--Ht],Wt[Ht]=null,Fn=Wt[--Ht],Wt[Ht]=null}var Ut=null,Lt=null,ke=!1,sn=null;function Xw(t,e){var n=Qt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function nv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ut=t,Lt=Rr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ut=t,Lt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ks!==null?{id:Fn,overflow:Un}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Qt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ut=t,Lt=null,!0):!1;default:return!1}}function gf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function yf(t){if(ke){var e=Lt;if(e){var n=e;if(!nv(t,e)){if(gf(t))throw Error(B(418));e=Rr(n.nextSibling);var r=Ut;e&&nv(t,e)?Xw(r,n):(t.flags=t.flags&-4097|2,ke=!1,Ut=t)}}else{if(gf(t))throw Error(B(418));t.flags=t.flags&-4097|2,ke=!1,Ut=t}}}function rv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ut=t}function Jl(t){if(t!==Ut)return!1;if(!ke)return rv(t),ke=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!hf(t.type,t.memoizedProps)),e&&(e=Lt)){if(gf(t))throw Zw(),Error(B(418));for(;e;)Xw(t,e),e=Rr(e.nextSibling)}if(rv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(B(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Lt=Rr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Lt=null}}else Lt=Ut?Rr(t.stateNode.nextSibling):null;return!0}function Zw(){for(var t=Lt;t;)t=Rr(t.nextSibling)}function Fi(){Lt=Ut=null,ke=!1}function Lp(t){sn===null?sn=[t]:sn.push(t)}var ob=er.ReactCurrentBatchConfig;function Do(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(B(309));var r=n.stateNode}if(!r)throw Error(B(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(B(284));if(!n._owner)throw Error(B(290,t))}return t}function Yl(t,e){throw t=Object.prototype.toString.call(e),Error(B(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function sv(t){var e=t._init;return e(t._payload)}function ex(t){function e(_,y){if(t){var I=_.deletions;I===null?(_.deletions=[y],_.flags|=16):I.push(y)}}function n(_,y){if(!t)return null;for(;y!==null;)e(_,y),y=y.sibling;return null}function r(_,y){for(_=new Map;y!==null;)y.key!==null?_.set(y.key,y):_.set(y.index,y),y=y.sibling;return _}function s(_,y){return _=Dr(_,y),_.index=0,_.sibling=null,_}function i(_,y,I){return _.index=I,t?(I=_.alternate,I!==null?(I=I.index,I<y?(_.flags|=2,y):I):(_.flags|=2,y)):(_.flags|=1048576,y)}function o(_){return t&&_.alternate===null&&(_.flags|=2),_}function a(_,y,I,P){return y===null||y.tag!==6?(y=Th(I,_.mode,P),y.return=_,y):(y=s(y,I),y.return=_,y)}function l(_,y,I,P){var O=I.type;return O===pi?h(_,y,I.props.children,P,I.key):y!==null&&(y.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===dr&&sv(O)===y.type)?(P=s(y,I.props),P.ref=Do(_,y,I),P.return=_,P):(P=xc(I.type,I.key,I.props,null,_.mode,P),P.ref=Do(_,y,I),P.return=_,P)}function d(_,y,I,P){return y===null||y.tag!==4||y.stateNode.containerInfo!==I.containerInfo||y.stateNode.implementation!==I.implementation?(y=Sh(I,_.mode,P),y.return=_,y):(y=s(y,I.children||[]),y.return=_,y)}function h(_,y,I,P,O){return y===null||y.tag!==7?(y=ws(I,_.mode,P,O),y.return=_,y):(y=s(y,I),y.return=_,y)}function p(_,y,I){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Th(""+y,_.mode,I),y.return=_,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ul:return I=xc(y.type,y.key,y.props,null,_.mode,I),I.ref=Do(_,null,y),I.return=_,I;case fi:return y=Sh(y,_.mode,I),y.return=_,y;case dr:var P=y._init;return p(_,P(y._payload),I)}if($o(y)||Ao(y))return y=ws(y,_.mode,I,null),y.return=_,y;Yl(_,y)}return null}function g(_,y,I,P){var O=y!==null?y.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return O!==null?null:a(_,y,""+I,P);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Ul:return I.key===O?l(_,y,I,P):null;case fi:return I.key===O?d(_,y,I,P):null;case dr:return O=I._init,g(_,y,O(I._payload),P)}if($o(I)||Ao(I))return O!==null?null:h(_,y,I,P,null);Yl(_,I)}return null}function v(_,y,I,P,O){if(typeof P=="string"&&P!==""||typeof P=="number")return _=_.get(I)||null,a(y,_,""+P,O);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Ul:return _=_.get(P.key===null?I:P.key)||null,l(y,_,P,O);case fi:return _=_.get(P.key===null?I:P.key)||null,d(y,_,P,O);case dr:var L=P._init;return v(_,y,I,L(P._payload),O)}if($o(P)||Ao(P))return _=_.get(I)||null,h(y,_,P,O,null);Yl(y,P)}return null}function T(_,y,I,P){for(var O=null,L=null,S=y,x=y=0,k=null;S!==null&&x<I.length;x++){S.index>x?(k=S,S=null):k=S.sibling;var R=g(_,S,I[x],P);if(R===null){S===null&&(S=k);break}t&&S&&R.alternate===null&&e(_,S),y=i(R,y,x),L===null?O=R:L.sibling=R,L=R,S=k}if(x===I.length)return n(_,S),ke&&ls(_,x),O;if(S===null){for(;x<I.length;x++)S=p(_,I[x],P),S!==null&&(y=i(S,y,x),L===null?O=S:L.sibling=S,L=S);return ke&&ls(_,x),O}for(S=r(_,S);x<I.length;x++)k=v(S,_,x,I[x],P),k!==null&&(t&&k.alternate!==null&&S.delete(k.key===null?x:k.key),y=i(k,y,x),L===null?O=k:L.sibling=k,L=k);return t&&S.forEach(function(N){return e(_,N)}),ke&&ls(_,x),O}function b(_,y,I,P){var O=Ao(I);if(typeof O!="function")throw Error(B(150));if(I=O.call(I),I==null)throw Error(B(151));for(var L=O=null,S=y,x=y=0,k=null,R=I.next();S!==null&&!R.done;x++,R=I.next()){S.index>x?(k=S,S=null):k=S.sibling;var N=g(_,S,R.value,P);if(N===null){S===null&&(S=k);break}t&&S&&N.alternate===null&&e(_,S),y=i(N,y,x),L===null?O=N:L.sibling=N,L=N,S=k}if(R.done)return n(_,S),ke&&ls(_,x),O;if(S===null){for(;!R.done;x++,R=I.next())R=p(_,R.value,P),R!==null&&(y=i(R,y,x),L===null?O=R:L.sibling=R,L=R);return ke&&ls(_,x),O}for(S=r(_,S);!R.done;x++,R=I.next())R=v(S,_,x,R.value,P),R!==null&&(t&&R.alternate!==null&&S.delete(R.key===null?x:R.key),y=i(R,y,x),L===null?O=R:L.sibling=R,L=R);return t&&S.forEach(function(D){return e(_,D)}),ke&&ls(_,x),O}function E(_,y,I,P){if(typeof I=="object"&&I!==null&&I.type===pi&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case Ul:e:{for(var O=I.key,L=y;L!==null;){if(L.key===O){if(O=I.type,O===pi){if(L.tag===7){n(_,L.sibling),y=s(L,I.props.children),y.return=_,_=y;break e}}else if(L.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===dr&&sv(O)===L.type){n(_,L.sibling),y=s(L,I.props),y.ref=Do(_,L,I),y.return=_,_=y;break e}n(_,L);break}else e(_,L);L=L.sibling}I.type===pi?(y=ws(I.props.children,_.mode,P,I.key),y.return=_,_=y):(P=xc(I.type,I.key,I.props,null,_.mode,P),P.ref=Do(_,y,I),P.return=_,_=P)}return o(_);case fi:e:{for(L=I.key;y!==null;){if(y.key===L)if(y.tag===4&&y.stateNode.containerInfo===I.containerInfo&&y.stateNode.implementation===I.implementation){n(_,y.sibling),y=s(y,I.children||[]),y.return=_,_=y;break e}else{n(_,y);break}else e(_,y);y=y.sibling}y=Sh(I,_.mode,P),y.return=_,_=y}return o(_);case dr:return L=I._init,E(_,y,L(I._payload),P)}if($o(I))return T(_,y,I,P);if(Ao(I))return b(_,y,I,P);Yl(_,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,y!==null&&y.tag===6?(n(_,y.sibling),y=s(y,I),y.return=_,_=y):(n(_,y),y=Th(I,_.mode,P),y.return=_,_=y),o(_)):n(_,y)}return E}var Ui=ex(!0),tx=ex(!1),Qc=Wr(null),Jc=null,Ei=null,Fp=null;function Up(){Fp=Ei=Jc=null}function zp(t){var e=Qc.current;Te(Qc),t._currentValue=e}function vf(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ni(t,e){Jc=t,Fp=Ei=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(At=!0),t.firstContext=null)}function Yt(t){var e=t._currentValue;if(Fp!==t)if(t={context:t,memoizedValue:e,next:null},Ei===null){if(Jc===null)throw Error(B(308));Ei=t,Jc.dependencies={lanes:0,firstContext:t}}else Ei=Ei.next=t;return e}var ys=null;function Bp(t){ys===null?ys=[t]:ys.push(t)}function nx(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Bp(e)):(n.next=s.next,s.next=n),e.interleaved=n,Qn(t,r)}function Qn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var hr=!1;function $p(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function rx(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Kn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Nr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,de&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Qn(t,n)}return s=r.interleaved,s===null?(e.next=e,Bp(r)):(e.next=s.next,s.next=e),r.interleaved=e,Qn(t,n)}function mc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ap(t,n)}}function iv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Yc(t,e,n,r){var s=t.updateQueue;hr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,d=l.next;l.next=null,o===null?i=d:o.next=d,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=l))}if(i!==null){var p=s.baseState;o=0,h=d=l=null,a=i;do{var g=a.lane,v=a.eventTime;if((r&g)===g){h!==null&&(h=h.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var T=t,b=a;switch(g=e,v=n,b.tag){case 1:if(T=b.payload,typeof T=="function"){p=T.call(v,p,g);break e}p=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=b.payload,g=typeof T=="function"?T.call(v,p,g):T,g==null)break e;p=Ce({},p,g);break e;case 2:hr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[a]:g.push(a))}else v={eventTime:v,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=v,l=p):h=h.next=v,o|=g;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;g=a,a=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(h===null&&(l=p),s.baseState=l,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);As|=o,t.lanes=o,t.memoizedState=p}}function ov(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(B(191,s));s.call(r)}}}var nl={},xn=Wr(nl),ka=Wr(nl),ba=Wr(nl);function vs(t){if(t===nl)throw Error(B(174));return t}function qp(t,e){switch(we(ba,e),we(ka,t),we(xn,nl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Yh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Yh(e,t)}Te(xn),we(xn,e)}function zi(){Te(xn),Te(ka),Te(ba)}function sx(t){vs(ba.current);var e=vs(xn.current),n=Yh(e,t.type);e!==n&&(we(ka,t),we(xn,n))}function Kp(t){ka.current===t&&(Te(xn),Te(ka))}var be=Wr(0);function Xc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var vh=[];function Gp(){for(var t=0;t<vh.length;t++)vh[t]._workInProgressVersionPrimary=null;vh.length=0}var gc=er.ReactCurrentDispatcher,_h=er.ReactCurrentBatchConfig,bs=0,Re=null,qe=null,Je=null,Zc=!1,sa=!1,Aa=0,ab=0;function at(){throw Error(B(321))}function Wp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!un(t[n],e[n]))return!1;return!0}function Hp(t,e,n,r,s,i){if(bs=i,Re=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,gc.current=t===null||t.memoizedState===null?db:hb,t=n(r,s),sa){i=0;do{if(sa=!1,Aa=0,25<=i)throw Error(B(301));i+=1,Je=qe=null,e.updateQueue=null,gc.current=fb,t=n(r,s)}while(sa)}if(gc.current=eu,e=qe!==null&&qe.next!==null,bs=0,Je=qe=Re=null,Zc=!1,e)throw Error(B(300));return t}function Qp(){var t=Aa!==0;return Aa=0,t}function mn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Je===null?Re.memoizedState=Je=t:Je=Je.next=t,Je}function Xt(){if(qe===null){var t=Re.alternate;t=t!==null?t.memoizedState:null}else t=qe.next;var e=Je===null?Re.memoizedState:Je.next;if(e!==null)Je=e,qe=t;else{if(t===null)throw Error(B(310));qe=t,t={memoizedState:qe.memoizedState,baseState:qe.baseState,baseQueue:qe.baseQueue,queue:qe.queue,next:null},Je===null?Re.memoizedState=Je=t:Je=Je.next=t}return Je}function Ra(t,e){return typeof e=="function"?e(t):e}function wh(t){var e=Xt(),n=e.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=t;var r=qe,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,d=i;do{var h=d.lane;if((bs&h)===h)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(a=l=p,o=r):l=l.next=p,Re.lanes|=h,As|=h}d=d.next}while(d!==null&&d!==i);l===null?o=r:l.next=a,un(r,e.memoizedState)||(At=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Re.lanes|=i,As|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function xh(t){var e=Xt(),n=e.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);un(i,e.memoizedState)||(At=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function ix(){}function ox(t,e){var n=Re,r=Xt(),s=e(),i=!un(r.memoizedState,s);if(i&&(r.memoizedState=s,At=!0),r=r.queue,Jp(cx.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Je!==null&&Je.memoizedState.tag&1){if(n.flags|=2048,Na(9,lx.bind(null,n,r,s,e),void 0,null),Ye===null)throw Error(B(349));bs&30||ax(n,e,s)}return s}function ax(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Re.updateQueue,e===null?(e={lastEffect:null,stores:null},Re.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function lx(t,e,n,r){e.value=n,e.getSnapshot=r,ux(e)&&dx(t)}function cx(t,e,n){return n(function(){ux(e)&&dx(t)})}function ux(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!un(t,n)}catch{return!0}}function dx(t){var e=Qn(t,1);e!==null&&ln(e,t,1,-1)}function av(t){var e=mn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ra,lastRenderedState:t},e.queue=t,t=t.dispatch=ub.bind(null,Re,t),[e.memoizedState,t]}function Na(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Re.updateQueue,e===null?(e={lastEffect:null,stores:null},Re.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function hx(){return Xt().memoizedState}function yc(t,e,n,r){var s=mn();Re.flags|=t,s.memoizedState=Na(1|e,n,void 0,r===void 0?null:r)}function Bu(t,e,n,r){var s=Xt();r=r===void 0?null:r;var i=void 0;if(qe!==null){var o=qe.memoizedState;if(i=o.destroy,r!==null&&Wp(r,o.deps)){s.memoizedState=Na(e,n,i,r);return}}Re.flags|=t,s.memoizedState=Na(1|e,n,i,r)}function lv(t,e){return yc(8390656,8,t,e)}function Jp(t,e){return Bu(2048,8,t,e)}function fx(t,e){return Bu(4,2,t,e)}function px(t,e){return Bu(4,4,t,e)}function mx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function gx(t,e,n){return n=n!=null?n.concat([t]):null,Bu(4,4,mx.bind(null,e,t),n)}function Yp(){}function yx(t,e){var n=Xt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wp(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function vx(t,e){var n=Xt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wp(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function _x(t,e,n){return bs&21?(un(n,e)||(n=Tw(),Re.lanes|=n,As|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,At=!0),t.memoizedState=n)}function lb(t,e){var n=me;me=n!==0&&4>n?n:4,t(!0);var r=_h.transition;_h.transition={};try{t(!1),e()}finally{me=n,_h.transition=r}}function wx(){return Xt().memoizedState}function cb(t,e,n){var r=Pr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},xx(t))Ex(e,n);else if(n=nx(t,e,n,r),n!==null){var s=_t();ln(n,t,r,s),Ix(n,e,r)}}function ub(t,e,n){var r=Pr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(xx(t))Ex(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,un(a,o)){var l=e.interleaved;l===null?(s.next=s,Bp(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=nx(t,e,s,r),n!==null&&(s=_t(),ln(n,t,r,s),Ix(n,e,r))}}function xx(t){var e=t.alternate;return t===Re||e!==null&&e===Re}function Ex(t,e){sa=Zc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Ix(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ap(t,n)}}var eu={readContext:Yt,useCallback:at,useContext:at,useEffect:at,useImperativeHandle:at,useInsertionEffect:at,useLayoutEffect:at,useMemo:at,useReducer:at,useRef:at,useState:at,useDebugValue:at,useDeferredValue:at,useTransition:at,useMutableSource:at,useSyncExternalStore:at,useId:at,unstable_isNewReconciler:!1},db={readContext:Yt,useCallback:function(t,e){return mn().memoizedState=[t,e===void 0?null:e],t},useContext:Yt,useEffect:lv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,yc(4194308,4,mx.bind(null,e,t),n)},useLayoutEffect:function(t,e){return yc(4194308,4,t,e)},useInsertionEffect:function(t,e){return yc(4,2,t,e)},useMemo:function(t,e){var n=mn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=mn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=cb.bind(null,Re,t),[r.memoizedState,t]},useRef:function(t){var e=mn();return t={current:t},e.memoizedState=t},useState:av,useDebugValue:Yp,useDeferredValue:function(t){return mn().memoizedState=t},useTransition:function(){var t=av(!1),e=t[0];return t=lb.bind(null,t[1]),mn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Re,s=mn();if(ke){if(n===void 0)throw Error(B(407));n=n()}else{if(n=e(),Ye===null)throw Error(B(349));bs&30||ax(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,lv(cx.bind(null,r,i,t),[t]),r.flags|=2048,Na(9,lx.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=mn(),e=Ye.identifierPrefix;if(ke){var n=Un,r=Fn;n=(r&~(1<<32-an(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Aa++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=ab++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},hb={readContext:Yt,useCallback:yx,useContext:Yt,useEffect:Jp,useImperativeHandle:gx,useInsertionEffect:fx,useLayoutEffect:px,useMemo:vx,useReducer:wh,useRef:hx,useState:function(){return wh(Ra)},useDebugValue:Yp,useDeferredValue:function(t){var e=Xt();return _x(e,qe.memoizedState,t)},useTransition:function(){var t=wh(Ra)[0],e=Xt().memoizedState;return[t,e]},useMutableSource:ix,useSyncExternalStore:ox,useId:wx,unstable_isNewReconciler:!1},fb={readContext:Yt,useCallback:yx,useContext:Yt,useEffect:Jp,useImperativeHandle:gx,useInsertionEffect:fx,useLayoutEffect:px,useMemo:vx,useReducer:xh,useRef:hx,useState:function(){return xh(Ra)},useDebugValue:Yp,useDeferredValue:function(t){var e=Xt();return qe===null?e.memoizedState=t:_x(e,qe.memoizedState,t)},useTransition:function(){var t=xh(Ra)[0],e=Xt().memoizedState;return[t,e]},useMutableSource:ix,useSyncExternalStore:ox,useId:wx,unstable_isNewReconciler:!1};function nn(t,e){if(t&&t.defaultProps){e=Ce({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function _f(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ce({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var $u={isMounted:function(t){return(t=t._reactInternals)?Ks(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=_t(),s=Pr(t),i=Kn(r,s);i.payload=e,n!=null&&(i.callback=n),e=Nr(t,i,s),e!==null&&(ln(e,t,s,r),mc(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=_t(),s=Pr(t),i=Kn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Nr(t,i,s),e!==null&&(ln(e,t,s,r),mc(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=_t(),r=Pr(t),s=Kn(n,r);s.tag=2,e!=null&&(s.callback=e),e=Nr(t,s,r),e!==null&&(ln(e,t,r,n),mc(e,t,r))}};function cv(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Ea(n,r)||!Ea(s,i):!0}function Tx(t,e,n){var r=!1,s=Ur,i=e.contextType;return typeof i=="object"&&i!==null?i=Yt(i):(s=Pt(e)?Ss:mt.current,r=e.contextTypes,i=(r=r!=null)?Li(t,s):Ur),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=$u,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function uv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&$u.enqueueReplaceState(e,e.state,null)}function wf(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},$p(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Yt(i):(i=Pt(e)?Ss:mt.current,s.context=Li(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(_f(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&$u.enqueueReplaceState(s,s.state,null),Yc(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Bi(t,e){try{var n="",r=e;do n+=zS(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Eh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function xf(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var pb=typeof WeakMap=="function"?WeakMap:Map;function Sx(t,e,n){n=Kn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){nu||(nu=!0,Cf=r),xf(t,e)},n}function kx(t,e,n){n=Kn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){xf(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){xf(t,e),typeof r!="function"&&(Cr===null?Cr=new Set([this]):Cr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function dv(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new pb;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=Ab.bind(null,t,e,n),e.then(t,t))}function hv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function fv(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Kn(-1,1),e.tag=2,Nr(n,e,1))),n.lanes|=1),t)}var mb=er.ReactCurrentOwner,At=!1;function vt(t,e,n,r){e.child=t===null?tx(e,null,n,r):Ui(e,t.child,n,r)}function pv(t,e,n,r,s){n=n.render;var i=e.ref;return Ni(e,s),r=Hp(t,e,n,r,i,s),n=Qp(),t!==null&&!At?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Jn(t,e,s)):(ke&&n&&Op(e),e.flags|=1,vt(t,e,r,s),e.child)}function mv(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!im(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,bx(t,e,i,r,s)):(t=xc(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ea,n(o,r)&&t.ref===e.ref)return Jn(t,e,s)}return e.flags|=1,t=Dr(i,r),t.ref=e.ref,t.return=e,e.child=t}function bx(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Ea(i,r)&&t.ref===e.ref)if(At=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(At=!0);else return e.lanes=t.lanes,Jn(t,e,s)}return Ef(t,e,n,r,s)}function Ax(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},we(Ti,Mt),Mt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,we(Ti,Mt),Mt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,we(Ti,Mt),Mt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,we(Ti,Mt),Mt|=r;return vt(t,e,s,n),e.child}function Rx(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ef(t,e,n,r,s){var i=Pt(n)?Ss:mt.current;return i=Li(e,i),Ni(e,s),n=Hp(t,e,n,r,i,s),r=Qp(),t!==null&&!At?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Jn(t,e,s)):(ke&&r&&Op(e),e.flags|=1,vt(t,e,n,s),e.child)}function gv(t,e,n,r,s){if(Pt(n)){var i=!0;Gc(e)}else i=!1;if(Ni(e,s),e.stateNode===null)vc(t,e),Tx(e,n,r),wf(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Yt(d):(d=Pt(n)?Ss:mt.current,d=Li(e,d));var h=n.getDerivedStateFromProps,p=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==d)&&uv(e,o,r,d),hr=!1;var g=e.memoizedState;o.state=g,Yc(e,r,o,s),l=e.memoizedState,a!==r||g!==l||Ct.current||hr?(typeof h=="function"&&(_f(e,n,h,r),l=e.memoizedState),(a=hr||cv(e,n,a,r,g,l,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,rx(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:nn(e.type,a),o.props=d,p=e.pendingProps,g=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Yt(l):(l=Pt(n)?Ss:mt.current,l=Li(e,l));var v=n.getDerivedStateFromProps;(h=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||g!==l)&&uv(e,o,r,l),hr=!1,g=e.memoizedState,o.state=g,Yc(e,r,o,s);var T=e.memoizedState;a!==p||g!==T||Ct.current||hr?(typeof v=="function"&&(_f(e,n,v,r),T=e.memoizedState),(d=hr||cv(e,n,d,r,g,T,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,T,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,T,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=T),o.props=r,o.state=T,o.context=l,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return If(t,e,n,r,i,s)}function If(t,e,n,r,s,i){Rx(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&tv(e,n,!1),Jn(t,e,i);r=e.stateNode,mb.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ui(e,t.child,null,i),e.child=Ui(e,null,a,i)):vt(t,e,a,i),e.memoizedState=r.state,s&&tv(e,n,!0),e.child}function Nx(t){var e=t.stateNode;e.pendingContext?ev(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ev(t,e.context,!1),qp(t,e.containerInfo)}function yv(t,e,n,r,s){return Fi(),Lp(s),e.flags|=256,vt(t,e,n,r),e.child}var Tf={dehydrated:null,treeContext:null,retryLane:0};function Sf(t){return{baseLanes:t,cachePool:null,transitions:null}}function Cx(t,e,n){var r=e.pendingProps,s=be.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),we(be,s&1),t===null)return yf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Gu(o,r,0,null),t=ws(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Sf(n),e.memoizedState=Tf,t):Xp(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return gb(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Dr(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Dr(a,i):(i=ws(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Sf(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Tf,r}return i=t.child,t=i.sibling,r=Dr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Xp(t,e){return e=Gu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Xl(t,e,n,r){return r!==null&&Lp(r),Ui(e,t.child,null,n),t=Xp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function gb(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Eh(Error(B(422))),Xl(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Gu({mode:"visible",children:r.children},s,0,null),i=ws(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ui(e,t.child,null,o),e.child.memoizedState=Sf(o),e.memoizedState=Tf,i);if(!(e.mode&1))return Xl(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(B(419)),r=Eh(i,r,void 0),Xl(t,e,o,r)}if(a=(o&t.childLanes)!==0,At||a){if(r=Ye,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Qn(t,s),ln(r,t,s,-1))}return sm(),r=Eh(Error(B(421))),Xl(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Rb.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Lt=Rr(s.nextSibling),Ut=e,ke=!0,sn=null,t!==null&&(Wt[Ht++]=Fn,Wt[Ht++]=Un,Wt[Ht++]=ks,Fn=t.id,Un=t.overflow,ks=e),e=Xp(e,r.children),e.flags|=4096,e)}function vv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),vf(t.return,e,n)}function Ih(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Px(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(vt(t,e,r.children,n),r=be.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&vv(t,n,e);else if(t.tag===19)vv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(we(be,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Xc(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Ih(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Xc(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Ih(e,!0,n,null,i);break;case"together":Ih(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function vc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Jn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),As|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(B(153));if(e.child!==null){for(t=e.child,n=Dr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Dr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function yb(t,e,n){switch(e.tag){case 3:Nx(e),Fi();break;case 5:sx(e);break;case 1:Pt(e.type)&&Gc(e);break;case 4:qp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;we(Qc,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(we(be,be.current&1),e.flags|=128,null):n&e.child.childLanes?Cx(t,e,n):(we(be,be.current&1),t=Jn(t,e,n),t!==null?t.sibling:null);we(be,be.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Px(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),we(be,be.current),r)break;return null;case 22:case 23:return e.lanes=0,Ax(t,e,n)}return Jn(t,e,n)}var Dx,kf,jx,Vx;Dx=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};kf=function(){};jx=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,vs(xn.current);var i=null;switch(n){case"input":s=Wh(t,s),r=Wh(t,r),i=[];break;case"select":s=Ce({},s,{value:void 0}),r=Ce({},r,{value:void 0}),i=[];break;case"textarea":s=Jh(t,s),r=Jh(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=qc)}Xh(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ma.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var l=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&l!==a&&(l!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(d,n)),n=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ma.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&Ie("scroll",t),i||a===l||(i=[])):(i=i||[]).push(d,l))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};Vx=function(t,e,n,r){n!==r&&(e.flags|=4)};function jo(t,e){if(!ke)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function lt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function vb(t,e,n){var r=e.pendingProps;switch(Mp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(e),null;case 1:return Pt(e.type)&&Kc(),lt(e),null;case 3:return r=e.stateNode,zi(),Te(Ct),Te(mt),Gp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Jl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,sn!==null&&(jf(sn),sn=null))),kf(t,e),lt(e),null;case 5:Kp(e);var s=vs(ba.current);if(n=e.type,t!==null&&e.stateNode!=null)jx(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(B(166));return lt(e),null}if(t=vs(xn.current),Jl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[gn]=e,r[Sa]=i,t=(e.mode&1)!==0,n){case"dialog":Ie("cancel",r),Ie("close",r);break;case"iframe":case"object":case"embed":Ie("load",r);break;case"video":case"audio":for(s=0;s<Ko.length;s++)Ie(Ko[s],r);break;case"source":Ie("error",r);break;case"img":case"image":case"link":Ie("error",r),Ie("load",r);break;case"details":Ie("toggle",r);break;case"input":by(r,i),Ie("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ie("invalid",r);break;case"textarea":Ry(r,i),Ie("invalid",r)}Xh(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Ql(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Ql(r.textContent,a,t),s=["children",""+a]):ma.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ie("scroll",r)}switch(n){case"input":zl(r),Ay(r,i,!0);break;case"textarea":zl(r),Ny(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=qc)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=cw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[gn]=e,t[Sa]=r,Dx(t,e,!1,!1),e.stateNode=t;e:{switch(o=Zh(n,r),n){case"dialog":Ie("cancel",t),Ie("close",t),s=r;break;case"iframe":case"object":case"embed":Ie("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ko.length;s++)Ie(Ko[s],t);s=r;break;case"source":Ie("error",t),s=r;break;case"img":case"image":case"link":Ie("error",t),Ie("load",t),s=r;break;case"details":Ie("toggle",t),s=r;break;case"input":by(t,r),s=Wh(t,r),Ie("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ce({},r,{value:void 0}),Ie("invalid",t);break;case"textarea":Ry(t,r),s=Jh(t,r),Ie("invalid",t);break;default:s=r}Xh(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?hw(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&uw(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&ga(t,l):typeof l=="number"&&ga(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ma.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Ie("scroll",t):l!=null&&Ep(t,i,l,o))}switch(n){case"input":zl(t),Ay(t,r,!1);break;case"textarea":zl(t),Ny(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Fr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ki(t,!!r.multiple,i,!1):r.defaultValue!=null&&ki(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=qc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return lt(e),null;case 6:if(t&&e.stateNode!=null)Vx(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(B(166));if(n=vs(ba.current),vs(xn.current),Jl(e)){if(r=e.stateNode,n=e.memoizedProps,r[gn]=e,(i=r.nodeValue!==n)&&(t=Ut,t!==null))switch(t.tag){case 3:Ql(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ql(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[gn]=e,e.stateNode=r}return lt(e),null;case 13:if(Te(be),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ke&&Lt!==null&&e.mode&1&&!(e.flags&128))Zw(),Fi(),e.flags|=98560,i=!1;else if(i=Jl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(B(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(B(317));i[gn]=e}else Fi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;lt(e),i=!1}else sn!==null&&(jf(sn),sn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||be.current&1?Ke===0&&(Ke=3):sm())),e.updateQueue!==null&&(e.flags|=4),lt(e),null);case 4:return zi(),kf(t,e),t===null&&Ia(e.stateNode.containerInfo),lt(e),null;case 10:return zp(e.type._context),lt(e),null;case 17:return Pt(e.type)&&Kc(),lt(e),null;case 19:if(Te(be),i=e.memoizedState,i===null)return lt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)jo(i,!1);else{if(Ke!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Xc(t),o!==null){for(e.flags|=128,jo(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return we(be,be.current&1|2),e.child}t=t.sibling}i.tail!==null&&Le()>$i&&(e.flags|=128,r=!0,jo(i,!1),e.lanes=4194304)}else{if(!r)if(t=Xc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),jo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ke)return lt(e),null}else 2*Le()-i.renderingStartTime>$i&&n!==1073741824&&(e.flags|=128,r=!0,jo(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Le(),e.sibling=null,n=be.current,we(be,r?n&1|2:n&1),e):(lt(e),null);case 22:case 23:return rm(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Mt&1073741824&&(lt(e),e.subtreeFlags&6&&(e.flags|=8192)):lt(e),null;case 24:return null;case 25:return null}throw Error(B(156,e.tag))}function _b(t,e){switch(Mp(e),e.tag){case 1:return Pt(e.type)&&Kc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return zi(),Te(Ct),Te(mt),Gp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Kp(e),null;case 13:if(Te(be),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(B(340));Fi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Te(be),null;case 4:return zi(),null;case 10:return zp(e.type._context),null;case 22:case 23:return rm(),null;case 24:return null;default:return null}}var Zl=!1,dt=!1,wb=typeof WeakSet=="function"?WeakSet:Set,W=null;function Ii(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){je(t,e,r)}else n.current=null}function bf(t,e,n){try{n()}catch(r){je(t,e,r)}}var _v=!1;function xb(t,e){if(uf=zc,t=Uw(),Vp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,d=0,h=0,p=t,g=null;t:for(;;){for(var v;p!==n||s!==0&&p.nodeType!==3||(a=o+s),p!==i||r!==0&&p.nodeType!==3||(l=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(v=p.firstChild)!==null;)g=p,p=v;for(;;){if(p===t)break t;if(g===n&&++d===s&&(a=o),g===i&&++h===r&&(l=o),(v=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=v}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(df={focusedElem:t,selectionRange:n},zc=!1,W=e;W!==null;)if(e=W,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,W=t;else for(;W!==null;){e=W;try{var T=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var b=T.memoizedProps,E=T.memoizedState,_=e.stateNode,y=_.getSnapshotBeforeUpdate(e.elementType===e.type?b:nn(e.type,b),E);_.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(B(163))}}catch(P){je(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,W=t;break}W=e.return}return T=_v,_v=!1,T}function ia(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&bf(e,n,i)}s=s.next}while(s!==r)}}function qu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Af(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Ox(t){var e=t.alternate;e!==null&&(t.alternate=null,Ox(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[gn],delete e[Sa],delete e[pf],delete e[rb],delete e[sb])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Mx(t){return t.tag===5||t.tag===3||t.tag===4}function wv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Mx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Rf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=qc));else if(r!==4&&(t=t.child,t!==null))for(Rf(t,e,n),t=t.sibling;t!==null;)Rf(t,e,n),t=t.sibling}function Nf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Nf(t,e,n),t=t.sibling;t!==null;)Nf(t,e,n),t=t.sibling}var Ze=null,rn=!1;function or(t,e,n){for(n=n.child;n!==null;)Lx(t,e,n),n=n.sibling}function Lx(t,e,n){if(wn&&typeof wn.onCommitFiberUnmount=="function")try{wn.onCommitFiberUnmount(Ou,n)}catch{}switch(n.tag){case 5:dt||Ii(n,e);case 6:var r=Ze,s=rn;Ze=null,or(t,e,n),Ze=r,rn=s,Ze!==null&&(rn?(t=Ze,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ze.removeChild(n.stateNode));break;case 18:Ze!==null&&(rn?(t=Ze,n=n.stateNode,t.nodeType===8?gh(t.parentNode,n):t.nodeType===1&&gh(t,n),wa(t)):gh(Ze,n.stateNode));break;case 4:r=Ze,s=rn,Ze=n.stateNode.containerInfo,rn=!0,or(t,e,n),Ze=r,rn=s;break;case 0:case 11:case 14:case 15:if(!dt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&bf(n,e,o),s=s.next}while(s!==r)}or(t,e,n);break;case 1:if(!dt&&(Ii(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){je(n,e,a)}or(t,e,n);break;case 21:or(t,e,n);break;case 22:n.mode&1?(dt=(r=dt)||n.memoizedState!==null,or(t,e,n),dt=r):or(t,e,n);break;default:or(t,e,n)}}function xv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new wb),e.forEach(function(r){var s=Nb.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function tn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ze=a.stateNode,rn=!1;break e;case 3:Ze=a.stateNode.containerInfo,rn=!0;break e;case 4:Ze=a.stateNode.containerInfo,rn=!0;break e}a=a.return}if(Ze===null)throw Error(B(160));Lx(i,o,s),Ze=null,rn=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(d){je(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Fx(e,t),e=e.sibling}function Fx(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(tn(e,t),pn(t),r&4){try{ia(3,t,t.return),qu(3,t)}catch(b){je(t,t.return,b)}try{ia(5,t,t.return)}catch(b){je(t,t.return,b)}}break;case 1:tn(e,t),pn(t),r&512&&n!==null&&Ii(n,n.return);break;case 5:if(tn(e,t),pn(t),r&512&&n!==null&&Ii(n,n.return),t.flags&32){var s=t.stateNode;try{ga(s,"")}catch(b){je(t,t.return,b)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&aw(s,i),Zh(a,o);var d=Zh(a,i);for(o=0;o<l.length;o+=2){var h=l[o],p=l[o+1];h==="style"?hw(s,p):h==="dangerouslySetInnerHTML"?uw(s,p):h==="children"?ga(s,p):Ep(s,h,p,d)}switch(a){case"input":Hh(s,i);break;case"textarea":lw(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?ki(s,!!i.multiple,v,!1):g!==!!i.multiple&&(i.defaultValue!=null?ki(s,!!i.multiple,i.defaultValue,!0):ki(s,!!i.multiple,i.multiple?[]:"",!1))}s[Sa]=i}catch(b){je(t,t.return,b)}}break;case 6:if(tn(e,t),pn(t),r&4){if(t.stateNode===null)throw Error(B(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(b){je(t,t.return,b)}}break;case 3:if(tn(e,t),pn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{wa(e.containerInfo)}catch(b){je(t,t.return,b)}break;case 4:tn(e,t),pn(t);break;case 13:tn(e,t),pn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(tm=Le())),r&4&&xv(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(dt=(d=dt)||h,tn(e,t),dt=d):tn(e,t),pn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(W=t,h=t.child;h!==null;){for(p=W=h;W!==null;){switch(g=W,v=g.child,g.tag){case 0:case 11:case 14:case 15:ia(4,g,g.return);break;case 1:Ii(g,g.return);var T=g.stateNode;if(typeof T.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,T.props=e.memoizedProps,T.state=e.memoizedState,T.componentWillUnmount()}catch(b){je(r,n,b)}}break;case 5:Ii(g,g.return);break;case 22:if(g.memoizedState!==null){Iv(p);continue}}v!==null?(v.return=g,W=v):Iv(p)}h=h.sibling}e:for(h=null,p=t;;){if(p.tag===5){if(h===null){h=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=dw("display",o))}catch(b){je(t,t.return,b)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(b){je(t,t.return,b)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:tn(e,t),pn(t),r&4&&xv(t);break;case 21:break;default:tn(e,t),pn(t)}}function pn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Mx(n)){var r=n;break e}n=n.return}throw Error(B(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ga(s,""),r.flags&=-33);var i=wv(t);Nf(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=wv(t);Rf(t,a,o);break;default:throw Error(B(161))}}catch(l){je(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Eb(t,e,n){W=t,Ux(t)}function Ux(t,e,n){for(var r=(t.mode&1)!==0;W!==null;){var s=W,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Zl;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||dt;a=Zl;var d=dt;if(Zl=o,(dt=l)&&!d)for(W=s;W!==null;)o=W,l=o.child,o.tag===22&&o.memoizedState!==null?Tv(s):l!==null?(l.return=o,W=l):Tv(s);for(;i!==null;)W=i,Ux(i),i=i.sibling;W=s,Zl=a,dt=d}Ev(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,W=i):Ev(t)}}function Ev(t){for(;W!==null;){var e=W;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:dt||qu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!dt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:nn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&ov(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}ov(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&wa(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(B(163))}dt||e.flags&512&&Af(e)}catch(g){je(e,e.return,g)}}if(e===t){W=null;break}if(n=e.sibling,n!==null){n.return=e.return,W=n;break}W=e.return}}function Iv(t){for(;W!==null;){var e=W;if(e===t){W=null;break}var n=e.sibling;if(n!==null){n.return=e.return,W=n;break}W=e.return}}function Tv(t){for(;W!==null;){var e=W;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{qu(4,e)}catch(l){je(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){je(e,s,l)}}var i=e.return;try{Af(e)}catch(l){je(e,i,l)}break;case 5:var o=e.return;try{Af(e)}catch(l){je(e,o,l)}}}catch(l){je(e,e.return,l)}if(e===t){W=null;break}var a=e.sibling;if(a!==null){a.return=e.return,W=a;break}W=e.return}}var Ib=Math.ceil,tu=er.ReactCurrentDispatcher,Zp=er.ReactCurrentOwner,Jt=er.ReactCurrentBatchConfig,de=0,Ye=null,Be=null,tt=0,Mt=0,Ti=Wr(0),Ke=0,Ca=null,As=0,Ku=0,em=0,oa=null,St=null,tm=0,$i=1/0,Mn=null,nu=!1,Cf=null,Cr=null,ec=!1,Ir=null,ru=0,aa=0,Pf=null,_c=-1,wc=0;function _t(){return de&6?Le():_c!==-1?_c:_c=Le()}function Pr(t){return t.mode&1?de&2&&tt!==0?tt&-tt:ob.transition!==null?(wc===0&&(wc=Tw()),wc):(t=me,t!==0||(t=window.event,t=t===void 0?16:Cw(t.type)),t):1}function ln(t,e,n,r){if(50<aa)throw aa=0,Pf=null,Error(B(185));Za(t,n,r),(!(de&2)||t!==Ye)&&(t===Ye&&(!(de&2)&&(Ku|=n),Ke===4&&mr(t,tt)),Dt(t,r),n===1&&de===0&&!(e.mode&1)&&($i=Le()+500,zu&&Hr()))}function Dt(t,e){var n=t.callbackNode;ok(t,e);var r=Uc(t,t===Ye?tt:0);if(r===0)n!==null&&Dy(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Dy(n),e===1)t.tag===0?ib(Sv.bind(null,t)):Jw(Sv.bind(null,t)),tb(function(){!(de&6)&&Hr()}),n=null;else{switch(Sw(r)){case 1:n=bp;break;case 4:n=Ew;break;case 16:n=Fc;break;case 536870912:n=Iw;break;default:n=Fc}n=Hx(n,zx.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function zx(t,e){if(_c=-1,wc=0,de&6)throw Error(B(327));var n=t.callbackNode;if(Ci()&&t.callbackNode!==n)return null;var r=Uc(t,t===Ye?tt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=su(t,r);else{e=r;var s=de;de|=2;var i=$x();(Ye!==t||tt!==e)&&(Mn=null,$i=Le()+500,_s(t,e));do try{kb();break}catch(a){Bx(t,a)}while(!0);Up(),tu.current=i,de=s,Be!==null?e=0:(Ye=null,tt=0,e=Ke)}if(e!==0){if(e===2&&(s=sf(t),s!==0&&(r=s,e=Df(t,s))),e===1)throw n=Ca,_s(t,0),mr(t,r),Dt(t,Le()),n;if(e===6)mr(t,r);else{if(s=t.current.alternate,!(r&30)&&!Tb(s)&&(e=su(t,r),e===2&&(i=sf(t),i!==0&&(r=i,e=Df(t,i))),e===1))throw n=Ca,_s(t,0),mr(t,r),Dt(t,Le()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(B(345));case 2:cs(t,St,Mn);break;case 3:if(mr(t,r),(r&130023424)===r&&(e=tm+500-Le(),10<e)){if(Uc(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){_t(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=ff(cs.bind(null,t,St,Mn),e);break}cs(t,St,Mn);break;case 4:if(mr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-an(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Le()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ib(r/1960))-r,10<r){t.timeoutHandle=ff(cs.bind(null,t,St,Mn),r);break}cs(t,St,Mn);break;case 5:cs(t,St,Mn);break;default:throw Error(B(329))}}}return Dt(t,Le()),t.callbackNode===n?zx.bind(null,t):null}function Df(t,e){var n=oa;return t.current.memoizedState.isDehydrated&&(_s(t,e).flags|=256),t=su(t,e),t!==2&&(e=St,St=n,e!==null&&jf(e)),t}function jf(t){St===null?St=t:St.push.apply(St,t)}function Tb(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!un(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function mr(t,e){for(e&=~em,e&=~Ku,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-an(e),r=1<<n;t[n]=-1,e&=~r}}function Sv(t){if(de&6)throw Error(B(327));Ci();var e=Uc(t,0);if(!(e&1))return Dt(t,Le()),null;var n=su(t,e);if(t.tag!==0&&n===2){var r=sf(t);r!==0&&(e=r,n=Df(t,r))}if(n===1)throw n=Ca,_s(t,0),mr(t,e),Dt(t,Le()),n;if(n===6)throw Error(B(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,cs(t,St,Mn),Dt(t,Le()),null}function nm(t,e){var n=de;de|=1;try{return t(e)}finally{de=n,de===0&&($i=Le()+500,zu&&Hr())}}function Rs(t){Ir!==null&&Ir.tag===0&&!(de&6)&&Ci();var e=de;de|=1;var n=Jt.transition,r=me;try{if(Jt.transition=null,me=1,t)return t()}finally{me=r,Jt.transition=n,de=e,!(de&6)&&Hr()}}function rm(){Mt=Ti.current,Te(Ti)}function _s(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,eb(n)),Be!==null)for(n=Be.return;n!==null;){var r=n;switch(Mp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Kc();break;case 3:zi(),Te(Ct),Te(mt),Gp();break;case 5:Kp(r);break;case 4:zi();break;case 13:Te(be);break;case 19:Te(be);break;case 10:zp(r.type._context);break;case 22:case 23:rm()}n=n.return}if(Ye=t,Be=t=Dr(t.current,null),tt=Mt=e,Ke=0,Ca=null,em=Ku=As=0,St=oa=null,ys!==null){for(e=0;e<ys.length;e++)if(n=ys[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}ys=null}return t}function Bx(t,e){do{var n=Be;try{if(Up(),gc.current=eu,Zc){for(var r=Re.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Zc=!1}if(bs=0,Je=qe=Re=null,sa=!1,Aa=0,Zp.current=null,n===null||n.return===null){Ke=1,Ca=e,Be=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=tt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,h=a,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var g=h.alternate;g?(h.updateQueue=g.updateQueue,h.memoizedState=g.memoizedState,h.lanes=g.lanes):(h.updateQueue=null,h.memoizedState=null)}var v=hv(o);if(v!==null){v.flags&=-257,fv(v,o,a,i,e),v.mode&1&&dv(i,d,e),e=v,l=d;var T=e.updateQueue;if(T===null){var b=new Set;b.add(l),e.updateQueue=b}else T.add(l);break e}else{if(!(e&1)){dv(i,d,e),sm();break e}l=Error(B(426))}}else if(ke&&a.mode&1){var E=hv(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),fv(E,o,a,i,e),Lp(Bi(l,a));break e}}i=l=Bi(l,a),Ke!==4&&(Ke=2),oa===null?oa=[i]:oa.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var _=Sx(i,l,e);iv(i,_);break e;case 1:a=l;var y=i.type,I=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(Cr===null||!Cr.has(I)))){i.flags|=65536,e&=-e,i.lanes|=e;var P=kx(i,a,e);iv(i,P);break e}}i=i.return}while(i!==null)}Kx(n)}catch(O){e=O,Be===n&&n!==null&&(Be=n=n.return);continue}break}while(!0)}function $x(){var t=tu.current;return tu.current=eu,t===null?eu:t}function sm(){(Ke===0||Ke===3||Ke===2)&&(Ke=4),Ye===null||!(As&268435455)&&!(Ku&268435455)||mr(Ye,tt)}function su(t,e){var n=de;de|=2;var r=$x();(Ye!==t||tt!==e)&&(Mn=null,_s(t,e));do try{Sb();break}catch(s){Bx(t,s)}while(!0);if(Up(),de=n,tu.current=r,Be!==null)throw Error(B(261));return Ye=null,tt=0,Ke}function Sb(){for(;Be!==null;)qx(Be)}function kb(){for(;Be!==null&&!YS();)qx(Be)}function qx(t){var e=Wx(t.alternate,t,Mt);t.memoizedProps=t.pendingProps,e===null?Kx(t):Be=e,Zp.current=null}function Kx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=_b(n,e),n!==null){n.flags&=32767,Be=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ke=6,Be=null;return}}else if(n=vb(n,e,Mt),n!==null){Be=n;return}if(e=e.sibling,e!==null){Be=e;return}Be=e=t}while(e!==null);Ke===0&&(Ke=5)}function cs(t,e,n){var r=me,s=Jt.transition;try{Jt.transition=null,me=1,bb(t,e,n,r)}finally{Jt.transition=s,me=r}return null}function bb(t,e,n,r){do Ci();while(Ir!==null);if(de&6)throw Error(B(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(B(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(ak(t,i),t===Ye&&(Be=Ye=null,tt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ec||(ec=!0,Hx(Fc,function(){return Ci(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Jt.transition,Jt.transition=null;var o=me;me=1;var a=de;de|=4,Zp.current=null,xb(t,n),Fx(n,t),Wk(df),zc=!!uf,df=uf=null,t.current=n,Eb(n),XS(),de=a,me=o,Jt.transition=i}else t.current=n;if(ec&&(ec=!1,Ir=t,ru=s),i=t.pendingLanes,i===0&&(Cr=null),tk(n.stateNode),Dt(t,Le()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(nu)throw nu=!1,t=Cf,Cf=null,t;return ru&1&&t.tag!==0&&Ci(),i=t.pendingLanes,i&1?t===Pf?aa++:(aa=0,Pf=t):aa=0,Hr(),null}function Ci(){if(Ir!==null){var t=Sw(ru),e=Jt.transition,n=me;try{if(Jt.transition=null,me=16>t?16:t,Ir===null)var r=!1;else{if(t=Ir,Ir=null,ru=0,de&6)throw Error(B(331));var s=de;for(de|=4,W=t.current;W!==null;){var i=W,o=i.child;if(W.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var d=a[l];for(W=d;W!==null;){var h=W;switch(h.tag){case 0:case 11:case 15:ia(8,h,i)}var p=h.child;if(p!==null)p.return=h,W=p;else for(;W!==null;){h=W;var g=h.sibling,v=h.return;if(Ox(h),h===d){W=null;break}if(g!==null){g.return=v,W=g;break}W=v}}}var T=i.alternate;if(T!==null){var b=T.child;if(b!==null){T.child=null;do{var E=b.sibling;b.sibling=null,b=E}while(b!==null)}}W=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,W=o;else e:for(;W!==null;){if(i=W,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ia(9,i,i.return)}var _=i.sibling;if(_!==null){_.return=i.return,W=_;break e}W=i.return}}var y=t.current;for(W=y;W!==null;){o=W;var I=o.child;if(o.subtreeFlags&2064&&I!==null)I.return=o,W=I;else e:for(o=y;W!==null;){if(a=W,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:qu(9,a)}}catch(O){je(a,a.return,O)}if(a===o){W=null;break e}var P=a.sibling;if(P!==null){P.return=a.return,W=P;break e}W=a.return}}if(de=s,Hr(),wn&&typeof wn.onPostCommitFiberRoot=="function")try{wn.onPostCommitFiberRoot(Ou,t)}catch{}r=!0}return r}finally{me=n,Jt.transition=e}}return!1}function kv(t,e,n){e=Bi(n,e),e=Sx(t,e,1),t=Nr(t,e,1),e=_t(),t!==null&&(Za(t,1,e),Dt(t,e))}function je(t,e,n){if(t.tag===3)kv(t,t,n);else for(;e!==null;){if(e.tag===3){kv(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Cr===null||!Cr.has(r))){t=Bi(n,t),t=kx(e,t,1),e=Nr(e,t,1),t=_t(),e!==null&&(Za(e,1,t),Dt(e,t));break}}e=e.return}}function Ab(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=_t(),t.pingedLanes|=t.suspendedLanes&n,Ye===t&&(tt&n)===n&&(Ke===4||Ke===3&&(tt&130023424)===tt&&500>Le()-tm?_s(t,0):em|=n),Dt(t,e)}function Gx(t,e){e===0&&(t.mode&1?(e=ql,ql<<=1,!(ql&130023424)&&(ql=4194304)):e=1);var n=_t();t=Qn(t,e),t!==null&&(Za(t,e,n),Dt(t,n))}function Rb(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Gx(t,n)}function Nb(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(B(314))}r!==null&&r.delete(e),Gx(t,n)}var Wx;Wx=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ct.current)At=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return At=!1,yb(t,e,n);At=!!(t.flags&131072)}else At=!1,ke&&e.flags&1048576&&Yw(e,Hc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;vc(t,e),t=e.pendingProps;var s=Li(e,mt.current);Ni(e,n),s=Hp(null,e,r,t,s,n);var i=Qp();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Pt(r)?(i=!0,Gc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,$p(e),s.updater=$u,e.stateNode=s,s._reactInternals=e,wf(e,r,t,n),e=If(null,e,r,!0,i,n)):(e.tag=0,ke&&i&&Op(e),vt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(vc(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=Pb(r),t=nn(r,t),s){case 0:e=Ef(null,e,r,t,n);break e;case 1:e=gv(null,e,r,t,n);break e;case 11:e=pv(null,e,r,t,n);break e;case 14:e=mv(null,e,r,nn(r.type,t),n);break e}throw Error(B(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:nn(r,s),Ef(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:nn(r,s),gv(t,e,r,s,n);case 3:e:{if(Nx(e),t===null)throw Error(B(387));r=e.pendingProps,i=e.memoizedState,s=i.element,rx(t,e),Yc(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Bi(Error(B(423)),e),e=yv(t,e,r,n,s);break e}else if(r!==s){s=Bi(Error(B(424)),e),e=yv(t,e,r,n,s);break e}else for(Lt=Rr(e.stateNode.containerInfo.firstChild),Ut=e,ke=!0,sn=null,n=tx(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Fi(),r===s){e=Jn(t,e,n);break e}vt(t,e,r,n)}e=e.child}return e;case 5:return sx(e),t===null&&yf(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,hf(r,s)?o=null:i!==null&&hf(r,i)&&(e.flags|=32),Rx(t,e),vt(t,e,o,n),e.child;case 6:return t===null&&yf(e),null;case 13:return Cx(t,e,n);case 4:return qp(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ui(e,null,r,n):vt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:nn(r,s),pv(t,e,r,s,n);case 7:return vt(t,e,e.pendingProps,n),e.child;case 8:return vt(t,e,e.pendingProps.children,n),e.child;case 12:return vt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,we(Qc,r._currentValue),r._currentValue=o,i!==null)if(un(i.value,o)){if(i.children===s.children&&!Ct.current){e=Jn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=Kn(-1,n&-n),l.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?l.next=l:(l.next=h.next,h.next=l),d.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),vf(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(B(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),vf(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}vt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Ni(e,n),s=Yt(s),r=r(s),e.flags|=1,vt(t,e,r,n),e.child;case 14:return r=e.type,s=nn(r,e.pendingProps),s=nn(r.type,s),mv(t,e,r,s,n);case 15:return bx(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:nn(r,s),vc(t,e),e.tag=1,Pt(r)?(t=!0,Gc(e)):t=!1,Ni(e,n),Tx(e,r,s),wf(e,r,s,n),If(null,e,r,!0,t,n);case 19:return Px(t,e,n);case 22:return Ax(t,e,n)}throw Error(B(156,e.tag))};function Hx(t,e){return xw(t,e)}function Cb(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qt(t,e,n,r){return new Cb(t,e,n,r)}function im(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Pb(t){if(typeof t=="function")return im(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Tp)return 11;if(t===Sp)return 14}return 2}function Dr(t,e){var n=t.alternate;return n===null?(n=Qt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function xc(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")im(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case pi:return ws(n.children,s,i,e);case Ip:o=8,s|=8;break;case $h:return t=Qt(12,n,e,s|2),t.elementType=$h,t.lanes=i,t;case qh:return t=Qt(13,n,e,s),t.elementType=qh,t.lanes=i,t;case Kh:return t=Qt(19,n,e,s),t.elementType=Kh,t.lanes=i,t;case sw:return Gu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case nw:o=10;break e;case rw:o=9;break e;case Tp:o=11;break e;case Sp:o=14;break e;case dr:o=16,r=null;break e}throw Error(B(130,t==null?t:typeof t,""))}return e=Qt(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ws(t,e,n,r){return t=Qt(7,t,r,e),t.lanes=n,t}function Gu(t,e,n,r){return t=Qt(22,t,r,e),t.elementType=sw,t.lanes=n,t.stateNode={isHidden:!1},t}function Th(t,e,n){return t=Qt(6,t,null,e),t.lanes=n,t}function Sh(t,e,n){return e=Qt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Db(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ih(0),this.expirationTimes=ih(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ih(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function om(t,e,n,r,s,i,o,a,l){return t=new Db(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Qt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},$p(i),t}function jb(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Qx(t){if(!t)return Ur;t=t._reactInternals;e:{if(Ks(t)!==t||t.tag!==1)throw Error(B(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Pt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(B(171))}if(t.tag===1){var n=t.type;if(Pt(n))return Qw(t,n,e)}return e}function Jx(t,e,n,r,s,i,o,a,l){return t=om(n,r,!0,t,s,i,o,a,l),t.context=Qx(null),n=t.current,r=_t(),s=Pr(n),i=Kn(r,s),i.callback=e??null,Nr(n,i,s),t.current.lanes=s,Za(t,s,r),Dt(t,r),t}function Wu(t,e,n,r){var s=e.current,i=_t(),o=Pr(s);return n=Qx(n),e.context===null?e.context=n:e.pendingContext=n,e=Kn(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Nr(s,e,o),t!==null&&(ln(t,s,o,i),mc(t,s,o)),o}function iu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function bv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function am(t,e){bv(t,e),(t=t.alternate)&&bv(t,e)}function Vb(){return null}var Yx=typeof reportError=="function"?reportError:function(t){console.error(t)};function lm(t){this._internalRoot=t}Hu.prototype.render=lm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(B(409));Wu(t,e,null,null)};Hu.prototype.unmount=lm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Rs(function(){Wu(null,t,null,null)}),e[Hn]=null}};function Hu(t){this._internalRoot=t}Hu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Aw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<pr.length&&e!==0&&e<pr[n].priority;n++);pr.splice(n,0,t),n===0&&Nw(t)}};function cm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Qu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Av(){}function Ob(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=iu(o);i.call(d)}}var o=Jx(e,r,t,0,null,!1,!1,"",Av);return t._reactRootContainer=o,t[Hn]=o.current,Ia(t.nodeType===8?t.parentNode:t),Rs(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=iu(l);a.call(d)}}var l=om(t,0,!1,null,null,!1,!1,"",Av);return t._reactRootContainer=l,t[Hn]=l.current,Ia(t.nodeType===8?t.parentNode:t),Rs(function(){Wu(e,l,n,r)}),l}function Ju(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=iu(o);a.call(l)}}Wu(e,o,t,s)}else o=Ob(n,e,t,s,r);return iu(o)}kw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=qo(e.pendingLanes);n!==0&&(Ap(e,n|1),Dt(e,Le()),!(de&6)&&($i=Le()+500,Hr()))}break;case 13:Rs(function(){var r=Qn(t,1);if(r!==null){var s=_t();ln(r,t,1,s)}}),am(t,1)}};Rp=function(t){if(t.tag===13){var e=Qn(t,134217728);if(e!==null){var n=_t();ln(e,t,134217728,n)}am(t,134217728)}};bw=function(t){if(t.tag===13){var e=Pr(t),n=Qn(t,e);if(n!==null){var r=_t();ln(n,t,e,r)}am(t,e)}};Aw=function(){return me};Rw=function(t,e){var n=me;try{return me=t,e()}finally{me=n}};tf=function(t,e,n){switch(e){case"input":if(Hh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Uu(r);if(!s)throw Error(B(90));ow(r),Hh(r,s)}}}break;case"textarea":lw(t,n);break;case"select":e=n.value,e!=null&&ki(t,!!n.multiple,e,!1)}};mw=nm;gw=Rs;var Mb={usingClientEntryPoint:!1,Events:[tl,vi,Uu,fw,pw,nm]},Vo={findFiberByHostInstance:gs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Lb={bundleType:Vo.bundleType,version:Vo.version,rendererPackageName:Vo.rendererPackageName,rendererConfig:Vo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:er.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=_w(t),t===null?null:t.stateNode},findFiberByHostInstance:Vo.findFiberByHostInstance||Vb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var tc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tc.isDisabled&&tc.supportsFiber)try{Ou=tc.inject(Lb),wn=tc}catch{}}qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Mb;qt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!cm(e))throw Error(B(200));return jb(t,e,null,n)};qt.createRoot=function(t,e){if(!cm(t))throw Error(B(299));var n=!1,r="",s=Yx;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=om(t,1,!1,null,null,n,!1,r,s),t[Hn]=e.current,Ia(t.nodeType===8?t.parentNode:t),new lm(e)};qt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(B(188)):(t=Object.keys(t).join(","),Error(B(268,t)));return t=_w(e),t=t===null?null:t.stateNode,t};qt.flushSync=function(t){return Rs(t)};qt.hydrate=function(t,e,n){if(!Qu(e))throw Error(B(200));return Ju(null,t,e,!0,n)};qt.hydrateRoot=function(t,e,n){if(!cm(t))throw Error(B(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Yx;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Jx(e,null,t,1,n??null,s,!1,i,o),t[Hn]=e.current,Ia(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Hu(e)};qt.render=function(t,e,n){if(!Qu(e))throw Error(B(200));return Ju(null,t,e,!1,n)};qt.unmountComponentAtNode=function(t){if(!Qu(t))throw Error(B(40));return t._reactRootContainer?(Rs(function(){Ju(null,null,t,!1,function(){t._reactRootContainer=null,t[Hn]=null})}),!0):!1};qt.unstable_batchedUpdates=nm;qt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Qu(n))throw Error(B(200));if(t==null||t._reactInternals===void 0)throw Error(B(38));return Ju(t,e,n,!1,r)};qt.version="18.3.1-next-f1338f8080-20240426";function Xx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Xx)}catch(t){console.error(t)}}Xx(),X_.exports=qt;var Fb=X_.exports,Zx,Rv=Fb;Zx=Rv.createRoot,Rv.hydrateRoot;/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Pa(){return Pa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Pa.apply(this,arguments)}var Tr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Tr||(Tr={}));const Nv="popstate";function Ub(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Vf("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:tE(s)}return Bb(e,n,null,t)}function $e(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function eE(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function zb(){return Math.random().toString(36).substr(2,8)}function Cv(t,e){return{usr:t.state,key:t.key,idx:e}}function Vf(t,e,n,r){return n===void 0&&(n=null),Pa({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ao(e):e,{state:n,key:e&&e.key||r||zb()})}function tE(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ao(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function Bb(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=Tr.Pop,l=null,d=h();d==null&&(d=0,o.replaceState(Pa({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function p(){a=Tr.Pop;let E=h(),_=E==null?null:E-d;d=E,l&&l({action:a,location:b.location,delta:_})}function g(E,_){a=Tr.Push;let y=Vf(b.location,E,_);d=h()+1;let I=Cv(y,d),P=b.createHref(y);try{o.pushState(I,"",P)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(P)}i&&l&&l({action:a,location:b.location,delta:1})}function v(E,_){a=Tr.Replace;let y=Vf(b.location,E,_);d=h();let I=Cv(y,d),P=b.createHref(y);o.replaceState(I,"",P),i&&l&&l({action:a,location:b.location,delta:0})}function T(E){let _=s.location.origin!=="null"?s.location.origin:s.location.href,y=typeof E=="string"?E:tE(E);return y=y.replace(/ $/,"%20"),$e(_,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,_)}let b={get action(){return a},get location(){return t(s,o)},listen(E){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Nv,p),l=E,()=>{s.removeEventListener(Nv,p),l=null}},createHref(E){return e(s,E)},createURL:T,encodeLocation(E){let _=T(E);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:g,replace:v,go(E){return o.go(E)}};return b}var Pv;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Pv||(Pv={}));function $b(t,e,n){return n===void 0&&(n="/"),qb(t,e,n,!1)}function qb(t,e,n,r){let s=typeof e=="string"?ao(e):e,i=sE(s.pathname||"/",n);if(i==null)return null;let o=nE(t);Kb(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let d=nA(i);a=eA(o[l],d,r)}return a}function nE(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&($e(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let d=xs([r,l.relativePath]),h=n.concat(l);i.children&&i.children.length>0&&($e(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),nE(i.children,e,h,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:Xb(d,i.index),routesMeta:h})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of rE(i.path))s(i,o,l)}),e}function rE(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=rE(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function Kb(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Zb(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const Gb=/^:[\w-]+$/,Wb=3,Hb=2,Qb=1,Jb=10,Yb=-2,Dv=t=>t==="*";function Xb(t,e){let n=t.split("/"),r=n.length;return n.some(Dv)&&(r+=Yb),e&&(r+=Hb),n.filter(s=>!Dv(s)).reduce((s,i)=>s+(Gb.test(i)?Wb:i===""?Qb:Jb),r)}function Zb(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function eA(t,e,n){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],d=a===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",p=jv({path:l.relativePath,caseSensitive:l.caseSensitive,end:d},h),g=l.route;if(!p&&d&&n&&!r[r.length-1].route.index&&(p=jv({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!p)return null;Object.assign(s,p.params),o.push({params:s,pathname:xs([i,p.pathname]),pathnameBase:oA(xs([i,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(i=xs([i,p.pathnameBase]))}return o}function jv(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=tA(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((d,h,p)=>{let{paramName:g,isOptional:v}=h;if(g==="*"){let b=a[p]||"";o=i.slice(0,i.length-b.length).replace(/(.)\/+$/,"$1")}const T=a[p];return v&&!T?d[g]=void 0:d[g]=(T||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function tA(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),eE(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function nA(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return eE(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function sE(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function rA(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?ao(t):t;return{pathname:n?n.startsWith("/")?n:sA(n,e):e,search:aA(r),hash:lA(s)}}function sA(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function kh(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function iA(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function iE(t,e){let n=iA(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function oE(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=ao(t):(s=Pa({},t),$e(!s.pathname||!s.pathname.includes("?"),kh("?","pathname","search",s)),$e(!s.pathname||!s.pathname.includes("#"),kh("#","pathname","hash",s)),$e(!s.search||!s.search.includes("#"),kh("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),p-=1;s.pathname=g.join("/")}a=p>=0?e[p]:"/"}let l=rA(s,a),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(d||h)&&(l.pathname+="/"),l}const xs=t=>t.join("/").replace(/\/\/+/g,"/"),oA=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),aA=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,lA=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function cA(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const aE=["post","put","patch","delete"];new Set(aE);const uA=["get",...aE];new Set(uA);/**
 * React Router v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Da(){return Da=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Da.apply(this,arguments)}const um=C.createContext(null),dA=C.createContext(null),rl=C.createContext(null),Yu=C.createContext(null),Qr=C.createContext({outlet:null,matches:[],isDataRoute:!1}),lE=C.createContext(null);function sl(){return C.useContext(Yu)!=null}function il(){return sl()||$e(!1),C.useContext(Yu).location}function cE(t){C.useContext(rl).static||C.useLayoutEffect(t)}function Vt(){let{isDataRoute:t}=C.useContext(Qr);return t?TA():hA()}function hA(){sl()||$e(!1);let t=C.useContext(um),{basename:e,future:n,navigator:r}=C.useContext(rl),{matches:s}=C.useContext(Qr),{pathname:i}=il(),o=JSON.stringify(iE(s,n.v7_relativeSplatPath)),a=C.useRef(!1);return cE(()=>{a.current=!0}),C.useCallback(function(d,h){if(h===void 0&&(h={}),!a.current)return;if(typeof d=="number"){r.go(d);return}let p=oE(d,JSON.parse(o),i,h.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:xs([e,p.pathname])),(h.replace?r.replace:r.push)(p,h.state,h)},[e,r,o,i,t])}function dm(){let{matches:t}=C.useContext(Qr),e=t[t.length-1];return e?e.params:{}}function fA(t,e){return pA(t,e)}function pA(t,e,n,r){sl()||$e(!1);let{navigator:s}=C.useContext(rl),{matches:i}=C.useContext(Qr),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let d=il(),h;if(e){var p;let E=typeof e=="string"?ao(e):e;l==="/"||(p=E.pathname)!=null&&p.startsWith(l)||$e(!1),h=E}else h=d;let g=h.pathname||"/",v=g;if(l!=="/"){let E=l.replace(/^\//,"").split("/");v="/"+g.replace(/^\//,"").split("/").slice(E.length).join("/")}let T=$b(t,{pathname:v}),b=_A(T&&T.map(E=>Object.assign({},E,{params:Object.assign({},a,E.params),pathname:xs([l,s.encodeLocation?s.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?l:xs([l,s.encodeLocation?s.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),i,n,r);return e&&b?C.createElement(Yu.Provider,{value:{location:Da({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Tr.Pop}},b):b}function mA(){let t=IA(),e=cA(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},e),n?C.createElement("pre",{style:s},n):null,null)}const gA=C.createElement(mA,null);class yA extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?C.createElement(Qr.Provider,{value:this.props.routeContext},C.createElement(lE.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function vA(t){let{routeContext:e,match:n,children:r}=t,s=C.useContext(um);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),C.createElement(Qr.Provider,{value:e},r)}function _A(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let h=o.findIndex(p=>p.route.id&&(a==null?void 0:a[p.route.id])!==void 0);h>=0||$e(!1),o=o.slice(0,Math.min(o.length,h+1))}let l=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let p=o[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=h),p.route.id){let{loaderData:g,errors:v}=n,T=p.route.loader&&g[p.route.id]===void 0&&(!v||v[p.route.id]===void 0);if(p.route.lazy||T){l=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,p,g)=>{let v,T=!1,b=null,E=null;n&&(v=a&&p.route.id?a[p.route.id]:void 0,b=p.route.errorElement||gA,l&&(d<0&&g===0?(T=!0,E=null):d===g&&(T=!0,E=p.route.hydrateFallbackElement||null)));let _=e.concat(o.slice(0,g+1)),y=()=>{let I;return v?I=b:T?I=E:p.route.Component?I=C.createElement(p.route.Component,null):p.route.element?I=p.route.element:I=h,C.createElement(vA,{match:p,routeContext:{outlet:h,matches:_,isDataRoute:n!=null},children:I})};return n&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?C.createElement(yA,{location:n.location,revalidation:n.revalidation,component:b,error:v,children:y(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):y()},null)}var uE=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(uE||{}),ou=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(ou||{});function wA(t){let e=C.useContext(um);return e||$e(!1),e}function xA(t){let e=C.useContext(dA);return e||$e(!1),e}function EA(t){let e=C.useContext(Qr);return e||$e(!1),e}function dE(t){let e=EA(),n=e.matches[e.matches.length-1];return n.route.id||$e(!1),n.route.id}function IA(){var t;let e=C.useContext(lE),n=xA(ou.UseRouteError),r=dE(ou.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function TA(){let{router:t}=wA(uE.UseNavigateStable),e=dE(ou.UseNavigateStable),n=C.useRef(!1);return cE(()=>{n.current=!0}),C.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Da({fromRouteId:e},i)))},[t,e])}const Vv={};function SA(t,e){Vv[e]||(Vv[e]=!0,console.warn(e))}const Ov=(t,e,n)=>SA(t," React Router Future Flag Warning: "+e+". "+("You can use the `"+t+"` future flag to opt-in early. ")+("For more information, see "+n+"."));function kA(t,e){t!=null&&t.v7_startTransition||Ov("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),!(t!=null&&t.v7_relativeSplatPath)&&!e&&Ov("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function bA(t){let{to:e,replace:n,state:r,relative:s}=t;sl()||$e(!1);let{future:i,static:o}=C.useContext(rl),{matches:a}=C.useContext(Qr),{pathname:l}=il(),d=Vt(),h=oE(e,iE(a,i.v7_relativeSplatPath),l,s==="path"),p=JSON.stringify(h);return C.useEffect(()=>d(JSON.parse(p),{replace:n,state:r,relative:s}),[d,p,s,n,r]),null}function Gt(t){$e(!1)}function AA(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Tr.Pop,navigator:i,static:o=!1,future:a}=t;sl()&&$e(!1);let l=e.replace(/^\/*/,"/"),d=C.useMemo(()=>({basename:l,navigator:i,static:o,future:Da({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=ao(r));let{pathname:h="/",search:p="",hash:g="",state:v=null,key:T="default"}=r,b=C.useMemo(()=>{let E=sE(h,l);return E==null?null:{location:{pathname:E,search:p,hash:g,state:v,key:T},navigationType:s}},[l,h,p,g,v,T,s]);return b==null?null:C.createElement(rl.Provider,{value:d},C.createElement(Yu.Provider,{children:n,value:b}))}function RA(t){let{children:e,location:n}=t;return fA(Of(e),n)}new Promise(()=>{});function Of(t,e){e===void 0&&(e=[]);let n=[];return C.Children.forEach(t,(r,s)=>{if(!C.isValidElement(r))return;let i=[...e,s];if(r.type===C.Fragment){n.push.apply(n,Of(r.props.children,i));return}r.type!==Gt&&$e(!1),!r.props.index||!r.props.children||$e(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Of(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const NA="6";try{window.__reactRouterVersion=NA}catch{}const CA="startTransition",Mv=AS[CA];function PA(t){let{basename:e,children:n,future:r,window:s}=t,i=C.useRef();i.current==null&&(i.current=Ub({window:s,v5Compat:!0}));let o=i.current,[a,l]=C.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},h=C.useCallback(p=>{d&&Mv?Mv(()=>l(p)):l(p)},[l,d]);return C.useLayoutEffect(()=>o.listen(h),[o,h]),C.useEffect(()=>kA(r),[r]),C.createElement(AA,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}var Lv;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Lv||(Lv={}));var Fv;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Fv||(Fv={}));/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var DA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jA=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),le=(t,e)=>{const n=C.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:a="",children:l,...d},h)=>C.createElement("svg",{ref:h,...DA,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${jA(t)}`,a].join(" "),...d},[...e.map(([p,g])=>C.createElement(p,g)),...Array.isArray(l)?l:[l]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ol=le("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VA=le("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hm=le("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=le("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const au=le("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fm=le("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OA=le("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oo=le("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=le("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hE=le("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xu=le("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MA=le("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uv=le("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=le("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fE=le("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LA=le("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pE=le("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FA=le("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lu=le("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UA=le("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=le("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zA=le("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mE=le("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cu=le("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pm=le("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BA=le("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gE=le("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $A=le("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qA=le("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yE=le("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KA=le("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qi=le("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=le("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ki=le("UtensilsCrossed",[["path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8",key:"n7qcjb"}],["path",{d:"M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7",key:"d0u48b"}],["path",{d:"m2.1 21.8 6.4-6.3",key:"yn04lh"}],["path",{d:"m19 5-7 7",key:"194lzd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=le("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var zv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vE=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},GA=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},_E={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,d=l?t[s+2]:0,h=i>>2,p=(i&3)<<4|a>>4;let g=(a&15)<<2|d>>6,v=d&63;l||(v=64,o||(g=64)),r.push(n[h],n[p],n[g],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(vE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):GA(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const p=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||d==null||p==null)throw new WA;const g=i<<2|a>>4;if(r.push(g),d!==64){const v=a<<4&240|d>>2;if(r.push(v),p!==64){const T=d<<6&192|p;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class WA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const HA=function(t){const e=vE(t);return _E.encodeByteArray(e,!0)},uu=function(t){return HA(t).replace(/\./g,"")},wE=function(t){try{return _E.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JA=()=>QA().__FIREBASE_DEFAULTS__,YA=()=>{if(typeof process>"u"||typeof zv>"u")return;const t=zv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},XA=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&wE(t[1]);return e&&JSON.parse(e)},Zu=()=>{try{return JA()||YA()||XA()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},xE=t=>{var e,n;return(n=(e=Zu())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},ZA=t=>{const e=xE(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},EE=()=>{var t;return(t=Zu())===null||t===void 0?void 0:t.config},IE=t=>{var e;return(e=Zu())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tR(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[uu(JSON.stringify(n)),uu(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function We(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function nR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(We())}function rR(){var t;const e=(t=Zu())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function sR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function iR(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function oR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function aR(){const t=We();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function TE(){return!rR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function SE(){try{return typeof indexedDB=="object"}catch{return!1}}function lR(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cR="FirebaseError";class Rn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=cR,Object.setPrototypeOf(this,Rn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,al.prototype.create)}}class al{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?uR(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Rn(s,a,r)}}function uR(t,e){return t.replace(dR,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const dR=/\{\$([^}]+)}/g;function hR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ns(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Bv(i)&&Bv(o)){if(!Ns(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Bv(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ll(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Go(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Wo(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function fR(t,e){const n=new pR(t,e);return n.subscribe.bind(n)}class pR{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");mR(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=bh),s.error===void 0&&(s.error=bh),s.complete===void 0&&(s.complete=bh);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function mR(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function bh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pe(t){return t&&t._delegate?t._delegate:t}class zr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const us="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new eR;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(vR(e))try{this.getOrInitializeService({instanceIdentifier:us})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=us){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=us){return this.instances.has(e)}getOptions(e=us){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:yR(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=us){return this.component?this.component.multipleInstances?e:us:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function yR(t){return t===us?void 0:t}function vR(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new gR(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(oe||(oe={}));const wR={debug:oe.DEBUG,verbose:oe.VERBOSE,info:oe.INFO,warn:oe.WARN,error:oe.ERROR,silent:oe.SILENT},xR=oe.INFO,ER={[oe.DEBUG]:"log",[oe.VERBOSE]:"log",[oe.INFO]:"info",[oe.WARN]:"warn",[oe.ERROR]:"error"},IR=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=ER[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class mm{constructor(e){this.name=e,this._logLevel=xR,this._logHandler=IR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in oe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?wR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,oe.DEBUG,...e),this._logHandler(this,oe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,oe.VERBOSE,...e),this._logHandler(this,oe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,oe.INFO,...e),this._logHandler(this,oe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,oe.WARN,...e),this._logHandler(this,oe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,oe.ERROR,...e),this._logHandler(this,oe.ERROR,...e)}}const TR=(t,e)=>e.some(n=>t instanceof n);let $v,qv;function SR(){return $v||($v=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function kR(){return qv||(qv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const kE=new WeakMap,Mf=new WeakMap,bE=new WeakMap,Ah=new WeakMap,gm=new WeakMap;function bR(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(jr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&kE.set(n,t)}).catch(()=>{}),gm.set(e,t),e}function AR(t){if(Mf.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Mf.set(t,e)}let Lf={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Mf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||bE.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return jr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function RR(t){Lf=t(Lf)}function NR(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Rh(this),e,...n);return bE.set(r,e.sort?e.sort():[e]),jr(r)}:kR().includes(t)?function(...e){return t.apply(Rh(this),e),jr(kE.get(this))}:function(...e){return jr(t.apply(Rh(this),e))}}function CR(t){return typeof t=="function"?NR(t):(t instanceof IDBTransaction&&AR(t),TR(t,SR())?new Proxy(t,Lf):t)}function jr(t){if(t instanceof IDBRequest)return bR(t);if(Ah.has(t))return Ah.get(t);const e=CR(t);return e!==t&&(Ah.set(t,e),gm.set(e,t)),e}const Rh=t=>gm.get(t);function PR(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=jr(o);return r&&o.addEventListener("upgradeneeded",l=>{r(jr(o.result),l.oldVersion,l.newVersion,jr(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const DR=["get","getKey","getAll","getAllKeys","count"],jR=["put","add","delete","clear"],Nh=new Map;function Kv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Nh.get(e))return Nh.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=jR.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||DR.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let d=l.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),s&&l.done]))[0]};return Nh.set(e,i),i}RR(t=>({...t,get:(e,n,r)=>Kv(e,n)||t.get(e,n,r),has:(e,n)=>!!Kv(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(OR(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function OR(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ff="@firebase/app",Gv="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yn=new mm("@firebase/app"),MR="@firebase/app-compat",LR="@firebase/analytics-compat",FR="@firebase/analytics",UR="@firebase/app-check-compat",zR="@firebase/app-check",BR="@firebase/auth",$R="@firebase/auth-compat",qR="@firebase/database",KR="@firebase/data-connect",GR="@firebase/database-compat",WR="@firebase/functions",HR="@firebase/functions-compat",QR="@firebase/installations",JR="@firebase/installations-compat",YR="@firebase/messaging",XR="@firebase/messaging-compat",ZR="@firebase/performance",eN="@firebase/performance-compat",tN="@firebase/remote-config",nN="@firebase/remote-config-compat",rN="@firebase/storage",sN="@firebase/storage-compat",iN="@firebase/firestore",oN="@firebase/vertexai-preview",aN="@firebase/firestore-compat",lN="firebase",cN="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uf="[DEFAULT]",uN={[Ff]:"fire-core",[MR]:"fire-core-compat",[FR]:"fire-analytics",[LR]:"fire-analytics-compat",[zR]:"fire-app-check",[UR]:"fire-app-check-compat",[BR]:"fire-auth",[$R]:"fire-auth-compat",[qR]:"fire-rtdb",[KR]:"fire-data-connect",[GR]:"fire-rtdb-compat",[WR]:"fire-fn",[HR]:"fire-fn-compat",[QR]:"fire-iid",[JR]:"fire-iid-compat",[YR]:"fire-fcm",[XR]:"fire-fcm-compat",[ZR]:"fire-perf",[eN]:"fire-perf-compat",[tN]:"fire-rc",[nN]:"fire-rc-compat",[rN]:"fire-gcs",[sN]:"fire-gcs-compat",[iN]:"fire-fst",[aN]:"fire-fst-compat",[oN]:"fire-vertex","fire-js":"fire-js",[lN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const du=new Map,dN=new Map,zf=new Map;function Wv(t,e){try{t.container.addComponent(e)}catch(n){Yn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Cs(t){const e=t.name;if(zf.has(e))return Yn.debug(`There were multiple attempts to register component ${e}.`),!1;zf.set(e,t);for(const n of du.values())Wv(n,t);for(const n of dN.values())Wv(n,t);return!0}function ed(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function yn(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Vr=new al("app","Firebase",hN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new zr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Vr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ws=cN;function AE(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Uf,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Vr.create("bad-app-name",{appName:String(s)});if(n||(n=EE()),!n)throw Vr.create("no-options");const i=du.get(s);if(i){if(Ns(n,i.options)&&Ns(r,i.config))return i;throw Vr.create("duplicate-app",{appName:s})}const o=new _R(s);for(const l of zf.values())o.addComponent(l);const a=new fN(n,r,o);return du.set(s,a),a}function RE(t=Uf){const e=du.get(t);if(!e&&t===Uf&&EE())return AE();if(!e)throw Vr.create("no-app",{appName:t});return e}function En(t,e,n){var r;let s=(r=uN[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Yn.warn(a.join(" "));return}Cs(new zr(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pN="firebase-heartbeat-database",mN=1,Oa="firebase-heartbeat-store";let Ch=null;function NE(){return Ch||(Ch=PR(pN,mN,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Oa)}catch(n){console.warn(n)}}}}).catch(t=>{throw Vr.create("idb-open",{originalErrorMessage:t.message})})),Ch}async function gN(t){try{const n=(await NE()).transaction(Oa),r=await n.objectStore(Oa).get(CE(t));return await n.done,r}catch(e){if(e instanceof Rn)Yn.warn(e.message);else{const n=Vr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Yn.warn(n.message)}}}async function Hv(t,e){try{const r=(await NE()).transaction(Oa,"readwrite");await r.objectStore(Oa).put(e,CE(t)),await r.done}catch(n){if(n instanceof Rn)Yn.warn(n.message);else{const r=Vr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Yn.warn(r.message)}}}function CE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yN=1024,vN=30*24*60*60*1e3;class _N{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new xN(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Qv();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=vN}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Yn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Qv(),{heartbeatsToSend:r,unsentEntries:s}=wN(this._heartbeatsCache.heartbeats),i=uu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Yn.warn(n),""}}}function Qv(){return new Date().toISOString().substring(0,10)}function wN(t,e=yN){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Jv(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Jv(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class xN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return SE()?lR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await gN(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Hv(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Hv(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Jv(t){return uu(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EN(t){Cs(new zr("platform-logger",e=>new VR(e),"PRIVATE")),Cs(new zr("heartbeat",e=>new _N(e),"PRIVATE")),En(Ff,Gv,t),En(Ff,Gv,"esm2017"),En("fire-js","")}EN("");var Yv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Is,PE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,x){function k(){}k.prototype=x.prototype,S.D=x.prototype,S.prototype=new k,S.prototype.constructor=S,S.C=function(R,N,D){for(var A=Array(arguments.length-2),rt=2;rt<arguments.length;rt++)A[rt-2]=arguments[rt];return x.prototype[N].apply(R,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,x,k){k||(k=0);var R=Array(16);if(typeof x=="string")for(var N=0;16>N;++N)R[N]=x.charCodeAt(k++)|x.charCodeAt(k++)<<8|x.charCodeAt(k++)<<16|x.charCodeAt(k++)<<24;else for(N=0;16>N;++N)R[N]=x[k++]|x[k++]<<8|x[k++]<<16|x[k++]<<24;x=S.g[0],k=S.g[1],N=S.g[2];var D=S.g[3],A=x+(D^k&(N^D))+R[0]+3614090360&4294967295;x=k+(A<<7&4294967295|A>>>25),A=D+(N^x&(k^N))+R[1]+3905402710&4294967295,D=x+(A<<12&4294967295|A>>>20),A=N+(k^D&(x^k))+R[2]+606105819&4294967295,N=D+(A<<17&4294967295|A>>>15),A=k+(x^N&(D^x))+R[3]+3250441966&4294967295,k=N+(A<<22&4294967295|A>>>10),A=x+(D^k&(N^D))+R[4]+4118548399&4294967295,x=k+(A<<7&4294967295|A>>>25),A=D+(N^x&(k^N))+R[5]+1200080426&4294967295,D=x+(A<<12&4294967295|A>>>20),A=N+(k^D&(x^k))+R[6]+2821735955&4294967295,N=D+(A<<17&4294967295|A>>>15),A=k+(x^N&(D^x))+R[7]+4249261313&4294967295,k=N+(A<<22&4294967295|A>>>10),A=x+(D^k&(N^D))+R[8]+1770035416&4294967295,x=k+(A<<7&4294967295|A>>>25),A=D+(N^x&(k^N))+R[9]+2336552879&4294967295,D=x+(A<<12&4294967295|A>>>20),A=N+(k^D&(x^k))+R[10]+4294925233&4294967295,N=D+(A<<17&4294967295|A>>>15),A=k+(x^N&(D^x))+R[11]+2304563134&4294967295,k=N+(A<<22&4294967295|A>>>10),A=x+(D^k&(N^D))+R[12]+1804603682&4294967295,x=k+(A<<7&4294967295|A>>>25),A=D+(N^x&(k^N))+R[13]+4254626195&4294967295,D=x+(A<<12&4294967295|A>>>20),A=N+(k^D&(x^k))+R[14]+2792965006&4294967295,N=D+(A<<17&4294967295|A>>>15),A=k+(x^N&(D^x))+R[15]+1236535329&4294967295,k=N+(A<<22&4294967295|A>>>10),A=x+(N^D&(k^N))+R[1]+4129170786&4294967295,x=k+(A<<5&4294967295|A>>>27),A=D+(k^N&(x^k))+R[6]+3225465664&4294967295,D=x+(A<<9&4294967295|A>>>23),A=N+(x^k&(D^x))+R[11]+643717713&4294967295,N=D+(A<<14&4294967295|A>>>18),A=k+(D^x&(N^D))+R[0]+3921069994&4294967295,k=N+(A<<20&4294967295|A>>>12),A=x+(N^D&(k^N))+R[5]+3593408605&4294967295,x=k+(A<<5&4294967295|A>>>27),A=D+(k^N&(x^k))+R[10]+38016083&4294967295,D=x+(A<<9&4294967295|A>>>23),A=N+(x^k&(D^x))+R[15]+3634488961&4294967295,N=D+(A<<14&4294967295|A>>>18),A=k+(D^x&(N^D))+R[4]+3889429448&4294967295,k=N+(A<<20&4294967295|A>>>12),A=x+(N^D&(k^N))+R[9]+568446438&4294967295,x=k+(A<<5&4294967295|A>>>27),A=D+(k^N&(x^k))+R[14]+3275163606&4294967295,D=x+(A<<9&4294967295|A>>>23),A=N+(x^k&(D^x))+R[3]+4107603335&4294967295,N=D+(A<<14&4294967295|A>>>18),A=k+(D^x&(N^D))+R[8]+1163531501&4294967295,k=N+(A<<20&4294967295|A>>>12),A=x+(N^D&(k^N))+R[13]+2850285829&4294967295,x=k+(A<<5&4294967295|A>>>27),A=D+(k^N&(x^k))+R[2]+4243563512&4294967295,D=x+(A<<9&4294967295|A>>>23),A=N+(x^k&(D^x))+R[7]+1735328473&4294967295,N=D+(A<<14&4294967295|A>>>18),A=k+(D^x&(N^D))+R[12]+2368359562&4294967295,k=N+(A<<20&4294967295|A>>>12),A=x+(k^N^D)+R[5]+4294588738&4294967295,x=k+(A<<4&4294967295|A>>>28),A=D+(x^k^N)+R[8]+2272392833&4294967295,D=x+(A<<11&4294967295|A>>>21),A=N+(D^x^k)+R[11]+1839030562&4294967295,N=D+(A<<16&4294967295|A>>>16),A=k+(N^D^x)+R[14]+4259657740&4294967295,k=N+(A<<23&4294967295|A>>>9),A=x+(k^N^D)+R[1]+2763975236&4294967295,x=k+(A<<4&4294967295|A>>>28),A=D+(x^k^N)+R[4]+1272893353&4294967295,D=x+(A<<11&4294967295|A>>>21),A=N+(D^x^k)+R[7]+4139469664&4294967295,N=D+(A<<16&4294967295|A>>>16),A=k+(N^D^x)+R[10]+3200236656&4294967295,k=N+(A<<23&4294967295|A>>>9),A=x+(k^N^D)+R[13]+681279174&4294967295,x=k+(A<<4&4294967295|A>>>28),A=D+(x^k^N)+R[0]+3936430074&4294967295,D=x+(A<<11&4294967295|A>>>21),A=N+(D^x^k)+R[3]+3572445317&4294967295,N=D+(A<<16&4294967295|A>>>16),A=k+(N^D^x)+R[6]+76029189&4294967295,k=N+(A<<23&4294967295|A>>>9),A=x+(k^N^D)+R[9]+3654602809&4294967295,x=k+(A<<4&4294967295|A>>>28),A=D+(x^k^N)+R[12]+3873151461&4294967295,D=x+(A<<11&4294967295|A>>>21),A=N+(D^x^k)+R[15]+530742520&4294967295,N=D+(A<<16&4294967295|A>>>16),A=k+(N^D^x)+R[2]+3299628645&4294967295,k=N+(A<<23&4294967295|A>>>9),A=x+(N^(k|~D))+R[0]+4096336452&4294967295,x=k+(A<<6&4294967295|A>>>26),A=D+(k^(x|~N))+R[7]+1126891415&4294967295,D=x+(A<<10&4294967295|A>>>22),A=N+(x^(D|~k))+R[14]+2878612391&4294967295,N=D+(A<<15&4294967295|A>>>17),A=k+(D^(N|~x))+R[5]+4237533241&4294967295,k=N+(A<<21&4294967295|A>>>11),A=x+(N^(k|~D))+R[12]+1700485571&4294967295,x=k+(A<<6&4294967295|A>>>26),A=D+(k^(x|~N))+R[3]+2399980690&4294967295,D=x+(A<<10&4294967295|A>>>22),A=N+(x^(D|~k))+R[10]+4293915773&4294967295,N=D+(A<<15&4294967295|A>>>17),A=k+(D^(N|~x))+R[1]+2240044497&4294967295,k=N+(A<<21&4294967295|A>>>11),A=x+(N^(k|~D))+R[8]+1873313359&4294967295,x=k+(A<<6&4294967295|A>>>26),A=D+(k^(x|~N))+R[15]+4264355552&4294967295,D=x+(A<<10&4294967295|A>>>22),A=N+(x^(D|~k))+R[6]+2734768916&4294967295,N=D+(A<<15&4294967295|A>>>17),A=k+(D^(N|~x))+R[13]+1309151649&4294967295,k=N+(A<<21&4294967295|A>>>11),A=x+(N^(k|~D))+R[4]+4149444226&4294967295,x=k+(A<<6&4294967295|A>>>26),A=D+(k^(x|~N))+R[11]+3174756917&4294967295,D=x+(A<<10&4294967295|A>>>22),A=N+(x^(D|~k))+R[2]+718787259&4294967295,N=D+(A<<15&4294967295|A>>>17),A=k+(D^(N|~x))+R[9]+3951481745&4294967295,S.g[0]=S.g[0]+x&4294967295,S.g[1]=S.g[1]+(N+(A<<21&4294967295|A>>>11))&4294967295,S.g[2]=S.g[2]+N&4294967295,S.g[3]=S.g[3]+D&4294967295}r.prototype.u=function(S,x){x===void 0&&(x=S.length);for(var k=x-this.blockSize,R=this.B,N=this.h,D=0;D<x;){if(N==0)for(;D<=k;)s(this,S,D),D+=this.blockSize;if(typeof S=="string"){for(;D<x;)if(R[N++]=S.charCodeAt(D++),N==this.blockSize){s(this,R),N=0;break}}else for(;D<x;)if(R[N++]=S[D++],N==this.blockSize){s(this,R),N=0;break}}this.h=N,this.o+=x},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var x=1;x<S.length-8;++x)S[x]=0;var k=8*this.o;for(x=S.length-8;x<S.length;++x)S[x]=k&255,k/=256;for(this.u(S),S=Array(16),x=k=0;4>x;++x)for(var R=0;32>R;R+=8)S[k++]=this.g[x]>>>R&255;return S};function i(S,x){var k=a;return Object.prototype.hasOwnProperty.call(k,S)?k[S]:k[S]=x(S)}function o(S,x){this.h=x;for(var k=[],R=!0,N=S.length-1;0<=N;N--){var D=S[N]|0;R&&D==x||(k[N]=D,R=!1)}this.g=k}var a={};function l(S){return-128<=S&&128>S?i(S,function(x){return new o([x|0],0>x?-1:0)}):new o([S|0],0>S?-1:0)}function d(S){if(isNaN(S)||!isFinite(S))return p;if(0>S)return E(d(-S));for(var x=[],k=1,R=0;S>=k;R++)x[R]=S/k|0,k*=4294967296;return new o(x,0)}function h(S,x){if(S.length==0)throw Error("number format error: empty string");if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(S.charAt(0)=="-")return E(h(S.substring(1),x));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=d(Math.pow(x,8)),R=p,N=0;N<S.length;N+=8){var D=Math.min(8,S.length-N),A=parseInt(S.substring(N,N+D),x);8>D?(D=d(Math.pow(x,D)),R=R.j(D).add(d(A))):(R=R.j(k),R=R.add(d(A)))}return R}var p=l(0),g=l(1),v=l(16777216);t=o.prototype,t.m=function(){if(b(this))return-E(this).m();for(var S=0,x=1,k=0;k<this.g.length;k++){var R=this.i(k);S+=(0<=R?R:4294967296+R)*x,x*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(T(this))return"0";if(b(this))return"-"+E(this).toString(S);for(var x=d(Math.pow(S,6)),k=this,R="";;){var N=P(k,x).g;k=_(k,N.j(x));var D=((0<k.g.length?k.g[0]:k.h)>>>0).toString(S);if(k=N,T(k))return D+R;for(;6>D.length;)D="0"+D;R=D+R}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function T(S){if(S.h!=0)return!1;for(var x=0;x<S.g.length;x++)if(S.g[x]!=0)return!1;return!0}function b(S){return S.h==-1}t.l=function(S){return S=_(this,S),b(S)?-1:T(S)?0:1};function E(S){for(var x=S.g.length,k=[],R=0;R<x;R++)k[R]=~S.g[R];return new o(k,~S.h).add(g)}t.abs=function(){return b(this)?E(this):this},t.add=function(S){for(var x=Math.max(this.g.length,S.g.length),k=[],R=0,N=0;N<=x;N++){var D=R+(this.i(N)&65535)+(S.i(N)&65535),A=(D>>>16)+(this.i(N)>>>16)+(S.i(N)>>>16);R=A>>>16,D&=65535,A&=65535,k[N]=A<<16|D}return new o(k,k[k.length-1]&-2147483648?-1:0)};function _(S,x){return S.add(E(x))}t.j=function(S){if(T(this)||T(S))return p;if(b(this))return b(S)?E(this).j(E(S)):E(E(this).j(S));if(b(S))return E(this.j(E(S)));if(0>this.l(v)&&0>S.l(v))return d(this.m()*S.m());for(var x=this.g.length+S.g.length,k=[],R=0;R<2*x;R++)k[R]=0;for(R=0;R<this.g.length;R++)for(var N=0;N<S.g.length;N++){var D=this.i(R)>>>16,A=this.i(R)&65535,rt=S.i(N)>>>16,Zt=S.i(N)&65535;k[2*R+2*N]+=A*Zt,y(k,2*R+2*N),k[2*R+2*N+1]+=D*Zt,y(k,2*R+2*N+1),k[2*R+2*N+1]+=A*rt,y(k,2*R+2*N+1),k[2*R+2*N+2]+=D*rt,y(k,2*R+2*N+2)}for(R=0;R<x;R++)k[R]=k[2*R+1]<<16|k[2*R];for(R=x;R<2*x;R++)k[R]=0;return new o(k,0)};function y(S,x){for(;(S[x]&65535)!=S[x];)S[x+1]+=S[x]>>>16,S[x]&=65535,x++}function I(S,x){this.g=S,this.h=x}function P(S,x){if(T(x))throw Error("division by zero");if(T(S))return new I(p,p);if(b(S))return x=P(E(S),x),new I(E(x.g),E(x.h));if(b(x))return x=P(S,E(x)),new I(E(x.g),x.h);if(30<S.g.length){if(b(S)||b(x))throw Error("slowDivide_ only works with positive integers.");for(var k=g,R=x;0>=R.l(S);)k=O(k),R=O(R);var N=L(k,1),D=L(R,1);for(R=L(R,2),k=L(k,2);!T(R);){var A=D.add(R);0>=A.l(S)&&(N=N.add(k),D=A),R=L(R,1),k=L(k,1)}return x=_(S,N.j(x)),new I(N,x)}for(N=p;0<=S.l(x);){for(k=Math.max(1,Math.floor(S.m()/x.m())),R=Math.ceil(Math.log(k)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),D=d(k),A=D.j(x);b(A)||0<A.l(S);)k-=R,D=d(k),A=D.j(x);T(D)&&(D=g),N=N.add(D),S=_(S,A)}return new I(N,S)}t.A=function(S){return P(this,S).h},t.and=function(S){for(var x=Math.max(this.g.length,S.g.length),k=[],R=0;R<x;R++)k[R]=this.i(R)&S.i(R);return new o(k,this.h&S.h)},t.or=function(S){for(var x=Math.max(this.g.length,S.g.length),k=[],R=0;R<x;R++)k[R]=this.i(R)|S.i(R);return new o(k,this.h|S.h)},t.xor=function(S){for(var x=Math.max(this.g.length,S.g.length),k=[],R=0;R<x;R++)k[R]=this.i(R)^S.i(R);return new o(k,this.h^S.h)};function O(S){for(var x=S.g.length+1,k=[],R=0;R<x;R++)k[R]=S.i(R)<<1|S.i(R-1)>>>31;return new o(k,S.h)}function L(S,x){var k=x>>5;x%=32;for(var R=S.g.length-k,N=[],D=0;D<R;D++)N[D]=0<x?S.i(D+k)>>>x|S.i(D+k+1)<<32-x:S.i(D+k);return new o(N,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,PE=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Is=o}).apply(typeof Yv<"u"?Yv:typeof self<"u"?self:typeof window<"u"?window:{});var nc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var DE,Ho,jE,Ec,Bf,VE,OE,ME;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,f,m){return c==Array.prototype||c==Object.prototype||(c[f]=m.value),c};function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof nc=="object"&&nc];for(var f=0;f<c.length;++f){var m=c[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=n(this);function s(c,f){if(f)e:{var m=r;c=c.split(".");for(var w=0;w<c.length-1;w++){var j=c[w];if(!(j in m))break e;m=m[j]}c=c[c.length-1],w=m[c],f=f(w),f!=w&&f!=null&&e(m,c,{configurable:!0,writable:!0,value:f})}}function i(c,f){c instanceof String&&(c+="");var m=0,w=!1,j={next:function(){if(!w&&m<c.length){var M=m++;return{value:f(M,c[M]),done:!1}}return w=!0,{done:!0,value:void 0}}};return j[Symbol.iterator]=function(){return j},j}s("Array.prototype.values",function(c){return c||function(){return i(this,function(f,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(c){var f=typeof c;return f=f!="object"?f:c?Array.isArray(c)?"array":f:"null",f=="array"||f=="object"&&typeof c.length=="number"}function d(c){var f=typeof c;return f=="object"&&c!=null||f=="function"}function h(c,f,m){return c.call.apply(c.bind,arguments)}function p(c,f,m){if(!c)throw Error();if(2<arguments.length){var w=Array.prototype.slice.call(arguments,2);return function(){var j=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(j,w),c.apply(f,j)}}return function(){return c.apply(f,arguments)}}function g(c,f,m){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,g.apply(null,arguments)}function v(c,f){var m=Array.prototype.slice.call(arguments,1);return function(){var w=m.slice();return w.push.apply(w,arguments),c.apply(this,w)}}function T(c,f){function m(){}m.prototype=f.prototype,c.aa=f.prototype,c.prototype=new m,c.prototype.constructor=c,c.Qb=function(w,j,M){for(var q=Array(arguments.length-2),ve=2;ve<arguments.length;ve++)q[ve-2]=arguments[ve];return f.prototype[j].apply(w,q)}}function b(c){const f=c.length;if(0<f){const m=Array(f);for(let w=0;w<f;w++)m[w]=c[w];return m}return[]}function E(c,f){for(let m=1;m<arguments.length;m++){const w=arguments[m];if(l(w)){const j=c.length||0,M=w.length||0;c.length=j+M;for(let q=0;q<M;q++)c[j+q]=w[q]}else c.push(w)}}class _{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function y(c){return/^[\s\xa0]*$/.test(c)}function I(){var c=a.navigator;return c&&(c=c.userAgent)?c:""}function P(c){return P[" "](c),c}P[" "]=function(){};var O=I().indexOf("Gecko")!=-1&&!(I().toLowerCase().indexOf("webkit")!=-1&&I().indexOf("Edge")==-1)&&!(I().indexOf("Trident")!=-1||I().indexOf("MSIE")!=-1)&&I().indexOf("Edge")==-1;function L(c,f,m){for(const w in c)f.call(m,c[w],w,c)}function S(c,f){for(const m in c)f.call(void 0,c[m],m,c)}function x(c){const f={};for(const m in c)f[m]=c[m];return f}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(c,f){let m,w;for(let j=1;j<arguments.length;j++){w=arguments[j];for(m in w)c[m]=w[m];for(let M=0;M<k.length;M++)m=k[M],Object.prototype.hasOwnProperty.call(w,m)&&(c[m]=w[m])}}function N(c){var f=1;c=c.split(":");const m=[];for(;0<f&&c.length;)m.push(c.shift()),f--;return c.length&&m.push(c.join(":")),m}function D(c){a.setTimeout(()=>{throw c},0)}function A(){var c=K;let f=null;return c.g&&(f=c.g,c.g=c.g.next,c.g||(c.h=null),f.next=null),f}class rt{constructor(){this.h=this.g=null}add(f,m){const w=Zt.get();w.set(f,m),this.h?this.h.next=w:this.g=w,this.h=w}}var Zt=new _(()=>new ee,c=>c.reset());class ee{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let ue,F=!1,K=new rt,J=()=>{const c=a.Promise.resolve(void 0);ue=()=>{c.then(ne)}};var ne=()=>{for(var c;c=A();){try{c.h.call(c.g)}catch(m){D(m)}var f=Zt;f.j(c),100>f.h&&(f.h++,c.next=f.g,f.g=c)}F=!1};function ye(){this.s=this.s,this.C=this.C}ye.prototype.s=!1,ye.prototype.ma=function(){this.s||(this.s=!0,this.N())},ye.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Oe(c,f){this.type=c,this.g=this.target=f,this.defaultPrevented=!1}Oe.prototype.h=function(){this.defaultPrevented=!0};var Cn=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,f=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const m=()=>{};a.addEventListener("test",m,f),a.removeEventListener("test",m,f)}catch{}return c}();function Pn(c,f){if(Oe.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var m=this.type=c.type,w=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=f,f=c.relatedTarget){if(O){e:{try{P(f.nodeName);var j=!0;break e}catch{}j=!1}j||(f=null)}}else m=="mouseover"?f=c.fromElement:m=="mouseout"&&(f=c.toElement);this.relatedTarget=f,w?(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:Dn[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&Pn.aa.h.call(this)}}T(Pn,Oe);var Dn={2:"touch",3:"pen",4:"mouse"};Pn.prototype.h=function(){Pn.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var jn="closure_listenable_"+(1e6*Math.random()|0),j1=0;function V1(c,f,m,w,j){this.listener=c,this.proxy=null,this.src=f,this.type=m,this.capture=!!w,this.ha=j,this.key=++j1,this.da=this.fa=!1}function xl(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function El(c){this.src=c,this.g={},this.h=0}El.prototype.add=function(c,f,m,w,j){var M=c.toString();c=this.g[M],c||(c=this.g[M]=[],this.h++);var q=Pd(c,f,w,j);return-1<q?(f=c[q],m||(f.fa=!1)):(f=new V1(f,this.src,M,!!w,j),f.fa=m,c.push(f)),f};function Cd(c,f){var m=f.type;if(m in c.g){var w=c.g[m],j=Array.prototype.indexOf.call(w,f,void 0),M;(M=0<=j)&&Array.prototype.splice.call(w,j,1),M&&(xl(f),c.g[m].length==0&&(delete c.g[m],c.h--))}}function Pd(c,f,m,w){for(var j=0;j<c.length;++j){var M=c[j];if(!M.da&&M.listener==f&&M.capture==!!m&&M.ha==w)return j}return-1}var Dd="closure_lm_"+(1e6*Math.random()|0),jd={};function Eg(c,f,m,w,j){if(Array.isArray(f)){for(var M=0;M<f.length;M++)Eg(c,f[M],m,w,j);return null}return m=Sg(m),c&&c[jn]?c.K(f,m,d(w)?!!w.capture:!!w,j):O1(c,f,m,!1,w,j)}function O1(c,f,m,w,j,M){if(!f)throw Error("Invalid event type");var q=d(j)?!!j.capture:!!j,ve=Od(c);if(ve||(c[Dd]=ve=new El(c)),m=ve.add(f,m,w,q,M),m.proxy)return m;if(w=M1(),m.proxy=w,w.src=c,w.listener=m,c.addEventListener)Cn||(j=q),j===void 0&&(j=!1),c.addEventListener(f.toString(),w,j);else if(c.attachEvent)c.attachEvent(Tg(f.toString()),w);else if(c.addListener&&c.removeListener)c.addListener(w);else throw Error("addEventListener and attachEvent are unavailable.");return m}function M1(){function c(m){return f.call(c.src,c.listener,m)}const f=L1;return c}function Ig(c,f,m,w,j){if(Array.isArray(f))for(var M=0;M<f.length;M++)Ig(c,f[M],m,w,j);else w=d(w)?!!w.capture:!!w,m=Sg(m),c&&c[jn]?(c=c.i,f=String(f).toString(),f in c.g&&(M=c.g[f],m=Pd(M,m,w,j),-1<m&&(xl(M[m]),Array.prototype.splice.call(M,m,1),M.length==0&&(delete c.g[f],c.h--)))):c&&(c=Od(c))&&(f=c.g[f.toString()],c=-1,f&&(c=Pd(f,m,w,j)),(m=-1<c?f[c]:null)&&Vd(m))}function Vd(c){if(typeof c!="number"&&c&&!c.da){var f=c.src;if(f&&f[jn])Cd(f.i,c);else{var m=c.type,w=c.proxy;f.removeEventListener?f.removeEventListener(m,w,c.capture):f.detachEvent?f.detachEvent(Tg(m),w):f.addListener&&f.removeListener&&f.removeListener(w),(m=Od(f))?(Cd(m,c),m.h==0&&(m.src=null,f[Dd]=null)):xl(c)}}}function Tg(c){return c in jd?jd[c]:jd[c]="on"+c}function L1(c,f){if(c.da)c=!0;else{f=new Pn(f,this);var m=c.listener,w=c.ha||c.src;c.fa&&Vd(c),c=m.call(w,f)}return c}function Od(c){return c=c[Dd],c instanceof El?c:null}var Md="__closure_events_fn_"+(1e9*Math.random()>>>0);function Sg(c){return typeof c=="function"?c:(c[Md]||(c[Md]=function(f){return c.handleEvent(f)}),c[Md])}function st(){ye.call(this),this.i=new El(this),this.M=this,this.F=null}T(st,ye),st.prototype[jn]=!0,st.prototype.removeEventListener=function(c,f,m,w){Ig(this,c,f,m,w)};function gt(c,f){var m,w=c.F;if(w)for(m=[];w;w=w.F)m.push(w);if(c=c.M,w=f.type||f,typeof f=="string")f=new Oe(f,c);else if(f instanceof Oe)f.target=f.target||c;else{var j=f;f=new Oe(w,c),R(f,j)}if(j=!0,m)for(var M=m.length-1;0<=M;M--){var q=f.g=m[M];j=Il(q,w,!0,f)&&j}if(q=f.g=c,j=Il(q,w,!0,f)&&j,j=Il(q,w,!1,f)&&j,m)for(M=0;M<m.length;M++)q=f.g=m[M],j=Il(q,w,!1,f)&&j}st.prototype.N=function(){if(st.aa.N.call(this),this.i){var c=this.i,f;for(f in c.g){for(var m=c.g[f],w=0;w<m.length;w++)xl(m[w]);delete c.g[f],c.h--}}this.F=null},st.prototype.K=function(c,f,m,w){return this.i.add(String(c),f,!1,m,w)},st.prototype.L=function(c,f,m,w){return this.i.add(String(c),f,!0,m,w)};function Il(c,f,m,w){if(f=c.i.g[String(f)],!f)return!0;f=f.concat();for(var j=!0,M=0;M<f.length;++M){var q=f[M];if(q&&!q.da&&q.capture==m){var ve=q.listener,Xe=q.ha||q.src;q.fa&&Cd(c.i,q),j=ve.call(Xe,w)!==!1&&j}}return j&&!w.defaultPrevented}function kg(c,f,m){if(typeof c=="function")m&&(c=g(c,m));else if(c&&typeof c.handleEvent=="function")c=g(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(c,f||0)}function bg(c){c.g=kg(()=>{c.g=null,c.i&&(c.i=!1,bg(c))},c.l);const f=c.h;c.h=null,c.m.apply(null,f)}class F1 extends ye{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:bg(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function mo(c){ye.call(this),this.h=c,this.g={}}T(mo,ye);var Ag=[];function Rg(c){L(c.g,function(f,m){this.g.hasOwnProperty(m)&&Vd(f)},c),c.g={}}mo.prototype.N=function(){mo.aa.N.call(this),Rg(this)},mo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ld=a.JSON.stringify,U1=a.JSON.parse,z1=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function Fd(){}Fd.prototype.h=null;function Ng(c){return c.h||(c.h=c.i())}function Cg(){}var go={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ud(){Oe.call(this,"d")}T(Ud,Oe);function zd(){Oe.call(this,"c")}T(zd,Oe);var rs={},Pg=null;function Tl(){return Pg=Pg||new st}rs.La="serverreachability";function Dg(c){Oe.call(this,rs.La,c)}T(Dg,Oe);function yo(c){const f=Tl();gt(f,new Dg(f))}rs.STAT_EVENT="statevent";function jg(c,f){Oe.call(this,rs.STAT_EVENT,c),this.stat=f}T(jg,Oe);function yt(c){const f=Tl();gt(f,new jg(f,c))}rs.Ma="timingevent";function Vg(c,f){Oe.call(this,rs.Ma,c),this.size=f}T(Vg,Oe);function vo(c,f){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},f)}function _o(){this.g=!0}_o.prototype.xa=function(){this.g=!1};function B1(c,f,m,w,j,M){c.info(function(){if(c.g)if(M)for(var q="",ve=M.split("&"),Xe=0;Xe<ve.length;Xe++){var he=ve[Xe].split("=");if(1<he.length){var it=he[0];he=he[1];var ot=it.split("_");q=2<=ot.length&&ot[1]=="type"?q+(it+"="+he+"&"):q+(it+"=redacted&")}}else q=null;else q=M;return"XMLHTTP REQ ("+w+") [attempt "+j+"]: "+f+`
`+m+`
`+q})}function $1(c,f,m,w,j,M,q){c.info(function(){return"XMLHTTP RESP ("+w+") [ attempt "+j+"]: "+f+`
`+m+`
`+M+" "+q})}function Zs(c,f,m,w){c.info(function(){return"XMLHTTP TEXT ("+f+"): "+K1(c,m)+(w?" "+w:"")})}function q1(c,f){c.info(function(){return"TIMEOUT: "+f})}_o.prototype.info=function(){};function K1(c,f){if(!c.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(c=0;c<m.length;c++)if(Array.isArray(m[c])){var w=m[c];if(!(2>w.length)){var j=w[1];if(Array.isArray(j)&&!(1>j.length)){var M=j[0];if(M!="noop"&&M!="stop"&&M!="close")for(var q=1;q<j.length;q++)j[q]=""}}}}return Ld(m)}catch{return f}}var Sl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Og={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Bd;function kl(){}T(kl,Fd),kl.prototype.g=function(){return new XMLHttpRequest},kl.prototype.i=function(){return{}},Bd=new kl;function rr(c,f,m,w){this.j=c,this.i=f,this.l=m,this.R=w||1,this.U=new mo(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Mg}function Mg(){this.i=null,this.g="",this.h=!1}var Lg={},$d={};function qd(c,f,m){c.L=1,c.v=Nl(Vn(f)),c.m=m,c.P=!0,Fg(c,null)}function Fg(c,f){c.F=Date.now(),bl(c),c.A=Vn(c.v);var m=c.A,w=c.R;Array.isArray(w)||(w=[String(w)]),Zg(m.i,"t",w),c.C=0,m=c.j.J,c.h=new Mg,c.g=yy(c.j,m?f:null,!c.m),0<c.O&&(c.M=new F1(g(c.Y,c,c.g),c.O)),f=c.U,m=c.g,w=c.ca;var j="readystatechange";Array.isArray(j)||(j&&(Ag[0]=j.toString()),j=Ag);for(var M=0;M<j.length;M++){var q=Eg(m,j[M],w||f.handleEvent,!1,f.h||f);if(!q)break;f.g[q.key]=q}f=c.H?x(c.H):{},c.m?(c.u||(c.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,f)):(c.u="GET",c.g.ea(c.A,c.u,null,f)),yo(),B1(c.i,c.u,c.A,c.l,c.R,c.m)}rr.prototype.ca=function(c){c=c.target;const f=this.M;f&&On(c)==3?f.j():this.Y(c)},rr.prototype.Y=function(c){try{if(c==this.g)e:{const ot=On(this.g);var f=this.g.Ba();const ni=this.g.Z();if(!(3>ot)&&(ot!=3||this.g&&(this.h.h||this.g.oa()||oy(this.g)))){this.J||ot!=4||f==7||(f==8||0>=ni?yo(3):yo(2)),Kd(this);var m=this.g.Z();this.X=m;t:if(Ug(this)){var w=oy(this.g);c="";var j=w.length,M=On(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ss(this),wo(this);var q="";break t}this.h.i=new a.TextDecoder}for(f=0;f<j;f++)this.h.h=!0,c+=this.h.i.decode(w[f],{stream:!(M&&f==j-1)});w.length=0,this.h.g+=c,this.C=0,q=this.h.g}else q=this.g.oa();if(this.o=m==200,$1(this.i,this.u,this.A,this.l,this.R,ot,m),this.o){if(this.T&&!this.K){t:{if(this.g){var ve,Xe=this.g;if((ve=Xe.g?Xe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(ve)){var he=ve;break t}}he=null}if(m=he)Zs(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Gd(this,m);else{this.o=!1,this.s=3,yt(12),ss(this),wo(this);break e}}if(this.P){m=!0;let en;for(;!this.J&&this.C<q.length;)if(en=G1(this,q),en==$d){ot==4&&(this.s=4,yt(14),m=!1),Zs(this.i,this.l,null,"[Incomplete Response]");break}else if(en==Lg){this.s=4,yt(15),Zs(this.i,this.l,q,"[Invalid Chunk]"),m=!1;break}else Zs(this.i,this.l,en,null),Gd(this,en);if(Ug(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ot!=4||q.length!=0||this.h.h||(this.s=1,yt(16),m=!1),this.o=this.o&&m,!m)Zs(this.i,this.l,q,"[Invalid Chunked Response]"),ss(this),wo(this);else if(0<q.length&&!this.W){this.W=!0;var it=this.j;it.g==this&&it.ba&&!it.M&&(it.j.info("Great, no buffering proxy detected. Bytes received: "+q.length),Xd(it),it.M=!0,yt(11))}}else Zs(this.i,this.l,q,null),Gd(this,q);ot==4&&ss(this),this.o&&!this.J&&(ot==4?fy(this.j,this):(this.o=!1,bl(this)))}else cS(this.g),m==400&&0<q.indexOf("Unknown SID")?(this.s=3,yt(12)):(this.s=0,yt(13)),ss(this),wo(this)}}}catch{}finally{}};function Ug(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function G1(c,f){var m=c.C,w=f.indexOf(`
`,m);return w==-1?$d:(m=Number(f.substring(m,w)),isNaN(m)?Lg:(w+=1,w+m>f.length?$d:(f=f.slice(w,w+m),c.C=w+m,f)))}rr.prototype.cancel=function(){this.J=!0,ss(this)};function bl(c){c.S=Date.now()+c.I,zg(c,c.I)}function zg(c,f){if(c.B!=null)throw Error("WatchDog timer not null");c.B=vo(g(c.ba,c),f)}function Kd(c){c.B&&(a.clearTimeout(c.B),c.B=null)}rr.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(q1(this.i,this.A),this.L!=2&&(yo(),yt(17)),ss(this),this.s=2,wo(this)):zg(this,this.S-c)};function wo(c){c.j.G==0||c.J||fy(c.j,c)}function ss(c){Kd(c);var f=c.M;f&&typeof f.ma=="function"&&f.ma(),c.M=null,Rg(c.U),c.g&&(f=c.g,c.g=null,f.abort(),f.ma())}function Gd(c,f){try{var m=c.j;if(m.G!=0&&(m.g==c||Wd(m.h,c))){if(!c.K&&Wd(m.h,c)&&m.G==3){try{var w=m.Da.g.parse(f)}catch{w=null}if(Array.isArray(w)&&w.length==3){var j=w;if(j[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<c.F)Ol(m),jl(m);else break e;Yd(m),yt(18)}}else m.za=j[1],0<m.za-m.T&&37500>j[2]&&m.F&&m.v==0&&!m.C&&(m.C=vo(g(m.Za,m),6e3));if(1>=qg(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else os(m,11)}else if((c.K||m.g==c)&&Ol(m),!y(f))for(j=m.Da.g.parse(f),f=0;f<j.length;f++){let he=j[f];if(m.T=he[0],he=he[1],m.G==2)if(he[0]=="c"){m.K=he[1],m.ia=he[2];const it=he[3];it!=null&&(m.la=it,m.j.info("VER="+m.la));const ot=he[4];ot!=null&&(m.Aa=ot,m.j.info("SVER="+m.Aa));const ni=he[5];ni!=null&&typeof ni=="number"&&0<ni&&(w=1.5*ni,m.L=w,m.j.info("backChannelRequestTimeoutMs_="+w)),w=m;const en=c.g;if(en){const Ll=en.g?en.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ll){var M=w.h;M.g||Ll.indexOf("spdy")==-1&&Ll.indexOf("quic")==-1&&Ll.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(Hd(M,M.h),M.h=null))}if(w.D){const Zd=en.g?en.g.getResponseHeader("X-HTTP-Session-Id"):null;Zd&&(w.ya=Zd,Ee(w.I,w.D,Zd))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-c.F,m.j.info("Handshake RTT: "+m.R+"ms")),w=m;var q=c;if(w.qa=gy(w,w.J?w.ia:null,w.W),q.K){Kg(w.h,q);var ve=q,Xe=w.L;Xe&&(ve.I=Xe),ve.B&&(Kd(ve),bl(ve)),w.g=q}else dy(w);0<m.i.length&&Vl(m)}else he[0]!="stop"&&he[0]!="close"||os(m,7);else m.G==3&&(he[0]=="stop"||he[0]=="close"?he[0]=="stop"?os(m,7):Jd(m):he[0]!="noop"&&m.l&&m.l.ta(he),m.v=0)}}yo(4)}catch{}}var W1=class{constructor(c,f){this.g=c,this.map=f}};function Bg(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function $g(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function qg(c){return c.h?1:c.g?c.g.size:0}function Wd(c,f){return c.h?c.h==f:c.g?c.g.has(f):!1}function Hd(c,f){c.g?c.g.add(f):c.h=f}function Kg(c,f){c.h&&c.h==f?c.h=null:c.g&&c.g.has(f)&&c.g.delete(f)}Bg.prototype.cancel=function(){if(this.i=Gg(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Gg(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let f=c.i;for(const m of c.g.values())f=f.concat(m.D);return f}return b(c.i)}function H1(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(l(c)){for(var f=[],m=c.length,w=0;w<m;w++)f.push(c[w]);return f}f=[],m=0;for(w in c)f[m++]=c[w];return f}function Q1(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(l(c)||typeof c=="string"){var f=[];c=c.length;for(var m=0;m<c;m++)f.push(m);return f}f=[],m=0;for(const w in c)f[m++]=w;return f}}}function Wg(c,f){if(c.forEach&&typeof c.forEach=="function")c.forEach(f,void 0);else if(l(c)||typeof c=="string")Array.prototype.forEach.call(c,f,void 0);else for(var m=Q1(c),w=H1(c),j=w.length,M=0;M<j;M++)f.call(void 0,w[M],m&&m[M],c)}var Hg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function J1(c,f){if(c){c=c.split("&");for(var m=0;m<c.length;m++){var w=c[m].indexOf("="),j=null;if(0<=w){var M=c[m].substring(0,w);j=c[m].substring(w+1)}else M=c[m];f(M,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function is(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof is){this.h=c.h,Al(this,c.j),this.o=c.o,this.g=c.g,Rl(this,c.s),this.l=c.l;var f=c.i,m=new Io;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),Qg(this,m),this.m=c.m}else c&&(f=String(c).match(Hg))?(this.h=!1,Al(this,f[1]||"",!0),this.o=xo(f[2]||""),this.g=xo(f[3]||"",!0),Rl(this,f[4]),this.l=xo(f[5]||"",!0),Qg(this,f[6]||"",!0),this.m=xo(f[7]||"")):(this.h=!1,this.i=new Io(null,this.h))}is.prototype.toString=function(){var c=[],f=this.j;f&&c.push(Eo(f,Jg,!0),":");var m=this.g;return(m||f=="file")&&(c.push("//"),(f=this.o)&&c.push(Eo(f,Jg,!0),"@"),c.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&c.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&c.push("/"),c.push(Eo(m,m.charAt(0)=="/"?Z1:X1,!0))),(m=this.i.toString())&&c.push("?",m),(m=this.m)&&c.push("#",Eo(m,tS)),c.join("")};function Vn(c){return new is(c)}function Al(c,f,m){c.j=m?xo(f,!0):f,c.j&&(c.j=c.j.replace(/:$/,""))}function Rl(c,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);c.s=f}else c.s=null}function Qg(c,f,m){f instanceof Io?(c.i=f,nS(c.i,c.h)):(m||(f=Eo(f,eS)),c.i=new Io(f,c.h))}function Ee(c,f,m){c.i.set(f,m)}function Nl(c){return Ee(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function xo(c,f){return c?f?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Eo(c,f,m){return typeof c=="string"?(c=encodeURI(c).replace(f,Y1),m&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Y1(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Jg=/[#\/\?@]/g,X1=/[#\?:]/g,Z1=/[#\?]/g,eS=/[#\?@]/g,tS=/#/g;function Io(c,f){this.h=this.g=null,this.i=c||null,this.j=!!f}function sr(c){c.g||(c.g=new Map,c.h=0,c.i&&J1(c.i,function(f,m){c.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}t=Io.prototype,t.add=function(c,f){sr(this),this.i=null,c=ei(this,c);var m=this.g.get(c);return m||this.g.set(c,m=[]),m.push(f),this.h+=1,this};function Yg(c,f){sr(c),f=ei(c,f),c.g.has(f)&&(c.i=null,c.h-=c.g.get(f).length,c.g.delete(f))}function Xg(c,f){return sr(c),f=ei(c,f),c.g.has(f)}t.forEach=function(c,f){sr(this),this.g.forEach(function(m,w){m.forEach(function(j){c.call(f,j,w,this)},this)},this)},t.na=function(){sr(this);const c=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let w=0;w<f.length;w++){const j=c[w];for(let M=0;M<j.length;M++)m.push(f[w])}return m},t.V=function(c){sr(this);let f=[];if(typeof c=="string")Xg(this,c)&&(f=f.concat(this.g.get(ei(this,c))));else{c=Array.from(this.g.values());for(let m=0;m<c.length;m++)f=f.concat(c[m])}return f},t.set=function(c,f){return sr(this),this.i=null,c=ei(this,c),Xg(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[f]),this.h+=1,this},t.get=function(c,f){return c?(c=this.V(c),0<c.length?String(c[0]):f):f};function Zg(c,f,m){Yg(c,f),0<m.length&&(c.i=null,c.g.set(ei(c,f),b(m)),c.h+=m.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var w=f[m];const M=encodeURIComponent(String(w)),q=this.V(w);for(w=0;w<q.length;w++){var j=M;q[w]!==""&&(j+="="+encodeURIComponent(String(q[w]))),c.push(j)}}return this.i=c.join("&")};function ei(c,f){return f=String(f),c.j&&(f=f.toLowerCase()),f}function nS(c,f){f&&!c.j&&(sr(c),c.i=null,c.g.forEach(function(m,w){var j=w.toLowerCase();w!=j&&(Yg(this,w),Zg(this,j,m))},c)),c.j=f}function rS(c,f){const m=new _o;if(a.Image){const w=new Image;w.onload=v(ir,m,"TestLoadImage: loaded",!0,f,w),w.onerror=v(ir,m,"TestLoadImage: error",!1,f,w),w.onabort=v(ir,m,"TestLoadImage: abort",!1,f,w),w.ontimeout=v(ir,m,"TestLoadImage: timeout",!1,f,w),a.setTimeout(function(){w.ontimeout&&w.ontimeout()},1e4),w.src=c}else f(!1)}function sS(c,f){const m=new _o,w=new AbortController,j=setTimeout(()=>{w.abort(),ir(m,"TestPingServer: timeout",!1,f)},1e4);fetch(c,{signal:w.signal}).then(M=>{clearTimeout(j),M.ok?ir(m,"TestPingServer: ok",!0,f):ir(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(j),ir(m,"TestPingServer: error",!1,f)})}function ir(c,f,m,w,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),w(m)}catch{}}function iS(){this.g=new z1}function oS(c,f,m){const w=m||"";try{Wg(c,function(j,M){let q=j;d(j)&&(q=Ld(j)),f.push(w+M+"="+encodeURIComponent(q))})}catch(j){throw f.push(w+"type="+encodeURIComponent("_badmap")),j}}function Cl(c){this.l=c.Ub||null,this.j=c.eb||!1}T(Cl,Fd),Cl.prototype.g=function(){return new Pl(this.l,this.j)},Cl.prototype.i=function(c){return function(){return c}}({});function Pl(c,f){st.call(this),this.D=c,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(Pl,st),t=Pl.prototype,t.open=function(c,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=f,this.readyState=1,So(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(f.body=c),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,To(this)),this.readyState=0},t.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,So(this)),this.g&&(this.readyState=3,So(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ey(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function ey(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}t.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var f=c.value?c.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!c.done}))&&(this.response=this.responseText+=f)}c.done?To(this):So(this),this.readyState==3&&ey(this)}},t.Ra=function(c){this.g&&(this.response=this.responseText=c,To(this))},t.Qa=function(c){this.g&&(this.response=c,To(this))},t.ga=function(){this.g&&To(this)};function To(c){c.readyState=4,c.l=null,c.j=null,c.v=null,So(c)}t.setRequestHeader=function(c,f){this.u.append(c,f)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,c.push(m[0]+": "+m[1]),m=f.next();return c.join(`\r
`)};function So(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Pl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function ty(c){let f="";return L(c,function(m,w){f+=w,f+=":",f+=m,f+=`\r
`}),f}function Qd(c,f,m){e:{for(w in m){var w=!1;break e}w=!0}w||(m=ty(m),typeof c=="string"?m!=null&&encodeURIComponent(String(m)):Ee(c,f,m))}function De(c){st.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(De,st);var aS=/^https?$/i,lS=["POST","PUT"];t=De.prototype,t.Ha=function(c){this.J=c},t.ea=function(c,f,m,w){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);f=f?f.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Bd.g(),this.v=this.o?Ng(this.o):Ng(Bd),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(f,String(c),!0),this.B=!1}catch(M){ny(this,M);return}if(c=m||"",m=new Map(this.headers),w)if(Object.getPrototypeOf(w)===Object.prototype)for(var j in w)m.set(j,w[j]);else if(typeof w.keys=="function"&&typeof w.get=="function")for(const M of w.keys())m.set(M,w.get(M));else throw Error("Unknown input type for opt_headers: "+String(w));w=Array.from(m.keys()).find(M=>M.toLowerCase()=="content-type"),j=a.FormData&&c instanceof a.FormData,!(0<=Array.prototype.indexOf.call(lS,f,void 0))||w||j||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,q]of m)this.g.setRequestHeader(M,q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{iy(this),this.u=!0,this.g.send(c),this.u=!1}catch(M){ny(this,M)}};function ny(c,f){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=f,c.m=5,ry(c),Dl(c)}function ry(c){c.A||(c.A=!0,gt(c,"complete"),gt(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,gt(this,"complete"),gt(this,"abort"),Dl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Dl(this,!0)),De.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?sy(this):this.bb())},t.bb=function(){sy(this)};function sy(c){if(c.h&&typeof o<"u"&&(!c.v[1]||On(c)!=4||c.Z()!=2)){if(c.u&&On(c)==4)kg(c.Ea,0,c);else if(gt(c,"readystatechange"),On(c)==4){c.h=!1;try{const q=c.Z();e:switch(q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var w;if(w=q===0){var j=String(c.D).match(Hg)[1]||null;!j&&a.self&&a.self.location&&(j=a.self.location.protocol.slice(0,-1)),w=!aS.test(j?j.toLowerCase():"")}m=w}if(m)gt(c,"complete"),gt(c,"success");else{c.m=6;try{var M=2<On(c)?c.g.statusText:""}catch{M=""}c.l=M+" ["+c.Z()+"]",ry(c)}}finally{Dl(c)}}}}function Dl(c,f){if(c.g){iy(c);const m=c.g,w=c.v[0]?()=>{}:null;c.g=null,c.v=null,f||gt(c,"ready");try{m.onreadystatechange=w}catch{}}}function iy(c){c.I&&(a.clearTimeout(c.I),c.I=null)}t.isActive=function(){return!!this.g};function On(c){return c.g?c.g.readyState:0}t.Z=function(){try{return 2<On(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(c){if(this.g){var f=this.g.responseText;return c&&f.indexOf(c)==0&&(f=f.substring(c.length)),U1(f)}};function oy(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function cS(c){const f={};c=(c.g&&2<=On(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let w=0;w<c.length;w++){if(y(c[w]))continue;var m=N(c[w]);const j=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const M=f[j]||[];f[j]=M,M.push(m)}S(f,function(w){return w.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ko(c,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[c]||f}function ay(c){this.Aa=0,this.i=[],this.j=new _o,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ko("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ko("baseRetryDelayMs",5e3,c),this.cb=ko("retryDelaySeedMs",1e4,c),this.Wa=ko("forwardChannelMaxRetries",2,c),this.wa=ko("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Bg(c&&c.concurrentRequestLimit),this.Da=new iS,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=ay.prototype,t.la=8,t.G=1,t.connect=function(c,f,m,w){yt(0),this.W=c,this.H=f||{},m&&w!==void 0&&(this.H.OSID=m,this.H.OAID=w),this.F=this.X,this.I=gy(this,null,this.W),Vl(this)};function Jd(c){if(ly(c),c.G==3){var f=c.U++,m=Vn(c.I);if(Ee(m,"SID",c.K),Ee(m,"RID",f),Ee(m,"TYPE","terminate"),bo(c,m),f=new rr(c,c.j,f),f.L=2,f.v=Nl(Vn(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=f.v,m=!0),m||(f.g=yy(f.j,null),f.g.ea(f.v)),f.F=Date.now(),bl(f)}my(c)}function jl(c){c.g&&(Xd(c),c.g.cancel(),c.g=null)}function ly(c){jl(c),c.u&&(a.clearTimeout(c.u),c.u=null),Ol(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&a.clearTimeout(c.s),c.s=null)}function Vl(c){if(!$g(c.h)&&!c.s){c.s=!0;var f=c.Ga;ue||J(),F||(ue(),F=!0),K.add(f,c),c.B=0}}function uS(c,f){return qg(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=f.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=vo(g(c.Ga,c,f),py(c,c.B)),c.B++,!0)}t.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const j=new rr(this,this.j,c);let M=this.o;if(this.S&&(M?(M=x(M),R(M,this.S)):M=this.S),this.m!==null||this.O||(j.H=M,M=null),this.P)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var w=this.i[m];if("__data__"in w.map&&(w=w.map.__data__,typeof w=="string")){w=w.length;break t}w=void 0}if(w===void 0)break;if(f+=w,4096<f){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=uy(this,j,f),m=Vn(this.I),Ee(m,"RID",c),Ee(m,"CVER",22),this.D&&Ee(m,"X-HTTP-Session-Id",this.D),bo(this,m),M&&(this.O?f="headers="+encodeURIComponent(String(ty(M)))+"&"+f:this.m&&Qd(m,this.m,M)),Hd(this.h,j),this.Ua&&Ee(m,"TYPE","init"),this.P?(Ee(m,"$req",f),Ee(m,"SID","null"),j.T=!0,qd(j,m,null)):qd(j,m,f),this.G=2}}else this.G==3&&(c?cy(this,c):this.i.length==0||$g(this.h)||cy(this))};function cy(c,f){var m;f?m=f.l:m=c.U++;const w=Vn(c.I);Ee(w,"SID",c.K),Ee(w,"RID",m),Ee(w,"AID",c.T),bo(c,w),c.m&&c.o&&Qd(w,c.m,c.o),m=new rr(c,c.j,m,c.B+1),c.m===null&&(m.H=c.o),f&&(c.i=f.D.concat(c.i)),f=uy(c,m,1e3),m.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Hd(c.h,m),qd(m,w,f)}function bo(c,f){c.H&&L(c.H,function(m,w){Ee(f,w,m)}),c.l&&Wg({},function(m,w){Ee(f,w,m)})}function uy(c,f,m){m=Math.min(c.i.length,m);var w=c.l?g(c.l.Na,c.l,c):null;e:{var j=c.i;let M=-1;for(;;){const q=["count="+m];M==-1?0<m?(M=j[0].g,q.push("ofs="+M)):M=0:q.push("ofs="+M);let ve=!0;for(let Xe=0;Xe<m;Xe++){let he=j[Xe].g;const it=j[Xe].map;if(he-=M,0>he)M=Math.max(0,j[Xe].g-100),ve=!1;else try{oS(it,q,"req"+he+"_")}catch{w&&w(it)}}if(ve){w=q.join("&");break e}}}return c=c.i.splice(0,m),f.D=c,w}function dy(c){if(!c.g&&!c.u){c.Y=1;var f=c.Fa;ue||J(),F||(ue(),F=!0),K.add(f,c),c.v=0}}function Yd(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=vo(g(c.Fa,c),py(c,c.v)),c.v++,!0)}t.Fa=function(){if(this.u=null,hy(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=vo(g(this.ab,this),c)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,yt(10),jl(this),hy(this))};function Xd(c){c.A!=null&&(a.clearTimeout(c.A),c.A=null)}function hy(c){c.g=new rr(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var f=Vn(c.qa);Ee(f,"RID","rpc"),Ee(f,"SID",c.K),Ee(f,"AID",c.T),Ee(f,"CI",c.F?"0":"1"),!c.F&&c.ja&&Ee(f,"TO",c.ja),Ee(f,"TYPE","xmlhttp"),bo(c,f),c.m&&c.o&&Qd(f,c.m,c.o),c.L&&(c.g.I=c.L);var m=c.g;c=c.ia,m.L=1,m.v=Nl(Vn(f)),m.m=null,m.P=!0,Fg(m,c)}t.Za=function(){this.C!=null&&(this.C=null,jl(this),Yd(this),yt(19))};function Ol(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function fy(c,f){var m=null;if(c.g==f){Ol(c),Xd(c),c.g=null;var w=2}else if(Wd(c.h,f))m=f.D,Kg(c.h,f),w=1;else return;if(c.G!=0){if(f.o)if(w==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var j=c.B;w=Tl(),gt(w,new Vg(w,m)),Vl(c)}else dy(c);else if(j=f.s,j==3||j==0&&0<f.X||!(w==1&&uS(c,f)||w==2&&Yd(c)))switch(m&&0<m.length&&(f=c.h,f.i=f.i.concat(m)),j){case 1:os(c,5);break;case 4:os(c,10);break;case 3:os(c,6);break;default:os(c,2)}}}function py(c,f){let m=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(m*=2),m*f}function os(c,f){if(c.j.info("Error code "+f),f==2){var m=g(c.fb,c),w=c.Xa;const j=!w;w=new is(w||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Al(w,"https"),Nl(w),j?rS(w.toString(),m):sS(w.toString(),m)}else yt(2);c.G=0,c.l&&c.l.sa(f),my(c),ly(c)}t.fb=function(c){c?(this.j.info("Successfully pinged google.com"),yt(2)):(this.j.info("Failed to ping google.com"),yt(1))};function my(c){if(c.G=0,c.ka=[],c.l){const f=Gg(c.h);(f.length!=0||c.i.length!=0)&&(E(c.ka,f),E(c.ka,c.i),c.h.i.length=0,b(c.i),c.i.length=0),c.l.ra()}}function gy(c,f,m){var w=m instanceof is?Vn(m):new is(m);if(w.g!="")f&&(w.g=f+"."+w.g),Rl(w,w.s);else{var j=a.location;w=j.protocol,f=f?f+"."+j.hostname:j.hostname,j=+j.port;var M=new is(null);w&&Al(M,w),f&&(M.g=f),j&&Rl(M,j),m&&(M.l=m),w=M}return m=c.D,f=c.ya,m&&f&&Ee(w,m,f),Ee(w,"VER",c.la),bo(c,w),w}function yy(c,f,m){if(f&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=c.Ca&&!c.pa?new De(new Cl({eb:m})):new De(c.pa),f.Ha(c.J),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function vy(){}t=vy.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ml(){}Ml.prototype.g=function(c,f){return new Ot(c,f)};function Ot(c,f){st.call(this),this.g=new ay(f),this.l=c,this.h=f&&f.messageUrlParams||null,c=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(c?c["X-WebChannel-Content-Type"]=f.messageContentType:c={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(c?c["X-WebChannel-Client-Profile"]=f.va:c={"X-WebChannel-Client-Profile":f.va}),this.g.S=c,(c=f&&f.Sb)&&!y(c)&&(this.g.m=c),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!y(f)&&(this.g.D=f,c=this.h,c!==null&&f in c&&(c=this.h,f in c&&delete c[f])),this.j=new ti(this)}T(Ot,st),Ot.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ot.prototype.close=function(){Jd(this.g)},Ot.prototype.o=function(c){var f=this.g;if(typeof c=="string"){var m={};m.__data__=c,c=m}else this.u&&(m={},m.__data__=Ld(c),c=m);f.i.push(new W1(f.Ya++,c)),f.G==3&&Vl(f)},Ot.prototype.N=function(){this.g.l=null,delete this.j,Jd(this.g),delete this.g,Ot.aa.N.call(this)};function _y(c){Ud.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var f=c.__sm__;if(f){e:{for(const m in f){c=m;break e}c=void 0}(this.i=c)&&(c=this.i,f=f!==null&&c in f?f[c]:void 0),this.data=f}else this.data=c}T(_y,Ud);function wy(){zd.call(this),this.status=1}T(wy,zd);function ti(c){this.g=c}T(ti,vy),ti.prototype.ua=function(){gt(this.g,"a")},ti.prototype.ta=function(c){gt(this.g,new _y(c))},ti.prototype.sa=function(c){gt(this.g,new wy)},ti.prototype.ra=function(){gt(this.g,"b")},Ml.prototype.createWebChannel=Ml.prototype.g,Ot.prototype.send=Ot.prototype.o,Ot.prototype.open=Ot.prototype.m,Ot.prototype.close=Ot.prototype.close,ME=function(){return new Ml},OE=function(){return Tl()},VE=rs,Bf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Sl.NO_ERROR=0,Sl.TIMEOUT=8,Sl.HTTP_ERROR=6,Ec=Sl,Og.COMPLETE="complete",jE=Og,Cg.EventType=go,go.OPEN="a",go.CLOSE="b",go.ERROR="c",go.MESSAGE="d",st.prototype.listen=st.prototype.K,Ho=Cg,De.prototype.listenOnce=De.prototype.L,De.prototype.getLastError=De.prototype.Ka,De.prototype.getLastErrorCode=De.prototype.Ba,De.prototype.getStatus=De.prototype.Z,De.prototype.getResponseJson=De.prototype.Oa,De.prototype.getResponseText=De.prototype.oa,De.prototype.send=De.prototype.ea,De.prototype.setWithCredentials=De.prototype.Ha,DE=De}).apply(typeof nc<"u"?nc:typeof self<"u"?self:typeof window<"u"?window:{});const Xv="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ut.UNAUTHENTICATED=new ut(null),ut.GOOGLE_CREDENTIALS=new ut("google-credentials-uid"),ut.FIRST_PARTY=new ut("first-party-uid"),ut.MOCK_USER=new ut("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lo="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ps=new mm("@firebase/firestore");function ci(){return Ps.logLevel}function z(t,...e){if(Ps.logLevel<=oe.DEBUG){const n=e.map(ym);Ps.debug(`Firestore (${lo}): ${t}`,...n)}}function Fe(t,...e){if(Ps.logLevel<=oe.ERROR){const n=e.map(ym);Ps.error(`Firestore (${lo}): ${t}`,...n)}}function Ma(t,...e){if(Ps.logLevel<=oe.WARN){const n=e.map(ym);Ps.warn(`Firestore (${lo}): ${t}`,...n)}}function ym(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q(t="Unexpected state"){const e=`FIRESTORE (${lo}) INTERNAL ASSERTION FAILED: `+t;throw Fe(e),new Error(e)}function Y(t,e){t||Q()}function H(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $ extends Rn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class TN{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ut.UNAUTHENTICATED))}shutdown(){}}class SN{constructor(e){this.t=e,this.currentUser=ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Y(this.o===void 0);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new cn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new cn,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(z("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new cn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Y(typeof r.accessToken=="string"),new IN(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Y(e===null||typeof e=="string"),new ut(e)}}class kN{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=ut.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class bN{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new kN(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(ut.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class AN{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class RN{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Y(this.o===void 0);const r=i=>{i.error!=null&&z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,z("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Y(typeof n.token=="string"),this.R=n.token,new AN(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NN(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LE{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=NN(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function te(t,e){return t<e?-1:t>e?1:0}function Gi(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function FE(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new $(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new $(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new $(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ne.fromMillis(Date.now())}static fromDate(e){return Ne.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Ne(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?te(this.nanoseconds,e.nanoseconds):te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.timestamp=e}static fromTimestamp(e){return new X(e)}static min(){return new X(new Ne(0,0))}static max(){return new X(new Ne(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La{constructor(e,n,r){n===void 0?n=0:n>e.length&&Q(),r===void 0?r=e.length-n:r>e.length-n&&Q(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return La.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof La?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class fe extends La{construct(e,n,r){return new fe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new $(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new fe(n)}static emptyPath(){return new fe([])}}const CN=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ae extends La{construct(e,n,r){return new Ae(e,n,r)}static isValidIdentifier(e){return CN.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ae.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ae(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new $(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new $(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new $(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new $(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ae(n)}static emptyPath(){return new Ae([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(e){this.path=e}static fromPath(e){return new G(fe.fromString(e))}static fromName(e){return new G(fe.fromString(e).popFirst(5))}static empty(){return new G(fe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&fe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return fe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new G(new fe(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function $f(t){return t.fields.find(e=>e.kind===2)}function ds(t){return t.fields.filter(e=>e.kind!==2)}hu.UNKNOWN_ID=-1;class Ic{constructor(e,n){this.fieldPath=e,this.kind=n}}class Fa{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Fa(0,$t.min())}}function UE(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=X.fromTimestamp(r===1e9?new Ne(n+1,0):new Ne(n,r));return new $t(s,G.empty(),e)}function zE(t){return new $t(t.readTime,t.key,-1)}class $t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new $t(X.min(),G.empty(),-1)}static max(){return new $t(X.max(),G.empty(),-1)}}function vm(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=G.comparator(t.documentKey,e.documentKey),n!==0?n:te(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $E{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yr(t){if(t.code!==U.FAILED_PRECONDITION||t.message!==BE)throw t;z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new V((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof V?n:V.resolve(n)}catch(n){return V.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):V.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):V.reject(n)}static resolve(e){return new V((n,r)=>{n(e)})}static reject(e){return new V((n,r)=>{r(e)})}static waitFor(e){return new V((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=V.resolve(!1);for(const r of e)n=n.next(s=>s?V.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new V((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const d=l;n(e[d]).next(h=>{o[d]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new V((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new cn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new la(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=_m(r.target.error);this.V.reject(new la(e,s))}}static open(e,n,r,s){try{return new td(n,e.transaction(s,r))}catch(i){throw new la(n,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(z("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new DN(n)}}class Or{constructor(e,n,r){this.name=e,this.version=n,this.p=r,Or.S(We())===12.2&&Fe("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return z("SimpleDb","Removing database:",e),hs(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!SE())return!1;if(Or.v())return!0;const e=We(),n=Or.S(e),r=0<n&&n<10,s=qE(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(z("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new la(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new $(U.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new $(U.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new la(e,o))},s.onupgradeneeded=i=>{z("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{z("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=td.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(d=>(a.g(),d)).catch(d=>(a.abort(d),V.reject(d))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,d=l.name!=="FirebaseError"&&o<3;if(z("SimpleDb","Transaction failed with error:",l.message,"Retrying:",d),this.close(),!d)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function qE(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class PN{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return hs(this.B.delete())}}class la extends ${constructor(e,n){super(U.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Xr(t){return t.name==="IndexedDbTransactionError"}class DN{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(z("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(z("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),hs(r)}add(e){return z("SimpleDb","ADD",this.store.name,e,e),hs(this.store.add(e))}get(e){return hs(this.store.get(e)).next(n=>(n===void 0&&(n=null),z("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return z("SimpleDb","DELETE",this.store.name,e),hs(this.store.delete(e))}count(){return z("SimpleDb","COUNT",this.store.name),hs(this.store.count())}U(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new V((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.W(i,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new V((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}j(e,n){z("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const s=this.cursor(r);return this.W(s,(i,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.W(s,n)}Y(e){const n=this.cursor({});return new V((r,s)=>{n.onerror=i=>{const o=_m(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){const r=[];return new V((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new PN(a),d=n(a.primaryKey,a.value,l);if(d instanceof V){const h=d.catch(p=>(l.done(),V.reject(p)));r.push(h)}l.isDone?s():l.K===null?a.continue():a.continue(l.K)}}).next(()=>V.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function hs(t){return new V((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=_m(r.target.error);n(s)}})}let Zv=!1;function _m(t){const e=Or.S(We());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new $("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Zv||(Zv=!0,setTimeout(()=>{throw r},0)),r}}return t}class jN{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){z("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{z("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){Xr(n)?z("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await Yr(n)}await this.X(6e4)})}}class VN{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let s=n,i=!0;return V.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return z("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,i)).next(a=>(z("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=zE(i);vm(o,r)>0&&(r=o)}),new $t(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Rt.oe=-1;function nd(t){return t==null}function Ua(t){return t===0&&1/t==-1/0}function KE(t){return typeof t=="number"&&Number.isInteger(t)&&!Ua(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=e0(e)),e=ON(t.get(n),e);return e0(e)}function ON(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function e0(t){return t+""}function vn(t){const e=t.length;if(Y(e>=2),e===2)return Y(t.charAt(0)===""&&t.charAt(1)===""),fe.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>n)&&Q(),t.charAt(o+1)){case"":const a=t.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:Q()}i=o+2}return new fe(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t0=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tc(t,e){return[t,wt(e)]}function GE(t,e,n){return[t,wt(e),n]}const MN={},LN=["prefixPath","collectionGroup","readTime","documentId"],FN=["prefixPath","collectionGroup","documentId"],UN=["collectionGroup","readTime","prefixPath","documentId"],zN=["canonicalId","targetId"],BN=["targetId","path"],$N=["path","targetId"],qN=["collectionId","parent"],KN=["indexId","uid"],GN=["uid","sequenceNumber"],WN=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],HN=["indexId","uid","orderedDocumentKey"],QN=["userId","collectionPath","documentId"],JN=["userId","collectionPath","largestBatchId"],YN=["userId","collectionGroup","largestBatchId"],WE=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],XN=[...WE,"documentOverlays"],HE=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],QE=HE,wm=[...QE,"indexConfiguration","indexState","indexEntries"],ZN=wm,eC=[...wm,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf extends $E{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function He(t,e){const n=H(t);return Or.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n0(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Hs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function tC(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function JE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e,n){this.comparator=e,this.root=n||et.EMPTY}insert(e,n){return new xe(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,et.BLACK,null,null))}remove(e){return new xe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,et.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rc(this.root,e,this.comparator,!1)}getReverseIterator(){return new rc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rc(this.root,e,this.comparator,!0)}}class rc{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class et{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??et.RED,this.left=s??et.EMPTY,this.right=i??et.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new et(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return et.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return et.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,et.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,et.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Q();const e=this.left.check();if(e!==this.right.check())throw Q();return e+(this.isRed()?0:1)}}et.EMPTY=null,et.RED=!0,et.BLACK=!1;et.EMPTY=new class{constructor(){this.size=0}get key(){throw Q()}get value(){throw Q()}get color(){throw Q()}get left(){throw Q()}get right(){throw Q()}copy(e,n,r,s,i){return this}insert(e,n,r){return new et(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(e){this.comparator=e,this.data=new xe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new r0(this.data.getIterator())}getIteratorFrom(e){return new r0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof ge)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new ge(this.comparator);return n.data=e,n}}class r0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function si(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e){this.fields=e,e.sort(Ae.comparator)}static empty(){return new Nt([])}unionWith(e){let n=new ge(Ae.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Nt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Gi(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new YE("Invalid base64 string: "+i):i}}(e);return new Ue(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Ue(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ue.EMPTY_BYTE_STRING=new Ue("");const nC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xn(t){if(Y(!!t),typeof t=="string"){let e=0;const n=nC.exec(t);if(Y(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Se(t.seconds),nanos:Se(t.nanos)}}function Se(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Br(t){return typeof t=="string"?Ue.fromBase64String(t):Ue.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xm(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Em(t){const e=t.mapValue.fields.__previous_value__;return xm(e)?Em(e):e}function za(t){const e=Xn(t.mapValue.fields.__local_write_time__.timestampValue);return new Ne(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(e,n,r,s,i,o,a,l,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=d}}class Ds{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Ds("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ds&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Sc={nullValue:"NULL_VALUE"};function js(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?xm(t)?4:XE(t)?9007199254740991:rd(t)?10:11:Q()}function kn(t,e){if(t===e)return!0;const n=js(t);if(n!==js(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return za(t).isEqual(za(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Xn(s.timestampValue),a=Xn(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Br(s.bytesValue).isEqual(Br(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Se(s.geoPointValue.latitude)===Se(i.geoPointValue.latitude)&&Se(s.geoPointValue.longitude)===Se(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Se(s.integerValue)===Se(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Se(s.doubleValue),a=Se(i.doubleValue);return o===a?Ua(o)===Ua(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Gi(t.arrayValue.values||[],e.arrayValue.values||[],kn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(n0(o)!==n0(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!kn(o[l],a[l])))return!1;return!0}(t,e);default:return Q()}}function Ba(t,e){return(t.values||[]).find(n=>kn(n,e))!==void 0}function $r(t,e){if(t===e)return 0;const n=js(t),r=js(e);if(n!==r)return te(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return te(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Se(i.integerValue||i.doubleValue),l=Se(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return s0(t.timestampValue,e.timestampValue);case 4:return s0(za(t),za(e));case 5:return te(t.stringValue,e.stringValue);case 6:return function(i,o){const a=Br(i),l=Br(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let d=0;d<a.length&&d<l.length;d++){const h=te(a[d],l[d]);if(h!==0)return h}return te(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=te(Se(i.latitude),Se(o.latitude));return a!==0?a:te(Se(i.longitude),Se(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return i0(t.arrayValue,e.arrayValue);case 10:return function(i,o){var a,l,d,h;const p=i.fields||{},g=o.fields||{},v=(a=p.value)===null||a===void 0?void 0:a.arrayValue,T=(l=g.value)===null||l===void 0?void 0:l.arrayValue,b=te(((d=v==null?void 0:v.values)===null||d===void 0?void 0:d.length)||0,((h=T==null?void 0:T.values)===null||h===void 0?void 0:h.length)||0);return b!==0?b:i0(v,T)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Sr.mapValue&&o===Sr.mapValue)return 0;if(i===Sr.mapValue)return 1;if(o===Sr.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),d=o.fields||{},h=Object.keys(d);l.sort(),h.sort();for(let p=0;p<l.length&&p<h.length;++p){const g=te(l[p],h[p]);if(g!==0)return g;const v=$r(a[l[p]],d[h[p]]);if(v!==0)return v}return te(l.length,h.length)}(t.mapValue,e.mapValue);default:throw Q()}}function s0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return te(t,e);const n=Xn(t),r=Xn(e),s=te(n.seconds,r.seconds);return s!==0?s:te(n.nanos,r.nanos)}function i0(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=$r(n[s],r[s]);if(i)return i}return te(n.length,r.length)}function Wi(t){return Kf(t)}function Kf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Xn(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Br(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return G.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Kf(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Kf(n.fields[o])}`;return s+"}"}(t.mapValue):Q()}function $a(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Gf(t){return!!t&&"integerValue"in t}function qa(t){return!!t&&"arrayValue"in t}function o0(t){return!!t&&"nullValue"in t}function a0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function kc(t){return!!t&&"mapValue"in t}function rd(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function ca(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Hs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ca(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ca(t.arrayValue.values[n]);return e}return Object.assign({},t)}function XE(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const ZE={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function sC(t){return"nullValue"in t?Sc:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?$a(Ds.empty(),G.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?rd(t)?ZE:{mapValue:{}}:Q()}function iC(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?$a(Ds.empty(),G.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?ZE:"mapValue"in t?rd(t)?{mapValue:{}}:Sr:Q()}function l0(t,e){const n=$r(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function c0(t,e){const n=$r(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.value=e}static empty(){return new ht({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!kc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ca(n)}setAll(e){let n=Ae.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=ca(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());kc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return kn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];kc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Hs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new ht(ca(this.value))}}function eI(t){const e=[];return Hs(t.fields,(n,r)=>{const s=new Ae([n]);if(kc(r)){const i=eI(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Nt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ve(e,0,X.min(),X.min(),X.min(),ht.empty(),0)}static newFoundDocument(e,n,r,s){return new Ve(e,1,n,X.min(),r,s,0)}static newNoDocument(e,n){return new Ve(e,2,n,X.min(),X.min(),ht.empty(),0)}static newUnknownDocument(e,n){return new Ve(e,3,n,X.min(),X.min(),ht.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(X.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ht.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ht.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=X.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ve&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ve(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e,n){this.position=e,this.inclusive=n}}function u0(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=G.comparator(G.fromName(o.referenceValue),n.key):r=$r(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function d0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!kn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka{constructor(e,n="asc"){this.field=e,this.dir=n}}function oC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{}class ae extends tI{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new aC(e,n,r):n==="array-contains"?new uC(e,r):n==="in"?new aI(e,r):n==="not-in"?new dC(e,r):n==="array-contains-any"?new hC(e,r):new ae(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new lC(e,r):new cC(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison($r(n,this.value)):n!==null&&js(this.value)===js(n)&&this.matchesComparison($r(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Q()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class pe extends tI{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new pe(e,n)}matches(e){return Qi(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Qi(t){return t.op==="and"}function Wf(t){return t.op==="or"}function Im(t){return nI(t)&&Qi(t)}function nI(t){for(const e of t.filters)if(e instanceof pe)return!1;return!0}function Hf(t){if(t instanceof ae)return t.field.canonicalString()+t.op.toString()+Wi(t.value);if(Im(t))return t.filters.map(e=>Hf(e)).join(",");{const e=t.filters.map(n=>Hf(n)).join(",");return`${t.op}(${e})`}}function rI(t,e){return t instanceof ae?function(r,s){return s instanceof ae&&r.op===s.op&&r.field.isEqual(s.field)&&kn(r.value,s.value)}(t,e):t instanceof pe?function(r,s){return s instanceof pe&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&rI(o,s.filters[a]),!0):!1}(t,e):void Q()}function sI(t,e){const n=t.filters.concat(e);return pe.create(n,t.op)}function iI(t){return t instanceof ae?function(n){return`${n.field.canonicalString()} ${n.op} ${Wi(n.value)}`}(t):t instanceof pe?function(n){return n.op.toString()+" {"+n.getFilters().map(iI).join(" ,")+"}"}(t):"Filter"}class aC extends ae{constructor(e,n,r){super(e,n,r),this.key=G.fromName(r.referenceValue)}matches(e){const n=G.comparator(e.key,this.key);return this.matchesComparison(n)}}class lC extends ae{constructor(e,n){super(e,"in",n),this.keys=oI("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class cC extends ae{constructor(e,n){super(e,"not-in",n),this.keys=oI("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function oI(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>G.fromName(r.referenceValue))}class uC extends ae{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return qa(n)&&Ba(n.arrayValue,this.value)}}class aI extends ae{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ba(this.value.arrayValue,n)}}class dC extends ae{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ba(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Ba(this.value.arrayValue,n)}}class hC extends ae{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!qa(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ba(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function Qf(t,e=null,n=[],r=[],s=null,i=null,o=null){return new fC(t,e,n,r,s,i,o)}function Vs(t){const e=H(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Hf(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),nd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Wi(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Wi(r)).join(",")),e.ue=n}return e.ue}function cl(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!oC(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!rI(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!d0(t.startAt,e.startAt)&&d0(t.endAt,e.endAt)}function fu(t){return G.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function pu(t,e){return t.filters.filter(n=>n instanceof ae&&n.field.isEqual(e))}function h0(t,e,n){let r=Sc,s=!0;for(const i of pu(t,e)){let o=Sc,a=!0;switch(i.op){case"<":case"<=":o=sC(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Sc}l0({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];l0({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function f0(t,e,n){let r=Sr,s=!0;for(const i of pu(t,e)){let o=Sr,a=!0;switch(i.op){case">=":case">":o=iC(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Sr}c0({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];c0({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function lI(t,e,n,r,s,i,o,a){return new co(t,e,n,r,s,i,o,a)}function ul(t){return new co(t)}function p0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function cI(t){return t.collectionGroup!==null}function ua(t){const e=H(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new ge(Ae.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Ka(i,r))}),n.has(Ae.keyField().canonicalString())||e.ce.push(new Ka(Ae.keyField(),r))}return e.ce}function zt(t){const e=H(t);return e.le||(e.le=uI(e,ua(t))),e.le}function pC(t){const e=H(t);return e.he||(e.he=uI(e,t.explicitOrderBy)),e.he}function uI(t,e){if(t.limitType==="F")return Qf(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Ka(s.field,i)});const n=t.endAt?new Hi(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Hi(t.startAt.position,t.startAt.inclusive):null;return Qf(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Jf(t,e){const n=t.filters.concat([e]);return new co(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Yf(t,e,n){return new co(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function sd(t,e){return cl(zt(t),zt(e))&&t.limitType===e.limitType}function dI(t){return`${Vs(zt(t))}|lt:${t.limitType}`}function ui(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>iI(s)).join(", ")}]`),nd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Wi(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Wi(s)).join(",")),`Target(${r})`}(zt(t))}; limitType=${t.limitType})`}function dl(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):G.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of ua(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const d=u0(o,a,l);return o.inclusive?d<=0:d<0}(r.startAt,ua(r),s)||r.endAt&&!function(o,a,l){const d=u0(o,a,l);return o.inclusive?d>=0:d>0}(r.endAt,ua(r),s))}(t,e)}function hI(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function fI(t){return(e,n)=>{let r=!1;for(const s of ua(t)){const i=mC(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function mC(t,e,n){const r=t.field.isKeyField()?G.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),d=a.data.field(i);return l!==null&&d!==null?$r(l,d):Q()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Q()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Hs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return JE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gC=new xe(G.comparator);function Ft(){return gC}const pI=new xe(G.comparator);function Qo(...t){let e=pI;for(const n of t)e=e.insert(n.key,n);return e}function mI(t){let e=pI;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function _n(){return da()}function gI(){return da()}function da(){return new Zr(t=>t.toString(),(t,e)=>t.isEqual(e))}const yC=new xe(G.comparator),vC=new ge(G.comparator);function se(...t){let e=vC;for(const n of t)e=e.add(n);return e}const _C=new ge(te);function Tm(){return _C}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sm(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ua(e)?"-0":e}}function yI(t){return{integerValue:""+t}}function wC(t,e){return KE(e)?yI(e):Sm(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(){this._=void 0}}function xC(t,e,n){return t instanceof Ji?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&xm(i)&&(i=Em(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof Os?_I(t,e):t instanceof Ms?wI(t,e):function(s,i){const o=vI(s,i),a=m0(o)+m0(s.Pe);return Gf(o)&&Gf(s.Pe)?yI(a):Sm(s.serializer,a)}(t,e)}function EC(t,e,n){return t instanceof Os?_I(t,e):t instanceof Ms?wI(t,e):n}function vI(t,e){return t instanceof Ga?function(r){return Gf(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Ji extends id{}class Os extends id{constructor(e){super(),this.elements=e}}function _I(t,e){const n=xI(e);for(const r of t.elements)n.some(s=>kn(s,r))||n.push(r);return{arrayValue:{values:n}}}class Ms extends id{constructor(e){super(),this.elements=e}}function wI(t,e){let n=xI(e);for(const r of t.elements)n=n.filter(s=>!kn(s,r));return{arrayValue:{values:n}}}class Ga extends id{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function m0(t){return Se(t.integerValue||t.doubleValue)}function xI(t){return qa(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e,n){this.field=e,this.transform=n}}function IC(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Os&&s instanceof Os||r instanceof Ms&&s instanceof Ms?Gi(r.elements,s.elements,kn):r instanceof Ga&&s instanceof Ga?kn(r.Pe,s.Pe):r instanceof Ji&&s instanceof Ji}(t.transform,e.transform)}class TC{constructor(e,n){this.version=e,this.transformResults=n}}class ft{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ft}static exists(e){return new ft(void 0,e)}static updateTime(e){return new ft(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function bc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ad{}function EI(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ld(t.key,ft.none()):new uo(t.key,t.data,ft.none());{const n=t.data,r=ht.empty();let s=new ge(Ae.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new tr(t.key,r,new Nt(s.toArray()),ft.none())}}function SC(t,e,n){t instanceof uo?function(s,i,o){const a=s.value.clone(),l=y0(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof tr?function(s,i,o){if(!bc(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=y0(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(II(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function ha(t,e,n,r){return t instanceof uo?function(i,o,a,l){if(!bc(i.precondition,o))return a;const d=i.value.clone(),h=v0(i.fieldTransforms,l,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof tr?function(i,o,a,l){if(!bc(i.precondition,o))return a;const d=v0(i.fieldTransforms,l,o),h=o.data;return h.setAll(II(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(i,o,a){return bc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function kC(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=vI(r.transform,s||null);i!=null&&(n===null&&(n=ht.empty()),n.set(r.field,i))}return n||null}function g0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Gi(r,s,(i,o)=>IC(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class uo extends ad{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class tr extends ad{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function II(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function y0(t,e,n){const r=new Map;Y(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,EC(o,a,n[s]))}return r}function v0(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,xC(i,o,e))}return r}class ld extends ad{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class TI extends ad{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&SC(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ha(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ha(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=gI();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=EI(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(X.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),se())}isEqual(e){return this.batchId===e.batchId&&Gi(this.mutations,e.mutations,(n,r)=>g0(n,r))&&Gi(this.baseMutations,e.baseMutations,(n,r)=>g0(n,r))}}class bm{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Y(e.mutations.length===r.length);let s=function(){return yC}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new bm(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ze,ce;function RC(t){switch(t){default:return Q();case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0}}function SI(t){if(t===void 0)return Fe("GRPC error has no .code"),U.UNKNOWN;switch(t){case ze.OK:return U.OK;case ze.CANCELLED:return U.CANCELLED;case ze.UNKNOWN:return U.UNKNOWN;case ze.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case ze.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case ze.INTERNAL:return U.INTERNAL;case ze.UNAVAILABLE:return U.UNAVAILABLE;case ze.UNAUTHENTICATED:return U.UNAUTHENTICATED;case ze.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case ze.NOT_FOUND:return U.NOT_FOUND;case ze.ALREADY_EXISTS:return U.ALREADY_EXISTS;case ze.PERMISSION_DENIED:return U.PERMISSION_DENIED;case ze.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case ze.ABORTED:return U.ABORTED;case ze.OUT_OF_RANGE:return U.OUT_OF_RANGE;case ze.UNIMPLEMENTED:return U.UNIMPLEMENTED;case ze.DATA_LOSS:return U.DATA_LOSS;default:return Q()}}(ce=ze||(ze={}))[ce.OK=0]="OK",ce[ce.CANCELLED=1]="CANCELLED",ce[ce.UNKNOWN=2]="UNKNOWN",ce[ce.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ce[ce.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ce[ce.NOT_FOUND=5]="NOT_FOUND",ce[ce.ALREADY_EXISTS=6]="ALREADY_EXISTS",ce[ce.PERMISSION_DENIED=7]="PERMISSION_DENIED",ce[ce.UNAUTHENTICATED=16]="UNAUTHENTICATED",ce[ce.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ce[ce.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ce[ce.ABORTED=10]="ABORTED",ce[ce.OUT_OF_RANGE=11]="OUT_OF_RANGE",ce[ce.UNIMPLEMENTED=12]="UNIMPLEMENTED",ce[ce.INTERNAL=13]="INTERNAL",ce[ce.UNAVAILABLE=14]="UNAVAILABLE",ce[ce.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NC(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC=new Is([4294967295,4294967295],0);function _0(t){const e=NC().encode(t),n=new PE;return n.update(e),new Uint8Array(n.digest())}function w0(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Is([n,r],0),new Is([s,i],0)]}class Rm{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Jo(`Invalid padding: ${n}`);if(r<0)throw new Jo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Jo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Jo(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Is.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Is.fromNumber(r)));return s.compare(CC)===1&&(s=new Is([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=_0(e),[r,s]=w0(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Rm(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const n=_0(e),[r,s]=w0(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Jo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,fl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new hl(X.min(),s,new xe(te),Ft(),se())}}class fl{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new fl(r,n,se(),se(),se())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class kI{constructor(e,n){this.targetId=e,this.me=n}}class bI{constructor(e,n,r=Ue.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class x0{constructor(){this.fe=0,this.ge=I0(),this.pe=Ue.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=se(),n=se(),r=se();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:Q()}}),new fl(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=I0()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Y(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class PC{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ft(),this.qe=E0(),this.Qe=new xe(te)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:Q()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(fu(i))if(r===0){const o=new G(i.path);this.Ue(n,o,Ve.newNoDocument(o,X.min()))}else Y(r===1);else{const o=this.Ye(n);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(n);const d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,d)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=Br(r).toUint8Array()}catch(l){if(l instanceof YE)return Ma("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Rm(o,s,i)}catch(l){return Ma(l instanceof Jo?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&fu(a.target)){const l=new G(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,Ve.newNoDocument(l,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=se();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const d=this.Je(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new hl(e,n,this.Qe,this.ke,r);return this.ke=Ft(),this.qe=E0(),this.Qe=new xe(te),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new x0,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new ge(te),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||z("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new x0),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function E0(){return new xe(G.comparator)}function I0(){return new xe(G.comparator)}const DC={asc:"ASCENDING",desc:"DESCENDING"},jC={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},VC={and:"AND",or:"OR"};class OC{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Xf(t,e){return t.useProto3Json||nd(e)?e:{value:e}}function Yi(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function AI(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function MC(t,e){return Yi(t,e.toTimestamp())}function xt(t){return Y(!!t),X.fromTimestamp(function(n){const r=Xn(n);return new Ne(r.seconds,r.nanos)}(t))}function Nm(t,e){return Zf(t,e).canonicalString()}function Zf(t,e){const n=function(s){return new fe(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function RI(t){const e=fe.fromString(t);return Y(MI(e)),e}function mu(t,e){return Nm(t.databaseId,e.path)}function Ts(t,e){const n=RI(e);if(n.get(1)!==t.databaseId.projectId)throw new $(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new $(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new G(PI(n))}function NI(t,e){return Nm(t.databaseId,e)}function CI(t){const e=RI(t);return e.length===4?fe.emptyPath():PI(e)}function ep(t){return new fe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function PI(t){return Y(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function T0(t,e,n){return{name:mu(t,e),fields:n.value.mapValue.fields}}function LC(t,e,n){const r=Ts(t,e.name),s=xt(e.updateTime),i=e.createTime?xt(e.createTime):X.min(),o=new ht({mapValue:{fields:e.fields}}),a=Ve.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function FC(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Q()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(Y(h===void 0||typeof h=="string"),Ue.fromBase64String(h||"")):(Y(h===void 0||h instanceof Buffer||h instanceof Uint8Array),Ue.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?U.UNKNOWN:SI(d.code);return new $(h,d.message||"")}(o);n=new bI(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ts(t,r.document.name),i=xt(r.document.updateTime),o=r.document.createTime?xt(r.document.createTime):X.min(),a=new ht({mapValue:{fields:r.document.fields}}),l=Ve.newFoundDocument(s,i,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new Ac(d,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ts(t,r.document),i=r.readTime?xt(r.readTime):X.min(),o=Ve.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Ac([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ts(t,r.document),i=r.removedTargetIds||[];n=new Ac([],i,s,null)}else{if(!("filter"in e))return Q();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new AC(s,i),a=r.targetId;n=new kI(a,o)}}return n}function gu(t,e){let n;if(e instanceof uo)n={update:T0(t,e.key,e.value)};else if(e instanceof ld)n={delete:mu(t,e.key)};else if(e instanceof tr)n={update:T0(t,e.key,e.data),updateMask:GC(e.fieldMask)};else{if(!(e instanceof TI))return Q();n={verify:mu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Ji)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Os)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ms)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ga)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw Q()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:MC(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Q()}(t,e.precondition)),n}function tp(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?ft.updateTime(xt(i.updateTime)):i.exists!==void 0?ft.exists(i.exists):ft.none()}(e.currentDocument):ft.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)Y(a.setToServerValue==="REQUEST_TIME"),l=new Ji;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];l=new Os(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];l=new Ms(h)}else"increment"in a?l=new Ga(o,a.increment):Q();const d=Ae.fromServerFormat(a.fieldPath);return new od(d,l)}(t,s)):[];if(e.update){e.update.name;const s=Ts(t,e.update.name),i=new ht({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const d=l.fieldPaths||[];return new Nt(d.map(h=>Ae.fromServerFormat(h)))}(e.updateMask);return new tr(s,i,o,n,r)}return new uo(s,i,n,r)}if(e.delete){const s=Ts(t,e.delete);return new ld(s,n)}if(e.verify){const s=Ts(t,e.verify);return new TI(s,n)}return Q()}function UC(t,e){return t&&t.length>0?(Y(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?xt(s.updateTime):xt(i);return o.isEqual(X.min())&&(o=xt(i)),new TC(o,s.transformResults||[])}(n,e))):[]}function DI(t,e){return{documents:[NI(t,e.path)]}}function Cm(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=NI(t,s);const i=function(d){if(d.length!==0)return OI(pe.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(g){return{field:gr(g.field),direction:$C(g.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Xf(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:n,parent:s}}function zC(t,e,n,r){const{_t:s,parent:i}=Cm(t,e),o={},a=[];let l=0;return n.forEach(d=>{const h="aggregate_"+l++;o[h]=d.alias,d.aggregateType==="count"?a.push({alias:h,count:{}}):d.aggregateType==="avg"?a.push({alias:h,avg:{field:gr(d.fieldPath)}}):d.aggregateType==="sum"&&a.push({alias:h,sum:{field:gr(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},ut:o,parent:i}}function jI(t){let e=CI(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Y(r===1);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(p){const g=VI(p);return g instanceof pe&&Im(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(g=>function(T){return new Ka(di(T.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(g))}(n.orderBy));let a=null;n.limit&&(a=function(p){let g;return g=typeof p=="object"?p.value:p,nd(g)?null:g}(n.limit));let l=null;n.startAt&&(l=function(p){const g=!!p.before,v=p.values||[];return new Hi(v,g)}(n.startAt));let d=null;return n.endAt&&(d=function(p){const g=!p.before,v=p.values||[];return new Hi(v,g)}(n.endAt)),lI(e,s,o,i,a,"F",l,d)}function BC(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Q()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function VI(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=di(n.unaryFilter.field);return ae.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=di(n.unaryFilter.field);return ae.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=di(n.unaryFilter.field);return ae.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=di(n.unaryFilter.field);return ae.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Q()}}(t):t.fieldFilter!==void 0?function(n){return ae.create(di(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Q()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return pe.create(n.compositeFilter.filters.map(r=>VI(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Q()}}(n.compositeFilter.op))}(t):Q()}function $C(t){return DC[t]}function qC(t){return jC[t]}function KC(t){return VC[t]}function gr(t){return{fieldPath:t.canonicalString()}}function di(t){return Ae.fromServerFormat(t.fieldPath)}function OI(t){return t instanceof ae?function(n){if(n.op==="=="){if(a0(n.value))return{unaryFilter:{field:gr(n.field),op:"IS_NAN"}};if(o0(n.value))return{unaryFilter:{field:gr(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(a0(n.value))return{unaryFilter:{field:gr(n.field),op:"IS_NOT_NAN"}};if(o0(n.value))return{unaryFilter:{field:gr(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:gr(n.field),op:qC(n.op),value:n.value}}}(t):t instanceof pe?function(n){const r=n.getFilters().map(s=>OI(s));return r.length===1?r[0]:{compositeFilter:{op:KC(n.op),filters:r}}}(t):Q()}function GC(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function MI(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e,n,r,s,i=X.min(),o=X.min(),a=Ue.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new zn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new zn(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new zn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new zn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LI{constructor(e){this.ct=e}}function WC(t,e){let n;if(e.document)n=LC(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=G.fromSegments(e.noDocument.path),s=Fs(e.noDocument.readTime);n=Ve.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Q();{const r=G.fromSegments(e.unknownDocument.path),s=Fs(e.unknownDocument.version);n=Ve.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new Ne(s[0],s[1]);return X.fromTimestamp(i)}(e.readTime)),n}function S0(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:yu(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:mu(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Yi(i,o.version.toTimestamp()),createTime:Yi(i,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ls(e.version)};else{if(!e.isUnknownDocument())return Q();r.unknownDocument={path:n.path.toArray(),version:Ls(e.version)}}return r}function yu(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ls(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Fs(t){const e=new Ne(t.seconds,t.nanoseconds);return X.fromTimestamp(e)}function fs(t,e){const n=(e.baseMutations||[]).map(i=>tp(t.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>tp(t.ct,i)),s=Ne.fromMillis(e.localWriteTimeMs);return new km(e.batchId,s,n,r)}function Yo(t){const e=Fs(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Fs(t.lastLimboFreeSnapshotVersion):X.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){return Y(i.documents.length===1),zt(ul(CI(i.documents[0])))}(t.query):function(i){return zt(jI(i))}(t.query),new zn(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Ue.fromBase64String(t.resumeToken))}function FI(t,e){const n=Ls(e.snapshotVersion),r=Ls(e.lastLimboFreeSnapshotVersion);let s;s=fu(e.target)?DI(t.ct,e.target):Cm(t.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Vs(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function UI(t){const e=jI({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Yf(e,e.limit,"L"):e}function Ph(t,e){return new Am(e.largestBatchId,tp(t.ct,e.overlayMutation))}function k0(t,e){const n=e.path.lastSegment();return[t,wt(e.path.popLast()),n]}function b0(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Ls(r.readTime),documentKey:wt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{getBundleMetadata(e,n){return A0(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Fs(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return A0(e).put(function(s){return{bundleId:s.id,createTime:Ls(xt(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return R0(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:UI(i.bundledQuery),readTime:Fs(i.readTime)}}(r)})}saveNamedQuery(e,n){return R0(e).put(function(s){return{name:s.name,readTime:Ls(xt(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function A0(t){return He(t,"bundles")}function R0(t){return He(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new cd(e,r)}getOverlay(e,n){return Mo(e).get(k0(this.userId,n)).next(r=>r?Ph(this.serializer,r):null)}getOverlays(e,n){const r=_n();return V.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new Am(n,o);s.push(this.ht(e,a))}),V.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(wt(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Mo(e).j("collectionPathOverlayIndex",a))}),V.waitFor(i)}getOverlaysForCollection(e,n,r){const s=_n(),i=wt(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Mo(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const d=Ph(this.serializer,l);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=_n();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Mo(e).J({index:"collectionGroupOverlayIndex",range:a},(l,d,h)=>{const p=Ph(this.serializer,d);i.size()<s||p.largestBatchId===o?(i.set(p.getKey(),p),o=p.largestBatchId):h.done()}).next(()=>i)}ht(e,n){return Mo(e).put(function(s,i,o){const[a,l,d]=k0(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:gu(s.ct,o.mutation)}}(this.serializer,this.userId,n))}}function Mo(t){return He(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{Pt(e){return He(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Ue.fromUint8Array(r):Ue.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(Se(e.integerValue));else if("doubleValue"in e){const r=Se(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),Ua(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=Xn(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(Br(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?XE(e)?this.dt(n,Number.MAX_SAFE_INTEGER):rd(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):Q()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const s of Object.keys(r))this.Vt(s,n),this.Tt(r[s],n)}wt(e,n){var r,s;const i=e.fields||{};this.dt(n,53);const o="value",a=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(n,15),n.At(Se(a)),this.Vt(o,n),this.Tt(i[o],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const s of r)this.Tt(s,n)}yt(e,n){this.dt(n,37),G.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}ps.vt=new ps;function JC(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function N0(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=JC(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class YC{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=n.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=n.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const n=this.qt(e),r=N0(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}Kt(e){const n=this.qt(e),r=N0(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class XC{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class ZC{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Lo{constructor(){this.jt=new YC,this.Ht=new XC(this.jt),this.Jt=new ZC(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e,n,r,s){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=s}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new ms(this.indexId,this.documentKey,this.arrayValue,r)}}function ar(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=C0(t.arrayValue,e.arrayValue),n!==0?n:(n=C0(t.directionalValue,e.directionalValue),n!==0?n:G.comparator(t.documentKey,e.documentKey)))}function C0(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(e){this.Xt=new ge((n,r)=>Ae.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Y(e.collectionGroup===this.collectionId),this.nn)return!1;const n=$f(e);if(n!==void 0&&!this.sn(n))return!1;const r=ds(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.on(a,l)||!this._n(this.en[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new ge(Ae.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Ic(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Ic(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Ic(r.field,r.dir==="asc"?0:1)));return new hu(hu.UNKNOWN_ID,this.collectionId,n,Fa.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zI(t){var e,n;if(Y(t instanceof ae||t instanceof pe),t instanceof ae){if(t instanceof aI){const s=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(i=>ae.create(t.field,"==",i)))||[];return pe.create(s,"or")}return t}const r=t.filters.map(s=>zI(s));return pe.create(r,t.op)}function eP(t){if(t.getFilters().length===0)return[];const e=sp(zI(t));return Y(BI(e)),np(e)||rp(e)?[e]:e.getFilters()}function np(t){return t instanceof ae}function rp(t){return t instanceof pe&&Im(t)}function BI(t){return np(t)||rp(t)||function(n){if(n instanceof pe&&Wf(n)){for(const r of n.getFilters())if(!np(r)&&!rp(r))return!1;return!0}return!1}(t)}function sp(t){if(Y(t instanceof ae||t instanceof pe),t instanceof ae)return t;if(t.filters.length===1)return sp(t.filters[0]);const e=t.filters.map(r=>sp(r));let n=pe.create(e,t.op);return n=vu(n),BI(n)?n:(Y(n instanceof pe),Y(Qi(n)),Y(n.filters.length>1),n.filters.reduce((r,s)=>Pm(r,s)))}function Pm(t,e){let n;return Y(t instanceof ae||t instanceof pe),Y(e instanceof ae||e instanceof pe),n=t instanceof ae?e instanceof ae?function(s,i){return pe.create([s,i],"and")}(t,e):D0(t,e):e instanceof ae?D0(e,t):function(s,i){if(Y(s.filters.length>0&&i.filters.length>0),Qi(s)&&Qi(i))return sI(s,i.getFilters());const o=Wf(s)?s:i,a=Wf(s)?i:s,l=o.filters.map(d=>Pm(d,a));return pe.create(l,"or")}(t,e),vu(n)}function D0(t,e){if(Qi(e))return sI(e,t.getFilters());{const n=e.filters.map(r=>Pm(t,r));return pe.create(n,"or")}}function vu(t){if(Y(t instanceof ae||t instanceof pe),t instanceof ae)return t;const e=t.getFilters();if(e.length===1)return vu(e[0]);if(nI(t))return t;const n=e.map(s=>vu(s)),r=[];return n.forEach(s=>{s instanceof ae?r.push(s):s instanceof pe&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:pe.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(){this.un=new Dm}addToCollectionParentIndex(e,n){return this.un.add(n),V.resolve()}getCollectionParents(e,n){return V.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return V.resolve()}deleteFieldIndex(e,n){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,n){return V.resolve()}getDocumentsMatchingTarget(e,n){return V.resolve(null)}getIndexType(e,n){return V.resolve(0)}getFieldIndexes(e,n){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,n){return V.resolve($t.min())}getMinOffsetFromCollectionGroup(e,n){return V.resolve($t.min())}updateCollectionGroup(e,n,r){return V.resolve()}updateIndexEntries(e,n){return V.resolve()}}class Dm{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new ge(fe.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ge(fe.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sc=new Uint8Array(0);class nP{constructor(e,n){this.databaseId=n,this.cn=new Dm,this.ln=new Zr(r=>Vs(r),(r,s)=>cl(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const i={collectionId:r,parent:wt(s)};return j0(e).put(i)}return V.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[FE(n),""],!1,!0);return j0(e).U(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(vn(o.parent))}return r})}addFieldIndex(e,n){const r=Fo(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=oi(e);return i.next(a=>{o.put(b0(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=Fo(e),s=oi(e),i=ii(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Fo(e),r=ii(e),s=oi(e);return n.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,n){return V.forEach(this.hn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new P0(r).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=ii(e);let s=!0;const i=new Map;return V.forEach(this.hn(n),o=>this.Pn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=se();const a=[];return V.forEach(i,(l,d)=>{z("IndexedDbIndexManager",`Using index ${function(I){return`id=${I.indexId}|cg=${I.collectionGroup}|f=${I.fields.map(P=>`${P.fieldPath}:${P.kind}`).join(",")}`}(l)} to execute ${Vs(n)}`);const h=function(I,P){const O=$f(P);if(O===void 0)return null;for(const L of pu(I,O.fieldPath))switch(L.op){case"array-contains-any":return L.value.arrayValue.values||[];case"array-contains":return[L.value]}return null}(d,l),p=function(I,P){const O=new Map;for(const L of ds(P))for(const S of pu(I,L.fieldPath))switch(S.op){case"==":case"in":O.set(L.fieldPath.canonicalString(),S.value);break;case"not-in":case"!=":return O.set(L.fieldPath.canonicalString(),S.value),Array.from(O.values())}return null}(d,l),g=function(I,P){const O=[];let L=!0;for(const S of ds(P)){const x=S.kind===0?h0(I,S.fieldPath,I.startAt):f0(I,S.fieldPath,I.startAt);O.push(x.value),L&&(L=x.inclusive)}return new Hi(O,L)}(d,l),v=function(I,P){const O=[];let L=!0;for(const S of ds(P)){const x=S.kind===0?f0(I,S.fieldPath,I.endAt):h0(I,S.fieldPath,I.endAt);O.push(x.value),L&&(L=x.inclusive)}return new Hi(O,L)}(d,l),T=this.In(l,d,g),b=this.In(l,d,v),E=this.Tn(l,d,p),_=this.En(l.indexId,h,T,g.inclusive,b,v.inclusive,E);return V.forEach(_,y=>r.G(y,n.limit).next(I=>{I.forEach(P=>{const O=G.fromSegments(P.documentKey);o.has(O)||(o=o.add(O),a.push(O))})}))}).next(()=>a)}return V.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=eP(pe.create(e.filters,"and")).map(r=>Qf(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,s,i,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,i.length),d=l/(n!=null?n.length:1),h=[];for(let p=0;p<l;++p){const g=n?this.dn(n[p/d]):sc,v=this.An(e,g,r[p%d],s),T=this.Rn(e,g,i[p%d],o),b=a.map(E=>this.An(e,g,E,!0));h.push(...this.createRange(v,T,b))}return h}An(e,n,r,s){const i=new ms(e,G.empty(),n,r);return s?i:i.Zt()}Rn(e,n,r,s){const i=new ms(e,G.empty(),n,r);return s?i.Zt():i}Pn(e,n){const r=new P0(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.hn(n);return V.forEach(s,i=>this.Pn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let d=new ge(Ae.comparator),h=!1;for(const p of l.filters)for(const g of p.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?h=!0:d=d.add(g.field));for(const p of l.orderBy)p.field.isKeyField()||(d=d.add(p.field));return d.size+(h?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}Vn(e,n){const r=new Lo;for(const s of ds(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Yt(s.kind);ps.vt.It(i,o)}return r.zt()}dn(e){const n=new Lo;return ps.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new Lo;return ps.vt.It($a(this.databaseId,n),r.Yt(function(i){const o=ds(i);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let s=[];s.push(new Lo);let i=0;for(const o of ds(e)){const a=r[i++];for(const l of s)if(this.fn(n,o.fieldPath)&&qa(a))s=this.gn(s,o,a);else{const d=l.Yt(o.kind);ps.vt.It(a,d)}}return this.pn(s)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new Lo;l.seed(a.zt()),ps.vt.It(o,l.Yt(n.kind)),i.push(l)}return i}fn(e,n){return!!e.filters.find(r=>r instanceof ae&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Fo(e),s=oi(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(i=>{const o=[];return V.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(h,p){const g=p?new Fa(p.sequenceNumber,new $t(Fs(p.readTime),new G(vn(p.documentKey)),p.largestBatchId)):Fa.empty(),v=h.fields.map(([T,b])=>new Ic(Ae.fromServerFormat(T),b));return new hu(h.indexId,h.collectionGroup,v,g)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:te(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=Fo(e),i=oi(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>V.forEach(a,l=>i.put(b0(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return V.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?V.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),V.forEach(a,l=>this.wn(e,s,l).next(d=>{const h=this.Sn(i,l);return d.isEqual(h)?V.resolve():this.bn(e,i,l,d,h)}))))})}Dn(e,n,r,s){return ii(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,s){return ii(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const s=ii(e);let i=new ge(ar);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(o,a)=>{i=i.add(new ms(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>i)}Sn(e,n){let r=new ge(ar);const s=this.Vn(n,e);if(s==null)return r;const i=$f(n);if(i!=null){const o=e.data.field(i.fieldPath);if(qa(o))for(const a of o.arrayValue.values||[])r=r.add(new ms(n.indexId,e.key,this.dn(a),s))}else r=r.add(new ms(n.indexId,e.key,sc,s));return r}bn(e,n,r,s,i){z("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(l,d,h,p,g){const v=l.getIterator(),T=d.getIterator();let b=si(v),E=si(T);for(;b||E;){let _=!1,y=!1;if(b&&E){const I=h(b,E);I<0?y=!0:I>0&&(_=!0)}else b!=null?y=!0:_=!0;_?(p(E),E=si(T)):y?(g(b),b=si(v)):(b=si(v),E=si(T))}}(s,i,ar,a=>{o.push(this.Dn(e,n,r,a))},a=>{o.push(this.vn(e,n,r,a))}),V.waitFor(o)}yn(e){let n=1;return oi(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>ar(o,a)).filter((o,a,l)=>!a||ar(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=ar(o,e),l=ar(o,n);if(a===0)s[0]=e.Zt();else if(a>0&&l<0)s.push(o),s.push(o.Zt());else if(l>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const a=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,sc,[]],l=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,sc,[]];i.push(IDBKeyRange.bound(a,l))}return i}Cn(e,n){return ar(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(V0)}getMinOffset(e,n){return V.mapArray(this.hn(n),r=>this.Pn(e,r).next(s=>s||Q())).next(V0)}}function j0(t){return He(t,"collectionParents")}function ii(t){return He(t,"indexEntries")}function Fo(t){return He(t,"indexConfiguration")}function oi(t){return He(t,"indexState")}function V0(t){Y(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;vm(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new $t(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Tt{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Tt(e,Tt.DEFAULT_COLLECTION_PERCENTILE,Tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $I(t,e,n){const r=t.store("mutations"),s=t.store("documentMutations"),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.J({range:o},(h,p,g)=>(a++,g.delete()));i.push(l.next(()=>{Y(a===1)}));const d=[];for(const h of n.mutations){const p=GE(e,h.key.path,n.batchId);i.push(s.delete(p)),d.push(h.key)}return V.waitFor(i).next(()=>d)}function _u(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Q();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tt.DEFAULT_COLLECTION_PERCENTILE=10,Tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Tt.DEFAULT=new Tt(41943040,Tt.DEFAULT_COLLECTION_PERCENTILE,Tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Tt.DISABLED=new Tt(-1,0,0);class ud{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(e,n,r,s){Y(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new ud(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return lr(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=hi(e),o=lr(e);return o.add({}).next(a=>{Y(typeof a=="number");const l=new km(a,n,r,s),d=function(v,T,b){const E=b.baseMutations.map(y=>gu(v.ct,y)),_=b.mutations.map(y=>gu(v.ct,y));return{userId:T,batchId:b.batchId,localWriteTimeMs:b.localWriteTime.toMillis(),baseMutations:E,mutations:_}}(this.serializer,this.userId,l),h=[];let p=new ge((g,v)=>te(g.canonicalString(),v.canonicalString()));for(const g of s){const v=GE(this.userId,g.key.path,a);p=p.add(g.key.path.popLast()),h.push(o.put(d)),h.push(i.put(v,MN))}return p.forEach(g=>{h.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Fn[a]=l.keys()}),V.waitFor(h).next(()=>l)})}lookupMutationBatch(e,n){return lr(e).get(n).next(r=>r?(Y(r.userId===this.userId),fs(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?V.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Fn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return lr(e).J({index:"userMutationsIndex",range:s},(o,a,l)=>{a.userId===this.userId&&(Y(a.batchId>=r),i=fs(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return lr(e).J({index:"userMutationsIndex",range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return lr(e).U("userMutationsIndex",n).next(r=>r.map(s=>fs(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Tc(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return hi(e).J({range:s},(o,a,l)=>{const[d,h,p]=o,g=vn(h);if(d===this.userId&&n.path.isEqual(g))return lr(e).get(p).next(v=>{if(!v)throw Q();Y(v.userId===this.userId),i.push(fs(this.serializer,v))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ge(te);const s=[];return n.forEach(i=>{const o=Tc(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=hi(e).J({range:a},(d,h,p)=>{const[g,v,T]=d,b=vn(v);g===this.userId&&i.path.isEqual(b)?r=r.add(T):p.done()});s.push(l)}),V.waitFor(s).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Tc(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new ge(te);return hi(e).J({range:o},(l,d,h)=>{const[p,g,v]=l,T=vn(g);p===this.userId&&r.isPrefixOf(T)?T.length===s&&(a=a.add(v)):h.done()}).next(()=>this.xn(e,a))}xn(e,n){const r=[],s=[];return n.forEach(i=>{s.push(lr(e).get(i).next(o=>{if(o===null)throw Q();Y(o.userId===this.userId),r.push(fs(this.serializer,o))}))}),V.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return $I(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),V.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return V.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return hi(e).J({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=vn(i[1]);s.push(l)}else a.done()}).next(()=>{Y(s.length===0)})})}containsKey(e,n){return qI(e,this.userId,n)}Nn(e){return KI(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function qI(t,e,n){const r=Tc(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return hi(t).J({range:i,H:!0},(a,l,d)=>{const[h,p,g]=a;h===e&&p===s&&(o=!0),d.done()}).next(()=>o)}function lr(t){return He(t,"mutations")}function hi(t){return He(t,"documentMutations")}function KI(t){return He(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Us(0)}static kn(){return new Us(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new Us(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>X.fromTimestamp(new Ne(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.Qn(e,s)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>ai(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(Y(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return ai(e).J((o,a)=>{const l=Yo(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>V.waitFor(i)).next(()=>s)}forEachTarget(e,n){return ai(e).J((r,s)=>{const i=Yo(s);n(i)})}qn(e){return M0(e).get("targetGlobalKey").next(n=>(Y(n!==null),n))}Qn(e,n){return M0(e).put("targetGlobalKey",n)}Kn(e,n){return ai(e).put(FI(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Vs(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return ai(e).J({range:s,index:"queryTargetsIndex"},(o,a,l)=>{const d=Yo(a);cl(n,d.target)&&(i=d,l.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=yr(e);return n.forEach(o=>{const a=wt(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),V.waitFor(s)}removeMatchingKeys(e,n,r){const s=yr(e);return V.forEach(n,i=>{const o=wt(i.path);return V.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=yr(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=yr(e);let i=se();return s.J({range:r,H:!0},(o,a,l)=>{const d=vn(o[1]),h=new G(d);i=i.add(h)}).next(()=>i)}containsKey(e,n){const r=wt(n.path),s=IDBKeyRange.bound([r],[FE(r)],!1,!0);let i=0;return yr(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,a],l,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}ot(e,n){return ai(e).get(n).next(r=>r?Yo(r):null)}}function ai(t){return He(t,"targets")}function M0(t){return He(t,"targetGlobal")}function yr(t){return He(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L0([t,e],[n,r]){const s=te(t,n);return s===0?te(e,r):s}class sP{constructor(e){this.Un=e,this.buffer=new ge(L0),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();L0(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class iP{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){z("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Xr(n)?z("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await Yr(n)}await this.Hn(3e5)})}}class oP{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return V.resolve(Rt.oe);const r=new sP(n);return this.Jn.forEachTarget(e,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(z("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(O0)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(z("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),O0):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,s,i,o,a,l,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),s=this.params.maximumSequenceNumbersToCollect):s=p,o=Date.now(),this.nthSequenceNumber(e,s))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,n))).next(p=>(i=p,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(d=Date.now(),ci()<=oe.DEBUG&&z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${p} documents in `+(d-l)+`ms
Total Duration: ${d-h}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:p})))}}function aP(t,e){return new oP(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(e,n){this.db=e,this.garbageCollector=aP(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,s)=>n(s))}addReference(e,n,r){return ic(e,r)}removeReference(e,n,r){return ic(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return ic(e,n)}nr(e,n){return function(s,i){let o=!1;return KI(s).Y(a=>qI(s,a,i).next(l=>(l&&(o=!0),V.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(e,(o,a)=>{if(a<=n){const l=this.nr(e,o).next(d=>{if(!d)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,X.min()),yr(e).delete(function(p){return[0,wt(p.path)]}(o))))});s.push(l)}}).next(()=>V.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return ic(e,n)}tr(e,n){const r=yr(e);let s,i=Rt.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:d})=>{o===0?(i!==Rt.oe&&n(new G(vn(s)),i),i=d,s=l):i=Rt.oe}).next(()=>{i!==Rt.oe&&n(new G(vn(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ic(t,e){return yr(t).put(function(r,s){return{targetId:0,path:wt(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GI{constructor(){this.changes=new Zr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ve.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?V.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return as(e).put(r)}removeEntry(e,n,r){return as(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],yu(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=Ve.newInvalidDocument(n);return as(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Uo(n))},(s,i)=>{r=this.ir(n,i)}).next(()=>r)}sr(e,n){let r={size:0,document:Ve.newInvalidDocument(n)};return as(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Uo(n))},(s,i)=>{r={document:this.ir(n,i),size:_u(i)}}).next(()=>r)}getEntries(e,n){let r=Ft();return this._r(e,n,(s,i)=>{const o=this.ir(s,i);r=r.insert(s,o)}).next(()=>r)}ar(e,n){let r=Ft(),s=new xe(G.comparator);return this._r(e,n,(i,o)=>{const a=this.ir(i,o);r=r.insert(i,a),s=s.insert(i,_u(o))}).next(()=>({documents:r,ur:s}))}_r(e,n,r){if(n.isEmpty())return V.resolve();let s=new ge(z0);n.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(Uo(s.first()),Uo(s.last())),o=s.getIterator();let a=o.getNext();return as(e).J({index:"documentKeyIndex",range:i},(l,d,h)=>{const p=G.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&z0(a,p)<0;)r(a,null),a=o.getNext();a&&a.isEqual(p)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?h.$(Uo(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),yu(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return as(e).U(IDBKeyRange.bound(a,l,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let h=Ft();for(const p of d){const g=this.ir(G.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);g.isFoundDocument()&&(dl(n,g)||s.has(g.key))&&(h=h.insert(g.key,g))}return h})}getAllFromCollectionGroup(e,n,r,s){let i=Ft();const o=U0(n,r),a=U0(n,$t.max());return as(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,d,h)=>{const p=this.ir(G.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(p.key,p),i.size===s&&h.done()}).next(()=>i)}newChangeBuffer(e){return new uP(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return F0(e).get("remoteDocumentGlobalKey").next(n=>(Y(!!n),n))}rr(e,n){return F0(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=WC(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(X.min())))return r}return Ve.newInvalidDocument(e)}}function WI(t){return new cP(t)}class uP extends GI{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new Zr(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new ge((i,o)=>te(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.lr.get(i);if(n.push(this.cr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=S0(this.cr.serializer,o);s=s.add(i.path.popLast());const d=_u(l);r+=d-a.size,n.push(this.cr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=S0(this.cr.serializer,o.convertToNoDocument(X.min()));n.push(this.cr.addEntry(e,i,l))}}),s.forEach(i=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.cr.updateMetadata(e,r)),V.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:s})=>(s.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function F0(t){return He(t,"remoteDocumentGlobal")}function as(t){return He(t,"remoteDocumentsV14")}function Uo(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function U0(t,e){const n=e.documentKey.path.toArray();return[t,yu(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function z0(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=te(n[i],r[i]),s)return s;return s=te(n.length,r.length),s||(s=te(n[n.length-2],r[r.length-2]),s||te(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HI{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&ha(r.mutation,s,Nt.empty(),Ne.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,se()).next(()=>r))}getLocalViewOfDocuments(e,n,r=se()){const s=_n();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Qo();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=_n();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,se()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=Ft();const o=da(),a=function(){return da()}();return n.forEach((l,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof tr)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),ha(h.mutation,d,h.mutation.getFieldMask(),Ne.now())):o.set(d.key,Nt.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>{var p;return a.set(d,new dP(h,(p=o.get(d))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,n){const r=da();let s=new xe((o,a)=>o-a),i=se();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const d=n.get(l);if(d===null)return;let h=r.get(l)||Nt.empty();h=a.applyToLocalView(d,h),r.set(l,h);const p=(s.get(a.batchId)||se()).add(l);s=s.insert(a.batchId,p)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),d=l.key,h=l.value,p=gI();h.forEach(g=>{if(!i.has(g)){const v=EI(n.get(g),r.get(g));v!==null&&p.set(g,v),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return V.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return G.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):cI(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):V.resolve(_n());let a=-1,l=i;return o.next(d=>V.forEach(d,(h,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),i.get(h)?V.resolve():this.remoteDocumentCache.getEntry(e,h).next(g=>{l=l.insert(h,g)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,l,d,se())).next(h=>({batchId:a,changes:mI(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new G(n)).next(r=>{let s=Qo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Qo();return this.indexManager.getCollectionParents(e,i).next(a=>V.forEach(a,l=>{const d=function(p,g){return new co(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Ve.newInvalidDocument(h)))});let a=Qo();return o.forEach((l,d)=>{const h=i.get(l);h!==void 0&&ha(h.mutation,d,Nt.empty(),Ne.now()),dl(n,d)&&(a=a.insert(l,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hP{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return V.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:xt(s.createTime)}}(n)),V.resolve()}getNamedQuery(e,n){return V.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:UI(s.bundledQuery),readTime:xt(s.readTime)}}(n)),V.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{constructor(){this.overlays=new xe(G.comparator),this.Ir=new Map}getOverlay(e,n){return V.resolve(this.overlays.get(n))}getOverlays(e,n){const r=_n();return V.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),V.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),V.resolve()}getOverlaysForCollection(e,n,r){const s=_n(),i=n.length+1,o=new G(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,d=l.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return V.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new xe((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=_n(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=_n(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=s)););return V.resolve(a)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Am(n,r));let i=this.Ir.get(n);i===void 0&&(i=se(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(){this.sessionToken=Ue.EMPTY_BYTE_STRING}getSessionToken(e){return V.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,V.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(){this.Tr=new ge(Qe.Er),this.dr=new ge(Qe.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Qe(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Qe(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new G(new fe([])),r=new Qe(n,e),s=new Qe(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new G(new fe([])),r=new Qe(n,e),s=new Qe(n,e+1);let i=se();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Qe(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Qe{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return G.comparator(e.key,n.key)||te(e.wr,n.wr)}static Ar(e,n){return te(e.wr,n.wr)||G.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new ge(Qe.Er)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new km(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.br=this.br.add(new Qe(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return V.resolve(o)}lookupMutationBatch(e,n){return V.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return V.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Qe(n,0),s=new Qe(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const a=this.Dr(o.wr);i.push(a)}),V.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ge(te);return n.forEach(s=>{const i=new Qe(s,0),o=new Qe(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{r=r.add(a.wr)})}),V.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;G.isDocumentKey(i)||(i=i.child(""));const o=new Qe(new G(i),0);let a=new ge(te);return this.br.forEachWhile(l=>{const d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(l.wr)),!0)},o),V.resolve(this.Cr(a))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Y(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return V.forEach(n.mutations,s=>{const i=new Qe(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Qe(n,0),s=this.br.firstAfterOrEqual(r);return V.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP{constructor(e){this.Mr=e,this.docs=function(){return new xe(G.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return V.resolve(r?r.document.mutableCopy():Ve.newInvalidDocument(n))}getEntries(e,n){let r=Ft();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Ve.newInvalidDocument(s))}),V.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Ft();const o=n.path,a=new G(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:d,value:{document:h}}=l.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||vm(zE(h),r)<=0||(s.has(h.key)||dl(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return V.resolve(i)}getAllFromCollectionGroup(e,n,r,s){Q()}Or(e,n){return V.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new yP(this)}getSize(e){return V.resolve(this.size)}}class yP extends GI{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),V.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(e){this.persistence=e,this.Nr=new Zr(n=>Vs(n),cl),this.lastRemoteSnapshotVersion=X.min(),this.highestTargetId=0,this.Lr=0,this.Br=new jm,this.targetCount=0,this.kr=Us.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),V.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Us(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,V.resolve()}updateTargetData(e,n){return this.Kn(n),V.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),V.waitFor(i).next(()=>s)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return V.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),V.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),V.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),V.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return V.resolve(r)}containsKey(e,n){return V.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Rt(0),this.Kr=!1,this.Kr=!0,this.$r=new pP,this.referenceDelegate=e(this),this.Ur=new vP(this),this.indexManager=new tP,this.remoteDocumentCache=function(s){return new gP(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new LI(n),this.Gr=new hP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new fP,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new mP(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){z("MemoryPersistence","Starting transaction:",e);const s=new _P(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return V.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class _P extends $E{constructor(e){super(),this.currentSequenceNumber=e}}class dd{constructor(e){this.persistence=e,this.Jr=new jm,this.Yr=null}static Zr(e){return new dd(e)}get Xr(){if(this.Yr)return this.Yr;throw Q()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),V.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),V.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.Xr,r=>{const s=G.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,X.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return V.or([()=>V.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e){this.serializer=e}O(e,n,r,s){const i=new td("createOrUpgrade",n);r<1&&s>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",t0,{unique:!0}),l.createObjectStore("documentMutations")}(e),B0(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=V.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),B0(e)),o=o.next(()=>function(l){const d=l.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:X.min().toTimestamp(),targetCount:0};return d.put("targetGlobalKey",h)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,d){return d.store("mutations").U().next(h=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",t0,{unique:!0});const p=d.store("mutations"),g=h.map(v=>p.put(v));return V.waitFor(g)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.ni(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),r<7&&s>=7&&(o=o.next(()=>this.ii(i))),r<8&&s>=8&&(o=o.next(()=>this.si(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.oi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const d=l.createObjectStore("documentOverlays",{keyPath:QN});d.createIndex("collectionPathOverlayIndex",JN,{unique:!1}),d.createIndex("collectionGroupOverlayIndex",YN,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const d=l.createObjectStore("remoteDocumentsV14",{keyPath:LN});d.createIndex("documentKeyIndex",FN),d.createIndex("collectionGroupIndex",UN)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ai(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:KN}).createIndex("sequenceNumberIndex",GN,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:WN}).createIndex("documentKeyIndex",HN,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let n=0;return e.store("remoteDocuments").J((r,s)=>{n+=_u(s)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(s=>V.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>V.forEach(a,l=>{Y(l.userId===i.userId);const d=fs(this.serializer,l);return $I(e,i.userId,d).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,a)=>{const l=new fe(o),d=function(p){return[0,wt(p)]}(l);i.push(n.get(d).next(h=>h?V.resolve():(p=>n.put({targetId:0,path:wt(p),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>V.waitFor(i))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:qN});const r=n.store("collectionParents"),s=new Dm,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:wt(l)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new fe(o);return i(l.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,l],d)=>{const h=vn(a);return i(h.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,s)=>{const i=Yo(s),o=FI(this.serializer,i);return n.put(o)})}_i(e,n){const r=n.store("remoteDocuments"),s=[];return r.J((i,o)=>{const a=n.store("remoteDocumentsV14"),l=function(p){return p.document?new G(fe.fromString(p.document.name).popFirst(5)):p.noDocument?G.fromSegments(p.noDocument.path):p.unknownDocument?G.fromSegments(p.unknownDocument.path):Q()}(o).path.toArray(),d={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(d))}).next(()=>V.waitFor(s))}ai(e,n){const r=n.store("mutations"),s=WI(this.serializer),i=new QI(dd.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var d;let h=(d=a.get(l.userId))!==null&&d!==void 0?d:se();fs(this.serializer,l).keys().forEach(p=>h=h.add(p)),a.set(l.userId,h)}),V.forEach(a,(l,d)=>{const h=new ut(d),p=cd.lt(this.serializer,h),g=i.getIndexManager(h),v=ud.lt(h,this.serializer,g,i.referenceDelegate);return new HI(s,v,p,g).recalculateAndSaveOverlaysForDocumentKeys(new qf(n,Rt.oe),l).next()})})}}function B0(t){t.createObjectStore("targetDocuments",{keyPath:BN}).createIndex("documentTargetsIndex",$N,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",zN,{unique:!0}),t.createObjectStore("targetGlobal")}const Dh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Vm{constructor(e,n,r,s,i,o,a,l,d,h,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=i,this.window=o,this.document=a,this.ci=d,this.li=h,this.hi=p,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=g=>Promise.resolve(),!Vm.D())throw new $(U.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new lP(this,s),this.Ai=n+"main",this.serializer=new LI(l),this.Ri=new Or(this.Ai,this.hi,new wP(this.serializer)),this.$r=new QC,this.Ur=new rP(this.referenceDelegate,this.serializer),this.remoteDocumentCache=WI(this.serializer),this.Gr=new HC,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,h===!1&&Fe("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new $(U.FAILED_PRECONDITION,Dh);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Rt(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>oc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(Xr(e))return z("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return z("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return zo(e).get("owner").next(n=>V.resolve(this.vi(n)))}Ci(e){return oc(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=He(n,"clientMetadata");return r.U().next(s=>{const i=this.xi(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return V.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?V.resolve(!0):zo(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new $(U.FAILED_PRECONDITION,Dh);return!1}}return!(!this.networkEnabled||!this.inForeground)||oc(e).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&z("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new qf(e,Rt.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>oc(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return ud.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new nP(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return cd.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){z("IndexedDbPersistence","Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(l){return l===17?eC:l===16?ZN:l===15?wm:l===14?QE:l===13?HE:l===12?XN:l===11?WE:void Q()}(this.hi);let o;return this.Ri.runTransaction(e,s,i,a=>(o=new qf(a,this.Qr?this.Qr.next():Rt.oe),n==="readwrite-primary"?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw Fe(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new $(U.FAILED_PRECONDITION,BE);return r(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return zo(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new $(U.FAILED_PRECONDITION,Dh)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return zo(e).put("owner",n)}static D(){return Or.D()}bi(e){const n=zo(e);return n.get("owner").next(r=>this.vi(r)?(z("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):V.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Fe(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;TE()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return z("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Fe("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Fe("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function zo(t){return He(t,"owner")}function oc(t){return He(t,"clientMetadata")}function JI(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=se(),s=se();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Om(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return TE()?8:qE(We())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new xP;return this.Xi(e,n,o).next(a=>{if(i.result=a,this.zi)return this.es(e,n,o,a.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(ci()<=oe.DEBUG&&z("QueryEngine","SDK will not create cache indexes for query:",ui(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),V.resolve()):(ci()<=oe.DEBUG&&z("QueryEngine","Query:",ui(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(ci()<=oe.DEBUG&&z("QueryEngine","The SDK decides to create cache indexes for query:",ui(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zt(n))):V.resolve())}Yi(e,n){if(p0(n))return V.resolve(null);let r=zt(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Yf(n,null,"F"),r=zt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=se(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const d=this.ts(n,a);return this.ns(n,d,o,l.readTime)?this.Yi(e,Yf(n,null,"F")):this.rs(e,d,n,l)}))})))}Zi(e,n,r,s){return p0(n)||s.isEqual(X.min())?V.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?V.resolve(null):(ci()<=oe.DEBUG&&z("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ui(n)),this.rs(e,o,n,UE(s,-1)).next(a=>a))})}ts(e,n){let r=new ge(fI(e));return n.forEach((s,i)=>{dl(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return ci()<=oe.DEBUG&&z("QueryEngine","Using full collection scan to execute query:",ui(n)),this.Ji.getDocumentsMatchingQuery(e,n,$t.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new xe(te),this._s=new Zr(i=>Vs(i),cl),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new HI(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function XI(t,e,n,r){return new EP(t,e,n,r)}async function ZI(t,e){const n=H(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=se();for(const d of s){o.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}for(const d of i){a.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:a}))})})}function IP(t,e){const n=H(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,d,h){const p=d.batch,g=p.keys();let v=V.resolve();return g.forEach(T=>{v=v.next(()=>h.getEntry(l,T)).next(b=>{const E=d.docVersions.get(T);Y(E!==null),b.version.compareTo(E)<0&&(p.applyToRemoteDocument(b,d),b.isValidDocument()&&(b.setReadTime(d.commitVersion),h.addEntry(b)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(l,p))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=se();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(l=l.add(a.batch.mutations[d].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function eT(t){const e=H(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function TP(t,e){const n=H(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const a=[];e.targetChanges.forEach((h,p)=>{const g=s.get(p);if(!g)return;a.push(n.Ur.removeMatchingKeys(i,h.removedDocuments,p).next(()=>n.Ur.addMatchingKeys(i,h.addedDocuments,p)));let v=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(p)!==null?v=v.withResumeToken(Ue.EMPTY_BYTE_STRING,X.min()).withLastLimboFreeSnapshotVersion(X.min()):h.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(h.resumeToken,r)),s=s.insert(p,v),function(b,E,_){return b.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=3e8?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(g,v,h)&&a.push(n.Ur.updateTargetData(i,v))});let l=Ft(),d=se();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(SP(i,o,e.documentUpdates).next(h=>{l=h.Ps,d=h.Is})),!r.isEqual(X.min())){const h=n.Ur.getLastRemoteSnapshotVersion(i).next(p=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return V.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,d)).next(()=>l)}).then(i=>(n.os=s,i))}function SP(t,e,n){let r=se(),s=se();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Ft();return n.forEach((a,l)=>{const d=i.get(a);l.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(X.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):z("LocalStore","Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",l.version)}),{Ps:o,Is:s}})}function kP(t,e){const n=H(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function wu(t,e){const n=H(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,V.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new zn(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Xi(t,e,n){const r=H(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Xr(o))throw o;z("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function ip(t,e,n){const r=H(t);let s=X.min(),i=se();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,d,h){const p=H(l),g=p._s.get(h);return g!==void 0?V.resolve(p.os.get(g)):p.Ur.getTargetData(d,h)}(r,o,zt(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:X.min(),n?i:se())).next(a=>(rT(r,hI(e),a),{documents:a,Ts:i})))}function tT(t,e){const n=H(t),r=H(n.Ur),s=n.os.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",i=>r.ot(i,e).next(o=>o?o.target:null))}function nT(t,e){const n=H(t),r=n.us.get(e)||X.min();return n.persistence.runTransaction("Get new document changes","readonly",s=>n.cs.getAllFromCollectionGroup(s,e,UE(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(rT(n,e,s),s))}function rT(t,e,n){let r=t.us.get(e)||X.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}function $0(t,e){return`firestore_clients_${t}_${e}`}function q0(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function jh(t,e){return`firestore_targets_${t}_${e}`}class xu{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static Rs(e,n,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new $(s.error.code,s.error.message))),o?new xu(e,n,s.state,i):(Fe("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class fa{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Rs(e,n){const r=JSON.parse(n);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new $(r.error.code,r.error.message))),i?new fa(e,r.state,s):(Fe("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Eu{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Rs(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=Tm();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=KE(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new Eu(e,i):(Fe("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Mm{constructor(e,n){this.clientId=e,this.onlineState=n}static Rs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Mm(n.clientId,n.onlineState):(Fe("SharedClientState",`Failed to parse online state: ${e}`),null)}}class op{constructor(){this.activeTargetIds=Tm()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Vh{constructor(e,n,r,s,i){this.window=e,this.ui=n,this.persistenceKey=r,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new xe(te),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=$0(this.persistenceKey,this.ps),this.vs=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new op),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.Os=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const s=this.getItem($0(this.persistenceKey,r));if(s){const i=Eu.Rs(r,s);i&&(this.Ss=this.Ss.insert(i.clientId,i))}}this.Ns();const n=this.storage.getItem(this.xs);if(n){const r=this.Ls(n);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let n=!1;return this.Ss.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,n,r){this.qs(e,n,r),this.Qs(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(jh(this.persistenceKey,e));if(s){const i=fa.Rs(e,s);i&&(r=i.state)}}return n&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(jh(this.persistenceKey,e))}updateQueryState(e,n,r){this.$s(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.Qs(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return z("SharedClientState","READ",e,n),n}setItem(e,n){z("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){z("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const n=e;if(n.storageArea===this.storage){if(z("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ds)return void Fe("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Cs.test(n.key)){if(n.newValue==null){const r=this.Gs(n.key);return this.zs(r,null)}{const r=this.js(n.key,n.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(n.key)){if(n.newValue!==null){const r=this.Hs(n.key,n.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(n.key)){if(n.newValue!==null){const r=this.Ys(n.key,n.newValue);if(r)return this.Zs(r)}}else if(n.key===this.xs){if(n.newValue!==null){const r=this.Ls(n.newValue);if(r)return this.Bs(r)}}else if(n.key===this.vs){const r=function(i){let o=Rt.oe;if(i!=null)try{const a=JSON.parse(i);Y(typeof a=="number"),o=a}catch(a){Fe("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==Rt.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.Os){const r=this.Xs(n.newValue);await Promise.all(r.map(s=>this.syncEngine.eo(s)))}}}else this.bs.push(n)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,n,r){const s=new xu(this.currentUser,e,n,r),i=q0(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Vs())}Qs(e){const n=q0(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Us(e){const n={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(n))}$s(e,n,r){const s=jh(this.persistenceKey,e),i=new fa(e,n,r);this.setItem(s,i.Vs())}Ws(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Os,n)}Gs(e){const n=this.Cs.exec(e);return n?n[1]:null}js(e,n){const r=this.Gs(e);return Eu.Rs(r,n)}Hs(e,n){const r=this.Fs.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return xu.Rs(new ut(i),s,n)}Ys(e,n){const r=this.Ms.exec(e),s=Number(r[1]);return fa.Rs(s,n)}Ls(e){return Mm.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);z("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,n){const r=n?this.Ss.insert(e,n):this.Ss.remove(e),s=this.ks(this.Ss),i=this.ks(r),o=[],a=[];return i.forEach(l=>{s.has(l)||o.push(l)}),s.forEach(l=>{i.has(l)||a.push(l)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let n=Tm();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class sT{constructor(){this.so=new op,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new op,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){z("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){z("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ac=null;function Oh(){return ac===null?ac=function(){return 268435456+Math.round(2147483648*Math.random())}():ac++,"0x"+ac.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ct="WebChannelConnection";class NP extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const a=Oh(),l=this.xo(n,r.toUriEncodedString());z("RestConnection",`Sending RPC '${n}' ${a}:`,l,s);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,o),this.No(n,l,d,s).then(h=>(z("RestConnection",`Received RPC '${n}' ${a}: `,h),h),h=>{throw Ma("RestConnection",`RPC '${n}' ${a} failed with error: `,h,"url: ",l,"request:",s),h})}Lo(n,r,s,i,o,a){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+lo}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=AP[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=Oh();return new Promise((o,a)=>{const l=new DE;l.setWithCredentials(!0),l.listenOnce(jE.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Ec.NO_ERROR:const h=l.getResponseJson();z(ct,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),o(h);break;case Ec.TIMEOUT:z(ct,`RPC '${e}' ${i} timed out`),a(new $(U.DEADLINE_EXCEEDED,"Request time out"));break;case Ec.HTTP_ERROR:const p=l.getStatus();if(z(ct,`RPC '${e}' ${i} failed with status:`,p,"response text:",l.getResponseText()),p>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const v=g==null?void 0:g.error;if(v&&v.status&&v.message){const T=function(E){const _=E.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(_)>=0?_:U.UNKNOWN}(v.status);a(new $(T,v.message))}else a(new $(U.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new $(U.UNAVAILABLE,"Connection failed."));break;default:Q()}}finally{z(ct,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);z(ct,`RPC '${e}' ${i} sending request:`,s),l.send(n,"POST",d,r,15)})}Bo(e,n,r){const s=Oh(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=ME(),a=OE(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const h=i.join("");z(ct,`Creating RPC '${e}' stream ${s}: ${h}`,l);const p=o.createWebChannel(h,l);let g=!1,v=!1;const T=new RP({Io:E=>{v?z(ct,`Not sending because RPC '${e}' stream ${s} is closed:`,E):(g||(z(ct,`Opening RPC '${e}' stream ${s} transport.`),p.open(),g=!0),z(ct,`RPC '${e}' stream ${s} sending:`,E),p.send(E))},To:()=>p.close()}),b=(E,_,y)=>{E.listen(_,I=>{try{y(I)}catch(P){setTimeout(()=>{throw P},0)}})};return b(p,Ho.EventType.OPEN,()=>{v||(z(ct,`RPC '${e}' stream ${s} transport opened.`),T.yo())}),b(p,Ho.EventType.CLOSE,()=>{v||(v=!0,z(ct,`RPC '${e}' stream ${s} transport closed`),T.So())}),b(p,Ho.EventType.ERROR,E=>{v||(v=!0,Ma(ct,`RPC '${e}' stream ${s} transport errored:`,E),T.So(new $(U.UNAVAILABLE,"The operation could not be completed")))}),b(p,Ho.EventType.MESSAGE,E=>{var _;if(!v){const y=E.data[0];Y(!!y);const I=y,P=I.error||((_=I[0])===null||_===void 0?void 0:_.error);if(P){z(ct,`RPC '${e}' stream ${s} received error:`,P);const O=P.status;let L=function(k){const R=ze[k];if(R!==void 0)return SI(R)}(O),S=P.message;L===void 0&&(L=U.INTERNAL,S="Unknown error status: "+O+" with message "+P.message),v=!0,T.So(new $(L,S)),p.close()}else z(ct,`RPC '${e}' stream ${s} received:`,y),T.bo(y)}}),b(a,VE.STAT_EVENT,E=>{E.stat===Bf.PROXY?z(ct,`RPC '${e}' stream ${s} detected buffering proxy`):E.stat===Bf.NOPROXY&&z(ct,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{T.wo()},0),T}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iT(){return typeof window<"u"?window:null}function Rc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hd(t){return new OC(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oT{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&z("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aT{constructor(e,n,r,s,i,o,a,l){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new oT(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===U.RESOURCE_EXHAUSTED?(Fe(n.toString()),Fe("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new $(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return z("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(z("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class CP extends aT{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=FC(this.serializer,e),r=function(i){if(!("targetChange"in i))return X.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?X.min():o.readTime?xt(o.readTime):X.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=ep(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=fu(l)?{documents:DI(i,l)}:{query:Cm(i,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=AI(i,o.resumeToken);const d=Xf(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(X.min())>0){a.readTime=Yi(i,o.snapshotVersion.toTimestamp());const d=Xf(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=BC(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=ep(this.serializer),n.removeTarget=e,this.a_(n)}}class PP extends aT{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Y(!!e.streamToken),this.lastStreamToken=e.streamToken,Y(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Y(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=UC(e.writeResults,e.commitTime),r=xt(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=ep(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>gu(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new $(U.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,Zf(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new $(U.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,Zf(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new $(U.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class jP{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Fe(n),this.D_=!1):z("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Qs(this)&&(z("RemoteStore","Restarting streams for network reachability change."),await async function(l){const d=H(l);d.L_.add(4),await pl(d),d.q_.set("Unknown"),d.L_.delete(4),await fd(d)}(this))})}),this.q_=new jP(r,s)}}async function fd(t){if(Qs(t))for(const e of t.B_)await e(!0)}async function pl(t){for(const e of t.B_)await e(!1)}function pd(t,e){const n=H(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Um(n)?Fm(n):fo(n).r_()&&Lm(n,e))}function Zi(t,e){const n=H(t),r=fo(n);n.N_.delete(e),r.r_()&&lT(n,e),n.N_.size===0&&(r.r_()?r.o_():Qs(n)&&n.q_.set("Unknown"))}function Lm(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(X.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}fo(t).A_(e)}function lT(t,e){t.Q_.xe(e),fo(t).R_(e)}function Fm(t){t.Q_=new PC({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),fo(t).start(),t.q_.v_()}function Um(t){return Qs(t)&&!fo(t).n_()&&t.N_.size>0}function Qs(t){return H(t).L_.size===0}function cT(t){t.Q_=void 0}async function OP(t){t.q_.set("Online")}async function MP(t){t.N_.forEach((e,n)=>{Lm(t,e)})}async function LP(t,e){cT(t),Um(t)?(t.q_.M_(e),Fm(t)):t.q_.set("Unknown")}async function FP(t,e,n){if(t.q_.set("Online"),e instanceof bI&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.N_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.N_.delete(a),s.Q_.removeTarget(a))}(t,e)}catch(r){z("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Iu(t,r)}else if(e instanceof Ac?t.Q_.Ke(e):e instanceof kI?t.Q_.He(e):t.Q_.We(e),!n.isEqual(X.min()))try{const r=await eT(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){const h=i.N_.get(d);h&&i.N_.set(d,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,d)=>{const h=i.N_.get(l);if(!h)return;i.N_.set(l,h.withResumeToken(Ue.EMPTY_BYTE_STRING,h.snapshotVersion)),lT(i,l);const p=new zn(h.target,l,d,h.sequenceNumber);Lm(i,p)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){z("RemoteStore","Failed to raise snapshot:",r),await Iu(t,r)}}async function Iu(t,e,n){if(!Xr(e))throw e;t.L_.add(1),await pl(t),t.q_.set("Offline"),n||(n=()=>eT(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{z("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await fd(t)})}function uT(t,e){return e().catch(n=>Iu(t,n,e))}async function ho(t){const e=H(t),n=qr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;UP(e);)try{const s=await kP(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,zP(e,s)}catch(s){await Iu(e,s)}dT(e)&&hT(e)}function UP(t){return Qs(t)&&t.O_.length<10}function zP(t,e){t.O_.push(e);const n=qr(t);n.r_()&&n.V_&&n.m_(e.mutations)}function dT(t){return Qs(t)&&!qr(t).n_()&&t.O_.length>0}function hT(t){qr(t).start()}async function BP(t){qr(t).p_()}async function $P(t){const e=qr(t);for(const n of t.O_)e.m_(n.mutations)}async function qP(t,e,n){const r=t.O_.shift(),s=bm.from(r,e,n);await uT(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await ho(t)}async function KP(t,e){e&&qr(t).V_&&await async function(r,s){if(function(o){return RC(o)&&o!==U.ABORTED}(s.code)){const i=r.O_.shift();qr(r).s_(),await uT(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await ho(r)}}(t,e),dT(t)&&hT(t)}async function G0(t,e){const n=H(t);n.asyncQueue.verifyOperationInProgress(),z("RemoteStore","RemoteStore received new credentials");const r=Qs(n);n.L_.add(3),await pl(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await fd(n)}async function ap(t,e){const n=H(t);e?(n.L_.delete(2),await fd(n)):e||(n.L_.add(2),await pl(n),n.q_.set("Unknown"))}function fo(t){return t.K_||(t.K_=function(n,r,s){const i=H(n);return i.w_(),new CP(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:OP.bind(null,t),Ro:MP.bind(null,t),mo:LP.bind(null,t),d_:FP.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Um(t)?Fm(t):t.q_.set("Unknown")):(await t.K_.stop(),cT(t))})),t.K_}function qr(t){return t.U_||(t.U_=function(n,r,s){const i=H(n);return i.w_(),new PP(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:BP.bind(null,t),mo:KP.bind(null,t),f_:$P.bind(null,t),g_:qP.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await ho(t)):(await t.U_.stop(),t.O_.length>0&&(z("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new cn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new zm(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Bm(t,e){if(Fe("AsyncQueue",`${e}: ${t}`),Xr(t))return new $(U.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(e){this.comparator=e?(n,r)=>e(n,r)||G.comparator(n.key,r.key):(n,r)=>G.comparator(n.key,r.key),this.keyedMap=Qo(),this.sortedSet=new xe(this.comparator)}static emptySet(e){return new Pi(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Pi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Pi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W0{constructor(){this.W_=new xe(G.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):Q():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class eo{constructor(e,n,r,s,i,o,a,l,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new eo(e,n,Pi.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&sd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GP{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class WP{constructor(){this.queries=H0(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=H(n),i=s.queries;s.queries=H0(),i.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new $(U.ABORTED,"Firestore shutting down"))}}function H0(){return new Zr(t=>dI(t),sd)}async function $m(t,e){const n=H(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new GP,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=Bm(o,`Initialization of query '${ui(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Km(n)}async function qm(t,e){const n=H(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function HP(t,e){const n=H(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.j_)a.X_(s)&&(r=!0);o.z_=s}}r&&Km(n)}function QP(t,e,n){const r=H(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Km(t){t.Y_.forEach(e=>{e.next()})}var lp,Q0;(Q0=lp||(lp={})).ea="default",Q0.Cache="cache";class Gm{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new eo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=eo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==lp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fT{constructor(e){this.key=e}}class pT{constructor(e){this.key=e}}class JP{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=se(),this.mutatedKeys=se(),this.Aa=fI(e),this.Ra=new Pi(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new W0,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,p)=>{const g=s.get(h),v=dl(this.query,p)?p:null,T=!!g&&this.mutatedKeys.has(g.key),b=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let E=!1;g&&v?g.data.isEqual(v.data)?T!==b&&(r.track({type:3,doc:v}),E=!0):this.ga(g,v)||(r.track({type:2,doc:v}),E=!0,(l&&this.Aa(v,l)>0||d&&this.Aa(v,d)<0)&&(a=!0)):!g&&v?(r.track({type:0,doc:v}),E=!0):g&&!v&&(r.track({type:1,doc:g}),E=!0,(l||d)&&(a=!0)),E&&(v?(o=o.add(v),i=b?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{Ra:o,fa:r,ns:a,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((h,p)=>function(v,T){const b=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Q()}};return b(v)-b(T)}(h.type,p.type)||this.Aa(h.doc,p.doc)),this.pa(r),s=s!=null&&s;const a=n&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,d=l!==this.Ea;return this.Ea=l,o.length!==0||d?{snapshot:new eo(this.query,e.Ra,i,o,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new W0,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=se(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new pT(r))}),this.da.forEach(r=>{e.has(r)||n.push(new fT(r))}),n}ba(e){this.Ta=e.Ts,this.da=se();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return eo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class YP{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class XP{constructor(e){this.key=e,this.va=!1}}class ZP{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Zr(a=>dI(a),sd),this.Ma=new Map,this.xa=new Set,this.Oa=new xe(G.comparator),this.Na=new Map,this.La=new jm,this.Ba={},this.ka=new Map,this.qa=Us.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function e2(t,e,n=!0){const r=md(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await mT(r,e,n,!0),s}async function t2(t,e){const n=md(t);await mT(n,e,!0,!1)}async function mT(t,e,n,r){const s=await wu(t.localStore,zt(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await Wm(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&pd(t.remoteStore,s),a}async function Wm(t,e,n,r,s){t.Ka=(p,g,v)=>async function(b,E,_,y){let I=E.view.ma(_);I.ns&&(I=await ip(b.localStore,E.query,!1).then(({documents:S})=>E.view.ma(S,I)));const P=y&&y.targetChanges.get(E.targetId),O=y&&y.targetMismatches.get(E.targetId)!=null,L=E.view.applyChanges(I,b.isPrimaryClient,P,O);return cp(b,E.targetId,L.wa),L.snapshot}(t,p,g,v);const i=await ip(t.localStore,e,!0),o=new JP(e,i.Ts),a=o.ma(i.documents),l=fl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(a,t.isPrimaryClient,l);cp(t,n,d.wa);const h=new YP(e,n,o);return t.Fa.set(e,h),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),d.snapshot}async function n2(t,e,n){const r=H(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!sd(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Xi(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Zi(r.remoteStore,s.targetId),to(r,s.targetId)}).catch(Yr)):(to(r,s.targetId),await Xi(r.localStore,s.targetId,!0))}async function r2(t,e){const n=H(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Zi(n.remoteStore,r.targetId))}async function s2(t,e,n){const r=Ym(t);try{const s=await function(o,a){const l=H(o),d=Ne.now(),h=a.reduce((v,T)=>v.add(T.key),se());let p,g;return l.persistence.runTransaction("Locally write mutations","readwrite",v=>{let T=Ft(),b=se();return l.cs.getEntries(v,h).next(E=>{T=E,T.forEach((_,y)=>{y.isValidDocument()||(b=b.add(_))})}).next(()=>l.localDocuments.getOverlayedDocuments(v,T)).next(E=>{p=E;const _=[];for(const y of a){const I=kC(y,p.get(y.key).overlayedDocument);I!=null&&_.push(new tr(y.key,I,eI(I.value.mapValue),ft.exists(!0)))}return l.mutationQueue.addMutationBatch(v,d,_,a)}).next(E=>{g=E;const _=E.applyToLocalDocumentSet(p,b);return l.documentOverlayCache.saveOverlays(v,E.batchId,_)})}).then(()=>({batchId:g.batchId,changes:mI(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let d=o.Ba[o.currentUser.toKey()];d||(d=new xe(te)),d=d.insert(a,l),o.Ba[o.currentUser.toKey()]=d}(r,s.batchId,n),await es(r,s.changes),await ho(r.remoteStore)}catch(s){const i=Bm(s,"Failed to persist write");n.reject(i)}}async function gT(t,e){const n=H(t);try{const r=await TP(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(Y(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Y(o.va):s.removedDocuments.size>0&&(Y(o.va),o.va=!1))}),await es(n,r,e)}catch(r){await Yr(r)}}function J0(t,e,n){const r=H(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=H(o);l.onlineState=a;let d=!1;l.queries.forEach((h,p)=>{for(const g of p.j_)g.Z_(a)&&(d=!0)}),d&&Km(l)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function i2(t,e,n){const r=H(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new xe(G.comparator);o=o.insert(i,Ve.newNoDocument(i,X.min()));const a=se().add(i),l=new hl(X.min(),new Map,new xe(te),o,a);await gT(r,l),r.Oa=r.Oa.remove(i),r.Na.delete(e),Jm(r)}else await Xi(r.localStore,e,!1).then(()=>to(r,e,n)).catch(Yr)}async function o2(t,e){const n=H(t),r=e.batch.batchId;try{const s=await IP(n.localStore,e);Qm(n,r,null),Hm(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await es(n,s)}catch(s){await Yr(s)}}async function a2(t,e,n){const r=H(t);try{const s=await function(o,a){const l=H(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return l.mutationQueue.lookupMutationBatch(d,a).next(p=>(Y(p!==null),h=p.keys(),l.mutationQueue.removeMutationBatch(d,p))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>l.localDocuments.getDocuments(d,h))})}(r.localStore,e);Qm(r,e,n),Hm(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await es(r,s)}catch(s){await Yr(s)}}function Hm(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Qm(t,e,n){const r=H(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function to(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||yT(t,r)})}function yT(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Zi(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Jm(t))}function cp(t,e,n){for(const r of n)r instanceof fT?(t.La.addReference(r.key,e),l2(t,r)):r instanceof pT?(z("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||yT(t,r.key)):Q()}function l2(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(z("SyncEngine","New document in limbo: "+n),t.xa.add(r),Jm(t))}function Jm(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new G(fe.fromString(e)),r=t.qa.next();t.Na.set(r,new XP(n)),t.Oa=t.Oa.insert(n,r),pd(t.remoteStore,new zn(zt(ul(n.path)),r,"TargetPurposeLimboResolution",Rt.oe))}}async function es(t,e,n){const r=H(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const p=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(d){s.push(d);const p=Om.Wi(l.targetId,d);i.push(p)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(l,d){const h=H(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>V.forEach(d,g=>V.forEach(g.$i,v=>h.persistence.referenceDelegate.addReference(p,g.targetId,v)).next(()=>V.forEach(g.Ui,v=>h.persistence.referenceDelegate.removeReference(p,g.targetId,v)))))}catch(p){if(!Xr(p))throw p;z("LocalStore","Failed to update sequence numbers: "+p)}for(const p of d){const g=p.targetId;if(!p.fromCache){const v=h.os.get(g),T=v.snapshotVersion,b=v.withLastLimboFreeSnapshotVersion(T);h.os=h.os.insert(g,b)}}}(r.localStore,i))}async function c2(t,e){const n=H(t);if(!n.currentUser.isEqual(e)){z("SyncEngine","User change. New user:",e.toKey());const r=await ZI(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(l=>{l.reject(new $(U.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await es(n,r.hs)}}function u2(t,e){const n=H(t),r=n.Na.get(e);if(r&&r.va)return se().add(r.key);{let s=se();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const a=n.Fa.get(o);s=s.unionWith(a.view.Va)}return s}}async function d2(t,e){const n=H(t),r=await ip(n.localStore,e.query,!0),s=e.view.ba(r);return n.isPrimaryClient&&cp(n,e.targetId,s.wa),s}async function h2(t,e){const n=H(t);return nT(n.localStore,e).then(r=>es(n,r))}async function f2(t,e,n,r){const s=H(t),i=await function(a,l){const d=H(a),h=H(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",p=>h.Mn(p,l).next(g=>g?d.localDocuments.getDocuments(p,g):V.resolve(null)))}(s.localStore,e);i!==null?(n==="pending"?await ho(s.remoteStore):n==="acknowledged"||n==="rejected"?(Qm(s,e,r||null),Hm(s,e),function(a,l){H(H(a).mutationQueue).On(l)}(s.localStore,e)):Q(),await es(s,i)):z("SyncEngine","Cannot apply mutation batch with id: "+e)}async function p2(t,e){const n=H(t);if(md(n),Ym(n),e===!0&&n.Qa!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await Y0(n,r.toArray());n.Qa=!0,await ap(n.remoteStore,!0);for(const i of s)pd(n.remoteStore,i)}else if(e===!1&&n.Qa!==!1){const r=[];let s=Promise.resolve();n.Ma.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(to(n,o),Xi(n.localStore,o,!0))),Zi(n.remoteStore,o)}),await s,await Y0(n,r),function(o){const a=H(o);a.Na.forEach((l,d)=>{Zi(a.remoteStore,d)}),a.La.pr(),a.Na=new Map,a.Oa=new xe(G.comparator)}(n),n.Qa=!1,await ap(n.remoteStore,!1)}}async function Y0(t,e,n){const r=H(t),s=[],i=[];for(const o of e){let a;const l=r.Ma.get(o);if(l&&l.length!==0){a=await wu(r.localStore,zt(l[0]));for(const d of l){const h=r.Fa.get(d),p=await d2(r,h);p.snapshot&&i.push(p.snapshot)}}else{const d=await tT(r.localStore,o);a=await wu(r.localStore,d),await Wm(r,vT(d),o,!1,a.resumeToken)}s.push(a)}return r.Ca.d_(i),s}function vT(t){return lI(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function m2(t){return function(n){return H(H(n).persistence).Qi()}(H(t).localStore)}async function g2(t,e,n,r){const s=H(t);if(s.Qa)return void z("SyncEngine","Ignoring unexpected query state notification.");const i=s.Ma.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await nT(s.localStore,hI(i[0])),a=hl.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Ue.EMPTY_BYTE_STRING);await es(s,o,a);break}case"rejected":await Xi(s.localStore,e,!0),to(s,e,r);break;default:Q()}}async function y2(t,e,n){const r=md(t);if(r.Qa){for(const s of e){if(r.Ma.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){z("SyncEngine","Adding an already active target "+s);continue}const i=await tT(r.localStore,s),o=await wu(r.localStore,i);await Wm(r,vT(i),o.targetId,!1,o.resumeToken),pd(r.remoteStore,o)}for(const s of n)r.Ma.has(s)&&await Xi(r.localStore,s,!1).then(()=>{Zi(r.remoteStore,s),to(r,s)}).catch(Yr)}}function md(t){const e=H(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=gT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=u2.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=i2.bind(null,e),e.Ca.d_=HP.bind(null,e.eventManager),e.Ca.$a=QP.bind(null,e.eventManager),e}function Ym(t){const e=H(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=o2.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=a2.bind(null,e),e}class Wa{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hd(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return XI(this.persistence,new YI,e.initialUser,this.serializer)}Ga(e){return new QI(dd.Zr,this.serializer)}Wa(e){return new sT}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Wa.provider={build:()=>new Wa};class _T extends Wa{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Ym(this.Ja.syncEngine),await ho(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return XI(this.persistence,new YI,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new iP(r,e.asyncQueue,n)}Ha(e,n){const r=new VN(n,this.persistence);return new jN(e.asyncQueue,r)}Ga(e){const n=JI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Tt.withCacheSize(this.cacheSizeBytes):Tt.DEFAULT;return new Vm(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,iT(),Rc(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new sT}}class v2 extends _T{constructor(e,n){super(e,n,!1),this.Ja=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ja.syncEngine;this.sharedClientState instanceof Vh&&(this.sharedClientState.syncEngine={no:f2.bind(null,n),ro:g2.bind(null,n),io:y2.bind(null,n),Qi:m2.bind(null,n),eo:h2.bind(null,n)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await p2(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const n=iT();if(!Vh.D(n))throw new $(U.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=JI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Vh(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class Ha{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>J0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=c2.bind(null,this.syncEngine),await ap(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new WP}()}createDatastore(e){const n=hd(e.databaseInfo.databaseId),r=function(i){return new NP(i)}(e.databaseInfo);return function(i,o,a,l){return new DP(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new VP(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>J0(this.syncEngine,n,0),function(){return K0.D()?new K0:new bP}())}createSyncEngine(e,n){return function(s,i,o,a,l,d,h){const p=new ZP(s,i,o,a,l,d);return h&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=H(s);z("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await pl(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Ha.provider={build:()=>new Ha};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xm{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Fe("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=ut.UNAUTHENTICATED,this.clientId=LE.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{z("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(z("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new cn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Bm(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Mh(t,e){t.asyncQueue.verifyOperationInProgress(),z("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await ZI(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function X0(t,e){t.asyncQueue.verifyOperationInProgress();const n=await w2(t);z("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>G0(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>G0(e.remoteStore,s)),t._onlineComponents=e}async function w2(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){z("FirestoreClient","Using user provided OfflineComponentProvider");try{await Mh(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===U.FAILED_PRECONDITION||s.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Ma("Error using user provided cache. Falling back to memory cache: "+n),await Mh(t,new Wa)}}else z("FirestoreClient","Using default OfflineComponentProvider"),await Mh(t,new Wa);return t._offlineComponents}async function Zm(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(z("FirestoreClient","Using user provided OnlineComponentProvider"),await X0(t,t._uninitializedComponentsProvider._online)):(z("FirestoreClient","Using default OnlineComponentProvider"),await X0(t,new Ha))),t._onlineComponents}function x2(t){return Zm(t).then(e=>e.syncEngine)}function E2(t){return Zm(t).then(e=>e.datastore)}async function Tu(t){const e=await Zm(t),n=e.eventManager;return n.onListen=e2.bind(null,e.syncEngine),n.onUnlisten=n2.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=t2.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=r2.bind(null,e.syncEngine),n}function I2(t,e,n={}){const r=new cn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,d){const h=new Xm({next:g=>{h.Za(),o.enqueueAndForget(()=>qm(i,p));const v=g.docs.has(a);!v&&g.fromCache?d.reject(new $(U.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&g.fromCache&&l&&l.source==="server"?d.reject(new $(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(g)},error:g=>d.reject(g)}),p=new Gm(ul(a.path),h,{includeMetadataChanges:!0,_a:!0});return $m(i,p)}(await Tu(t),t.asyncQueue,e,n,r)),r.promise}function T2(t,e,n={}){const r=new cn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,d){const h=new Xm({next:g=>{h.Za(),o.enqueueAndForget(()=>qm(i,p)),g.fromCache&&l.source==="server"?d.reject(new $(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(g)},error:g=>d.reject(g)}),p=new Gm(a,h,{includeMetadataChanges:!0,_a:!0});return $m(i,p)}(await Tu(t),t.asyncQueue,e,n,r)),r.promise}function S2(t,e,n){const r=new cn;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await E2(t);r.resolve(async function(o,a,l){var d;const h=H(o),{request:p,ut:g,parent:v}=zC(h.serializer,pC(a),l);h.connection.Fo||delete p.parent;const T=(await h.Lo("RunAggregationQuery",h.serializer.databaseId,v,p,1)).filter(E=>!!E.result);Y(T.length===1);const b=(d=T[0].result)===null||d===void 0?void 0:d.aggregateFields;return Object.keys(b).reduce((E,_)=>(E[g[_]]=b[_],E),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wT(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z0=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xT(t,e,n){if(!n)throw new $(U.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function k2(t,e,n,r){if(e===!0&&r===!0)throw new $(U.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function e_(t){if(!G.isDocumentKey(t))throw new $(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function t_(t){if(G.isDocumentKey(t))throw new $(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function gd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Q()}function jt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new $(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=gd(t);throw new $(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new $(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new $(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}k2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=wT((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new $(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new $(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new $(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class eg{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new n_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new n_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new TN;switch(r.type){case"firstParty":return new bN(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new $(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Z0.get(n);r&&(z("ComponentProvider","Removing Datastore"),Z0.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ts(this.firestore,e,this._query)}}class pt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Mr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new pt(this.firestore,e,this._key)}}class Mr extends ts{constructor(e,n,r){super(e,n,ul(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new pt(this.firestore,null,new G(e))}withConverter(e){return new Mr(this.firestore,e,this._path)}}function Ge(t,e,...n){if(t=Pe(t),xT("collection","path",e),t instanceof eg){const r=fe.fromString(e,...n);return t_(r),new Mr(t,null,r)}{if(!(t instanceof pt||t instanceof Mr))throw new $(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(fe.fromString(e,...n));return t_(r),new Mr(t.firestore,null,r)}}function Me(t,e,...n){if(t=Pe(t),arguments.length===1&&(e=LE.newId()),xT("doc","path",e),t instanceof eg){const r=fe.fromString(e,...n);return e_(r),new pt(t,null,new G(r))}{if(!(t instanceof pt||t instanceof Mr))throw new $(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(fe.fromString(e,...n));return e_(r),new pt(t.firestore,t instanceof Mr?t.converter:null,new G(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new oT(this,"async_queue_retry"),this.Vu=()=>{const r=Rc();r&&z("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Rc();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Rc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new cn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Xr(e))throw e;z("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Fe("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=zm.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&Q()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function s_(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class bn extends eg{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new r_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new r_(e),this._firestoreClient=void 0,await e}}}function b2(t,e,n){n||(n="(default)");const r=ed(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(Ns(i,e))return s;throw new $(U.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new $(U.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new $(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function ml(t){if(t._terminated)throw new $(U.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||A2(t),t._firestoreClient}function A2(t){var e,n,r;const s=t._freezeSettings(),i=function(a,l,d,h){return new rC(a,l,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,wT(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new _2(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class N2{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e){this._byteString=e}static fromBase64String(e){try{return new no(Ue.fromBase64String(e))}catch(n){throw new $(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new no(Ue.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new $(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ae(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tg{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new $(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new $(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return te(this._lat,e._lat)||te(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2=/^__.*__$/;class P2{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new tr(e,this.data,this.fieldMask,n,this.fieldTransforms):new uo(e,this.data,n,this.fieldTransforms)}}class ET{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new tr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function IT(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Q()}}class vd{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new vd(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Su(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(IT(this.Cu)&&C2.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class D2{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||hd(e)}Qu(e,n,r,s=!1){return new vd({Cu:e,methodName:n,qu:r,path:Ae.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function _d(t){const e=t._freezeSettings(),n=hd(t._databaseId);return new D2(t._databaseId,!!e.ignoreUndefinedProperties,n)}function TT(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);og("Data must be an object, but it was:",o,r);const a=kT(r,o);let l,d;if(i.merge)l=new Nt(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const p of i.mergeFields){const g=up(e,p,n);if(!o.contains(g))throw new $(U.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);AT(h,g)||h.push(g)}l=new Nt(h),d=o.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,d=o.fieldTransforms;return new P2(new ht(a),l,d)}class wd extends po{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof wd}}function ST(t,e,n){return new vd({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class rg extends po{_toFieldTransform(e){return new od(e.path,new Ji)}isEqual(e){return e instanceof rg}}class sg extends po{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=ST(this,e,!0),r=this.Ku.map(i=>Js(i,n)),s=new Os(r);return new od(e.path,s)}isEqual(e){return e instanceof sg&&Ns(this.Ku,e.Ku)}}class ig extends po{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=ST(this,e,!0),r=this.Ku.map(i=>Js(i,n)),s=new Ms(r);return new od(e.path,s)}isEqual(e){return e instanceof ig&&Ns(this.Ku,e.Ku)}}function j2(t,e,n,r){const s=t.Qu(1,e,n);og("Data must be an object, but it was:",s,r);const i=[],o=ht.empty();Hs(r,(l,d)=>{const h=ag(e,l,n);d=Pe(d);const p=s.Nu(h);if(d instanceof wd)i.push(h);else{const g=Js(d,p);g!=null&&(i.push(h),o.set(h,g))}});const a=new Nt(i);return new ET(o,a,s.fieldTransforms)}function V2(t,e,n,r,s,i){const o=t.Qu(1,e,n),a=[up(e,r,n)],l=[s];if(i.length%2!=0)throw new $(U.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)a.push(up(e,i[g])),l.push(i[g+1]);const d=[],h=ht.empty();for(let g=a.length-1;g>=0;--g)if(!AT(d,a[g])){const v=a[g];let T=l[g];T=Pe(T);const b=o.Nu(v);if(T instanceof wd)d.push(v);else{const E=Js(T,b);E!=null&&(d.push(v),h.set(v,E))}}const p=new Nt(d);return new ET(h,p,o.fieldTransforms)}function O2(t,e,n,r=!1){return Js(n,t.Qu(r?4:3,e))}function Js(t,e){if(bT(t=Pe(t)))return og("Unsupported field value:",e,t),kT(t,e);if(t instanceof po)return function(r,s){if(!IT(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Js(a,s.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Pe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return wC(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Ne.fromDate(r);return{timestampValue:Yi(s.serializer,i)}}if(r instanceof Ne){const i=new Ne(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Yi(s.serializer,i)}}if(r instanceof tg)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof no)return{bytesValue:AI(s.serializer,r._byteString)};if(r instanceof pt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Nm(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof ng)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return Sm(a.serializer,l)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${gd(r)}`)}(t,e)}function kT(t,e){const n={};return JE(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Hs(t,(r,s)=>{const i=Js(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function bT(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ne||t instanceof tg||t instanceof no||t instanceof pt||t instanceof po||t instanceof ng)}function og(t,e,n){if(!bT(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=gd(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function up(t,e,n){if((e=Pe(e))instanceof yd)return e._internalPath;if(typeof e=="string")return ag(t,e);throw Su("Field path arguments must be of type string or ",t,!1,void 0,n)}const M2=new RegExp("[~\\*/\\[\\]]");function ag(t,e,n){if(e.search(M2)>=0)throw Su(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new yd(...e.split("."))._internalPath}catch{throw Su(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Su(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new $(U.INVALID_ARGUMENT,a+t+l)}function AT(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RT{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new pt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new L2(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(xd("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class L2 extends RT{data(){return super.data()}}function xd(t,e){return typeof e=="string"?ag(t,e):e instanceof yd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new $(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class lg{}class CT extends lg{}function Ys(t,e,...n){let r=[];e instanceof lg&&r.push(e),r=r.concat(n),function(i){const o=i.filter(l=>l instanceof cg).length,a=i.filter(l=>l instanceof Ed).length;if(o>1||o>0&&a>0)throw new $(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Ed extends CT{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Ed(e,n,r)}_apply(e){const n=this._parse(e);return PT(e._query,n),new ts(e.firestore,e.converter,Jf(e._query,n))}_parse(e){const n=_d(e.firestore);return function(i,o,a,l,d,h,p){let g;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new $(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){o_(p,h);const v=[];for(const T of p)v.push(i_(l,i,T));g={arrayValue:{values:v}}}else g=i_(l,i,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||o_(p,h),g=O2(a,o,p,h==="in"||h==="not-in");return ae.create(d,h,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function gl(t,e,n){const r=e,s=xd("where",t);return Ed._create(s,r,n)}class cg extends lg{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new cg(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:pe.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)PT(o,l),o=Jf(o,l)}(e._query,n),new ts(e.firestore,e.converter,Jf(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class ug extends CT{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new ug(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new $(U.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new $(U.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ka(i,o)}(e._query,this._field,this._direction);return new ts(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new co(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Id(t,e="asc"){const n=e,r=xd("orderBy",t);return ug._create(r,n)}function i_(t,e,n){if(typeof(n=Pe(n))=="string"){if(n==="")throw new $(U.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!cI(e)&&n.indexOf("/")!==-1)throw new $(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(fe.fromString(n));if(!G.isDocumentKey(r))throw new $(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return $a(t,new G(r))}if(n instanceof pt)return $a(t,n._key);throw new $(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${gd(n)}.`)}function o_(t,e){if(!Array.isArray(t)||t.length===0)throw new $(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function PT(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new $(U.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new $(U.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class F2{convertValue(e,n="none"){switch(js(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Se(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Br(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Q()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Hs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Se(o.doubleValue));return new ng(i)}convertGeoPoint(e){return new tg(Se(e.latitude),Se(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Em(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(za(e));default:return null}}convertTimestamp(e){const n=Xn(e);return new Ne(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=fe.fromString(e);Y(MI(r));const s=new Ds(r.get(1),r.get(3)),i=new G(r.popFirst(5));return s.isEqual(n)||Fe(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DT(t,e,n){let r;return r=t?t.toFirestore(e):e,r}function U2(){return new R2("count")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class jT extends RT{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Nc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(xd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Nc extends jT{data(e={}){return super.data(e)}}class VT{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Xo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Nc(this._firestore,this._userDataWriter,r.key,r,new Xo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new $(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new Nc(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Xo(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Nc(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Xo(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:z2(a.type),doc:l,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function z2(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Q()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qa(t){t=jt(t,pt);const e=jt(t.firestore,bn);return I2(ml(e),t._key).then(n=>MT(e,t,n))}class Td extends F2{constructor(e){super(),this.firestore=e}convertBytes(e){return new no(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new pt(this.firestore,null,n)}}function Ja(t){t=jt(t,ts);const e=jt(t.firestore,bn),n=ml(e),r=new Td(e);return NT(t._query),T2(n,t._query).then(s=>new VT(e,r,t,s))}function B2(t,e,n){t=jt(t,pt);const r=jt(t.firestore,bn),s=DT(t.converter,e);return Sd(r,[TT(_d(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,ft.none())])}function kt(t,e,n,...r){t=jt(t,pt);const s=jt(t.firestore,bn),i=_d(s);let o;return o=typeof(e=Pe(e))=="string"||e instanceof yd?V2(i,"updateDoc",t._key,e,n,r):j2(i,"updateDoc",t._key,e),Sd(s,[o.toMutation(t._key,ft.exists(!0))])}function OT(t){return Sd(jt(t.firestore,bn),[new ld(t._key,ft.none())])}function Kr(t,e){const n=jt(t.firestore,bn),r=Me(t),s=DT(t.converter,e);return Sd(n,[TT(_d(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,ft.exists(!1))]).then(()=>r)}function ku(t,...e){var n,r,s;t=Pe(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||s_(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(s_(e[o])){const p=e[o];e[o]=(n=p.next)===null||n===void 0?void 0:n.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(s=p.complete)===null||s===void 0?void 0:s.bind(p)}let l,d,h;if(t instanceof pt)d=jt(t.firestore,bn),h=ul(t._key.path),l={next:p=>{e[o]&&e[o](MT(d,t,p))},error:e[o+1],complete:e[o+2]};else{const p=jt(t,ts);d=jt(p.firestore,bn),h=p._query;const g=new Td(d);l={next:v=>{e[o]&&e[o](new VT(d,g,p,v))},error:e[o+1],complete:e[o+2]},NT(t._query)}return function(g,v,T,b){const E=new Xm(b),_=new Gm(v,E,T);return g.asyncQueue.enqueueAndForget(async()=>$m(await Tu(g),_)),()=>{E.Za(),g.asyncQueue.enqueueAndForget(async()=>qm(await Tu(g),_))}}(ml(d),h,a,l)}function Sd(t,e){return function(r,s){const i=new cn;return r.asyncQueue.enqueueAndForget(async()=>s2(await x2(r),s,i)),i.promise}(ml(t),e)}function MT(t,e,n){const r=n.docs.get(e._key),s=new Td(t);return new jT(t,s,e._key,r,new Xo(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a_(t){return $2(t,{count:U2()})}function $2(t,e){const n=jt(t.firestore,bn),r=ml(n),s=tC(e,(i,o)=>new bC(o,i.aggregateType,i._internalFieldPath));return S2(r,t._query,s).then(i=>function(a,l,d){const h=new Td(a);return new N2(l,h,d)}(n,t,i))}class q2{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=H2(),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function K2(t){return new q2(t)}class G2{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Ha.provider,this._offlineComponentProvider={build:n=>new _T(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class W2{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Ha.provider,this._offlineComponentProvider={build:n=>new v2(n,e==null?void 0:e.cacheSizeBytes)}}}function H2(t){return new G2(void 0)}function Q2(){return new W2}function bt(){return new rg("serverTimestamp")}function dp(...t){return new sg("arrayUnion",t)}function hp(...t){return new ig("arrayRemove",t)}(function(e,n=!0){(function(s){lo=s})(Ws),Cs(new zr("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new bn(new SN(r.getProvider("auth-internal")),new RN(r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new $(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ds(d.options.projectId,h)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),En(Xv,"4.7.3",e),En(Xv,"4.7.3","esm2017")})();var J2="firebase",Y2="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */En(J2,Y2,"app");function dg(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function LT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const X2=LT,FT=new al("auth","Firebase",LT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bu=new mm("@firebase/auth");function Z2(t,...e){bu.logLevel<=oe.WARN&&bu.warn(`Auth (${Ws}): ${t}`,...e)}function Cc(t,...e){bu.logLevel<=oe.ERROR&&bu.error(`Auth (${Ws}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dn(t,...e){throw hg(t,...e)}function In(t,...e){return hg(t,...e)}function UT(t,e,n){const r=Object.assign(Object.assign({},X2()),{[e]:n});return new al("auth","Firebase",r).create(e,{appName:t.name})}function Gn(t){return UT(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function hg(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return FT.create(t,...e)}function Z(t,e,...n){if(!t)throw hg(e,...n)}function Bn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Cc(e),new Error(e)}function Zn(t,e){t||Bn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fp(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function eD(){return l_()==="http:"||l_()==="https:"}function l_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(eD()||iR()||"connection"in navigator)?navigator.onLine:!0}function nD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e,n){this.shortDelay=e,this.longDelay=n,Zn(n>e,"Short delay should be less than long delay!"),this.isMobile=nR()||oR()}get(){return tD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fg(t,e){Zn(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Bn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Bn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Bn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sD=new yl(3e4,6e4);function nr(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function hn(t,e,n,r,s={}){return BT(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=ll(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:l},i);return sR()||(d.referrerPolicy="no-referrer"),zT.fetch()($T(t,t.config.apiHost,n,a),d)})}async function BT(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},rD),e);try{const s=new oD(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw lc(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,d]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw lc(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw lc(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw lc(t,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw UT(t,h,d);dn(t,h)}}catch(s){if(s instanceof Rn)throw s;dn(t,"network-request-failed",{message:String(s)})}}async function vl(t,e,n,r,s={}){const i=await hn(t,e,n,r,s);return"mfaPendingCredential"in i&&dn(t,"multi-factor-auth-required",{_serverResponse:i}),i}function $T(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?fg(t.config,s):`${t.config.apiScheme}://${s}`}function iD(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class oD{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(In(this.auth,"network-request-failed")),sD.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function lc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=In(t,e,r);return s.customData._tokenResponse=n,s}function c_(t){return t!==void 0&&t.enterprise!==void 0}class aD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return iD(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function lD(t,e){return hn(t,"GET","/v2/recaptchaConfig",nr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cD(t,e){return hn(t,"POST","/v1/accounts:delete",e)}async function qT(t,e){return hn(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pa(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function uD(t,e=!1){const n=Pe(t),r=await n.getIdToken(e),s=pg(r);Z(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:pa(Lh(s.auth_time)),issuedAtTime:pa(Lh(s.iat)),expirationTime:pa(Lh(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Lh(t){return Number(t)*1e3}function pg(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Cc("JWT malformed, contained fewer than 3 sections"),null;try{const s=wE(n);return s?JSON.parse(s):(Cc("Failed to decode base64 JWT payload"),null)}catch(s){return Cc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function u_(t){const e=pg(t);return Z(e,"internal-error"),Z(typeof e.exp<"u","internal-error"),Z(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zs(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Rn&&dD(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function dD({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=pa(this.lastLoginAt),this.creationTime=pa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Au(t){var e;const n=t.auth,r=await t.getIdToken(),s=await zs(t,qT(n,{idToken:r}));Z(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?KT(i.providerUserInfo):[],a=pD(t.providerData,o),l=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),h=l?d:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new pp(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,p)}async function fD(t){const e=Pe(t);await Au(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function pD(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function KT(t){return t.map(e=>{var{providerId:n}=e,r=dg(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mD(t,e){const n=await BT(t,{},async()=>{const r=ll({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=$T(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",zT.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function gD(t,e){return hn(t,"POST","/v2/accounts:revokeToken",nr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Z(e.idToken,"internal-error"),Z(typeof e.idToken<"u","internal-error"),Z(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):u_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Z(e.length!==0,"internal-error");const n=u_(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Z(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await mD(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Di;return r&&(Z(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(Z(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(Z(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Di,this.toJSON())}_performRefresh(){return Bn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cr(t,e){Z(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class $n{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=dg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new hD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new pp(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await zs(this,this.stsTokenManager.getToken(this.auth,e));return Z(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return uD(this,e)}reload(){return fD(this)}_assign(e){this!==e&&(Z(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new $n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Z(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Au(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(yn(this.auth.app))return Promise.reject(Gn(this.auth));const e=await this.getIdToken();return await zs(this,cD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,a,l,d,h;const p=(r=n.displayName)!==null&&r!==void 0?r:void 0,g=(s=n.email)!==null&&s!==void 0?s:void 0,v=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,T=(o=n.photoURL)!==null&&o!==void 0?o:void 0,b=(a=n.tenantId)!==null&&a!==void 0?a:void 0,E=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,_=(d=n.createdAt)!==null&&d!==void 0?d:void 0,y=(h=n.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:I,emailVerified:P,isAnonymous:O,providerData:L,stsTokenManager:S}=n;Z(I&&S,e,"internal-error");const x=Di.fromJSON(this.name,S);Z(typeof I=="string",e,"internal-error"),cr(p,e.name),cr(g,e.name),Z(typeof P=="boolean",e,"internal-error"),Z(typeof O=="boolean",e,"internal-error"),cr(v,e.name),cr(T,e.name),cr(b,e.name),cr(E,e.name),cr(_,e.name),cr(y,e.name);const k=new $n({uid:I,auth:e,email:g,emailVerified:P,displayName:p,isAnonymous:O,photoURL:T,phoneNumber:v,tenantId:b,stsTokenManager:x,createdAt:_,lastLoginAt:y});return L&&Array.isArray(L)&&(k.providerData=L.map(R=>Object.assign({},R))),E&&(k._redirectEventId=E),k}static async _fromIdTokenResponse(e,n,r=!1){const s=new Di;s.updateFromServerResponse(n);const i=new $n({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Au(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];Z(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?KT(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Di;a.updateFromIdToken(r);const l=new $n({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new pp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,d),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d_=new Map;function qn(t){Zn(t instanceof Function,"Expected a class definition");let e=d_.get(t);return e?(Zn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,d_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}GT.type="NONE";const h_=GT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pc(t,e,n){return`firebase:${t}:${e}:${n}`}class ji{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Pc(this.userKey,s.apiKey,i),this.fullPersistenceKey=Pc("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?$n._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ji(qn(h_),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||qn(h_);const o=Pc(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){const p=$n._fromJSON(e,h);d!==i&&(a=p),i=d;break}}catch{}const l=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new ji(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new ji(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(JT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(WT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(XT(e))return"Blackberry";if(ZT(e))return"Webos";if(HT(e))return"Safari";if((e.includes("chrome/")||QT(e))&&!e.includes("edge/"))return"Chrome";if(YT(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function WT(t=We()){return/firefox\//i.test(t)}function HT(t=We()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function QT(t=We()){return/crios\//i.test(t)}function JT(t=We()){return/iemobile/i.test(t)}function YT(t=We()){return/android/i.test(t)}function XT(t=We()){return/blackberry/i.test(t)}function ZT(t=We()){return/webos/i.test(t)}function mg(t=We()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function yD(t=We()){var e;return mg(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function vD(){return aR()&&document.documentMode===10}function e1(t=We()){return mg(t)||YT(t)||ZT(t)||XT(t)||/windows phone/i.test(t)||JT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t1(t,e=[]){let n;switch(t){case"Browser":n=f_(We());break;case"Worker":n=`${f_(We())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ws}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wD(t,e={}){return hn(t,"GET","/v2/passwordPolicy",nr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xD=6;class ED{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:xD,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new p_(this),this.idTokenSubscription=new p_(this),this.beforeStateQueue=new _D(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=FT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=qn(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await ji.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await qT(this,{idToken:e}),r=await $n._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(yn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Z(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Au(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=nD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(yn(this.app))return Promise.reject(Gn(this));const n=e?Pe(e):null;return n&&Z(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Z(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return yn(this.app)?Promise.reject(Gn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return yn(this.app)?Promise.reject(Gn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(qn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await wD(this),n=new ED(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new al("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await gD(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&qn(e)||this._popupRedirectResolver;Z(n,this,"argument-error"),this.redirectPersistenceManager=await ji.create(this,[qn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Z(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Z(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=t1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&Z2(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function ns(t){return Pe(t)}class p_{constructor(e){this.auth=e,this.observer=null,this.addObserver=fR(n=>this.observer=n)}get next(){return Z(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function TD(t){kd=t}function n1(t){return kd.loadJS(t)}function SD(){return kd.recaptchaEnterpriseScript}function kD(){return kd.gapiScript}function bD(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const AD="recaptcha-enterprise",RD="NO_RECAPTCHA";class ND{constructor(e){this.type=AD,this.auth=ns(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{lD(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new aD(l);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;c_(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(RD)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&c_(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=SD();l.length!==0&&(l+=a),n1(l).then(()=>{s(a,i,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function m_(t,e,n,r=!1){const s=new ND(t);let i;try{i=await s.verify(n)}catch{i=await s.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Ru(t,e,n,r){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await m_(t,e,n,n==="getOobCode");return r(t,i)}else return r(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await m_(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CD(t,e){const n=ed(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Ns(i,e??{}))return s;dn(s,"already-initialized")}return n.initialize({options:e})}function PD(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(qn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function DD(t,e,n){const r=ns(t);Z(r._canInitEmulator,r,"emulator-config-failed"),Z(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=r1(e),{host:o,port:a}=jD(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),VD()}function r1(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function jD(t){const e=r1(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:g_(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:g_(o)}}}function g_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function VD(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gg{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Bn("not implemented")}_getIdTokenResponse(e){return Bn("not implemented")}_linkToIdToken(e,n){return Bn("not implemented")}_getReauthenticationResolver(e){return Bn("not implemented")}}async function OD(t,e){return hn(t,"POST","/v1/accounts:update",e)}async function MD(t,e){return hn(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LD(t,e){return vl(t,"POST","/v1/accounts:signInWithPassword",nr(t,e))}async function FD(t,e){return hn(t,"POST","/v1/accounts:sendOobCode",nr(t,e))}async function UD(t,e){return FD(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zD(t,e){return vl(t,"POST","/v1/accounts:signInWithEmailLink",nr(t,e))}async function BD(t,e){return vl(t,"POST","/v1/accounts:signInWithEmailLink",nr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya extends gg{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Ya(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Ya(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ru(e,n,"signInWithPassword",LD);case"emailLink":return zD(e,{email:this._email,oobCode:this._password});default:dn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ru(e,r,"signUpPassword",MD);case"emailLink":return BD(e,{idToken:n,email:this._email,oobCode:this._password});default:dn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vi(t,e){return vl(t,"POST","/v1/accounts:signInWithIdp",nr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $D="http://localhost";class Bs extends gg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Bs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):dn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=dg(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Bs(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Vi(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Vi(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Vi(e,n)}buildRequest(){const e={requestUri:$D,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ll(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qD(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function KD(t){const e=Go(Wo(t)).link,n=e?Go(Wo(e)).deep_link_id:null,r=Go(Wo(t)).deep_link_id;return(r?Go(Wo(r)).link:null)||r||n||e||t}class yg{constructor(e){var n,r,s,i,o,a;const l=Go(Wo(e)),d=(n=l.apiKey)!==null&&n!==void 0?n:null,h=(r=l.oobCode)!==null&&r!==void 0?r:null,p=qD((s=l.mode)!==null&&s!==void 0?s:null);Z(d&&h&&p,"argument-error"),this.apiKey=d,this.operation=p,this.code=h,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=KD(e);try{return new yg(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(){this.providerId=Xs.PROVIDER_ID}static credential(e,n){return Ya._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=yg.parseLink(n);return Z(r,"argument-error"),Ya._fromEmailAndCode(e,r.code,r.tenantId)}}Xs.PROVIDER_ID="password";Xs.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Xs.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l extends s1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr extends _l{constructor(){super("facebook.com")}static credential(e){return Bs._fromParams({providerId:vr.PROVIDER_ID,signInMethod:vr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vr.credentialFromTaggedObject(e)}static credentialFromError(e){return vr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vr.credential(e.oauthAccessToken)}catch{return null}}}vr.FACEBOOK_SIGN_IN_METHOD="facebook.com";vr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r extends _l{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Bs._fromParams({providerId:_r.PROVIDER_ID,signInMethod:_r.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return _r.credentialFromTaggedObject(e)}static credentialFromError(e){return _r.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return _r.credential(n,r)}catch{return null}}}_r.GOOGLE_SIGN_IN_METHOD="google.com";_r.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr extends _l{constructor(){super("github.com")}static credential(e){return Bs._fromParams({providerId:wr.PROVIDER_ID,signInMethod:wr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wr.credentialFromTaggedObject(e)}static credentialFromError(e){return wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wr.credential(e.oauthAccessToken)}catch{return null}}}wr.GITHUB_SIGN_IN_METHOD="github.com";wr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr extends _l{constructor(){super("twitter.com")}static credential(e,n){return Bs._fromParams({providerId:xr.PROVIDER_ID,signInMethod:xr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return xr.credentialFromTaggedObject(e)}static credentialFromError(e){return xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return xr.credential(n,r)}catch{return null}}}xr.TWITTER_SIGN_IN_METHOD="twitter.com";xr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GD(t,e){return vl(t,"POST","/v1/accounts:signUp",nr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await $n._fromIdTokenResponse(e,r,s),o=y_(r);return new $s({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=y_(r);return new $s({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function y_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu extends Rn{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Nu.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Nu(e,n,r,s)}}function i1(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Nu._fromErrorAndOperation(t,i,e,r):i})}async function WD(t,e,n=!1){const r=await zs(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return $s._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o1(t,e,n=!1){const{auth:r}=t;if(yn(r.app))return Promise.reject(Gn(r));const s="reauthenticate";try{const i=await zs(t,i1(r,s,e,t),n);Z(i.idToken,r,"internal-error");const o=pg(i.idToken);Z(o,r,"internal-error");const{sub:a}=o;return Z(t.uid===a,r,"user-mismatch"),$s._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&dn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a1(t,e,n=!1){if(yn(t.app))return Promise.reject(Gn(t));const r="signIn",s=await i1(t,r,e),i=await $s._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function HD(t,e){return a1(ns(t),e)}async function QD(t,e){return o1(Pe(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l1(t){const e=ns(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function JD(t,e,n){const r=ns(t);await Ru(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",UD)}async function YD(t,e,n){if(yn(t.app))return Promise.reject(Gn(t));const r=ns(t),o=await Ru(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",GD).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&l1(t),l}),a=await $s._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function XD(t,e,n){return yn(t.app)?Promise.reject(Gn(t)):HD(Pe(t),Xs.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&l1(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZD(t,e){return hn(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v_(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Pe(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await zs(r,ZD(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function ej(t,e){return tj(Pe(t),null,e)}async function tj(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};n&&(i.password=n);const o=await zs(t,OD(r,i));await t._updateTokensIfNecessary(o,!0)}function nj(t,e,n,r){return Pe(t).onIdTokenChanged(e,n,r)}function rj(t,e,n){return Pe(t).beforeAuthStateChanged(e,n)}function sj(t,e,n,r){return Pe(t).onAuthStateChanged(e,n,r)}function ij(t){return Pe(t).signOut()}const Cu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Cu,"1"),this.storage.removeItem(Cu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oj=1e3,aj=10;class u1 extends c1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=e1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);vD()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,aj):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},oj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}u1.type="LOCAL";const lj=u1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1 extends c1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}d1.type="SESSION";const h1=d1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cj(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new bd(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(n.origin,i)),l=await cj(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}bd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vg(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const d=vg("",20);s.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(p){const g=p;if(g.data.eventId===d)switch(g.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(g.data.response);break;default:clearTimeout(h),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tn(){return window}function dj(t){Tn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f1(){return typeof Tn().WorkerGlobalScope<"u"&&typeof Tn().importScripts=="function"}async function hj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function fj(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function pj(){return f1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1="firebaseLocalStorageDb",mj=1,Pu="firebaseLocalStorage",m1="fbase_key";class wl{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Ad(t,e){return t.transaction([Pu],e?"readwrite":"readonly").objectStore(Pu)}function gj(){const t=indexedDB.deleteDatabase(p1);return new wl(t).toPromise()}function mp(){const t=indexedDB.open(p1,mj);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Pu,{keyPath:m1})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Pu)?e(r):(r.close(),await gj(),e(await mp()))})})}async function __(t,e,n){const r=Ad(t,!0).put({[m1]:e,value:n});return new wl(r).toPromise()}async function yj(t,e){const n=Ad(t,!1).get(e),r=await new wl(n).toPromise();return r===void 0?null:r.value}function w_(t,e){const n=Ad(t,!0).delete(e);return new wl(n).toPromise()}const vj=800,_j=3;class g1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await mp(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>_j)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return f1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=bd._getInstance(pj()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await hj(),!this.activeServiceWorker)return;this.sender=new uj(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||fj()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await mp();return await __(e,Cu,"1"),await w_(e,Cu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>__(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>yj(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>w_(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Ad(s,!1).getAll();return new wl(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),vj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}g1.type="LOCAL";const wj=g1;new yl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xj(t,e){return e?qn(e):(Z(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _g extends gg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Vi(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Vi(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Vi(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Ej(t){return a1(t.auth,new _g(t),t.bypassAuthState)}function Ij(t){const{auth:e,user:n}=t;return Z(n,e,"internal-error"),o1(n,new _g(t),t.bypassAuthState)}async function Tj(t){const{auth:e,user:n}=t;return Z(n,e,"internal-error"),WD(n,new _g(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ej;case"linkViaPopup":case"linkViaRedirect":return Tj;case"reauthViaPopup":case"reauthViaRedirect":return Ij;default:dn(this.auth,"internal-error")}}resolve(e){Zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sj=new yl(2e3,1e4);class Si extends y1{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Si.currentPopupAction&&Si.currentPopupAction.cancel(),Si.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Z(e,this.auth,"internal-error"),e}async onExecution(){Zn(this.filter.length===1,"Popup operations only handle one event");const e=vg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(In(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(In(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Si.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(In(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Sj.get())};e()}}Si.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kj="pendingRedirect",Dc=new Map;class bj extends y1{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Dc.get(this.auth._key());if(!e){try{const r=await Aj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Dc.set(this.auth._key(),e)}return this.bypassAuthState||Dc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Aj(t,e){const n=Cj(e),r=Nj(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function Rj(t,e){Dc.set(t._key(),e)}function Nj(t){return qn(t._redirectPersistence)}function Cj(t){return Pc(kj,t.config.apiKey,t.name)}async function Pj(t,e,n=!1){if(yn(t.app))return Promise.reject(Gn(t));const r=ns(t),s=xj(r,e),o=await new bj(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dj=10*60*1e3;class jj{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Vj(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!v1(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(In(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Dj&&this.cachedEventUids.clear(),this.cachedEventUids.has(x_(e))}saveEventToCache(e){this.cachedEventUids.add(x_(e)),this.lastProcessedEventTime=Date.now()}}function x_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function v1({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Vj(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return v1(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oj(t,e={}){return hn(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Lj=/^https?/;async function Fj(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Oj(t);for(const n of e)try{if(Uj(n))return}catch{}dn(t,"unauthorized-domain")}function Uj(t){const e=fp(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Lj.test(n))return!1;if(Mj.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zj=new yl(3e4,6e4);function E_(){const t=Tn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Bj(t){return new Promise((e,n)=>{var r,s,i;function o(){E_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{E_(),n(In(t,"network-request-failed"))},timeout:zj.get()})}if(!((s=(r=Tn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Tn().gapi)===null||i===void 0)&&i.load)o();else{const a=bD("iframefcb");return Tn()[a]=()=>{gapi.load?o():n(In(t,"network-request-failed"))},n1(`${kD()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw jc=null,e})}let jc=null;function $j(t){return jc=jc||Bj(t),jc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qj=new yl(5e3,15e3),Kj="__/auth/iframe",Gj="emulator/auth/iframe",Wj={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Hj=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Qj(t){const e=t.config;Z(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?fg(e,Gj):`https://${t.config.authDomain}/${Kj}`,r={apiKey:e.apiKey,appName:t.name,v:Ws},s=Hj.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${ll(r).slice(1)}`}async function Jj(t){const e=await $j(t),n=Tn().gapi;return Z(n,t,"internal-error"),e.open({where:document.body,url:Qj(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Wj,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=In(t,"network-request-failed"),a=Tn().setTimeout(()=>{i(o)},qj.get());function l(){Tn().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Xj=500,Zj=600,eV="_blank",tV="http://localhost";class I_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function nV(t,e,n,r=Xj,s=Zj){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},Yj),{width:r.toString(),height:s.toString(),top:i,left:o}),d=We().toLowerCase();n&&(a=QT(d)?eV:n),WT(d)&&(e=e||tV,l.scrollbars="yes");const h=Object.entries(l).reduce((g,[v,T])=>`${g}${v}=${T},`,"");if(yD(d)&&a!=="_self")return rV(e||"",a),new I_(null);const p=window.open(e||"",a,h);Z(p,t,"popup-blocked");try{p.focus()}catch{}return new I_(p)}function rV(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sV="__/auth/handler",iV="emulator/auth/handler",oV=encodeURIComponent("fac");async function T_(t,e,n,r,s,i){Z(t.config.authDomain,t,"auth-domain-config-required"),Z(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ws,eventId:s};if(e instanceof s1){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",hR(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof _l){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await t._getAppCheckToken(),d=l?`#${oV}=${encodeURIComponent(l)}`:"";return`${aV(t)}?${ll(a).slice(1)}${d}`}function aV({config:t}){return t.emulator?fg(t,iV):`https://${t.authDomain}/${sV}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fh="webStorageSupport";class lV{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=h1,this._completeRedirectFn=Pj,this._overrideRedirectResult=Rj}async _openPopup(e,n,r,s){var i;Zn((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await T_(e,n,r,fp(),s);return nV(e,o,vg())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await T_(e,n,r,fp(),s);return dj(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Zn(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Jj(e),r=new jj(e);return n.register("authEvent",s=>(Z(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Fh,{type:Fh},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Fh];o!==void 0&&n(!!o),dn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Fj(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return e1()||HT()||mg()}}const cV=lV;var S_="@firebase/auth",k_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Z(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dV(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function hV(t){Cs(new zr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Z(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:t1(t)},d=new ID(r,s,i,l);return PD(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Cs(new zr("auth-internal",e=>{const n=ns(e.getProvider("auth").getImmediate());return(r=>new uV(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),En(S_,k_,dV(t)),En(S_,k_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fV=5*60,pV=IE("authIdTokenMaxAge")||fV;let b_=null;const mV=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>pV)return;const s=n==null?void 0:n.token;b_!==s&&(b_=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function gV(t=RE()){const e=ed(t,"auth");if(e.isInitialized())return e.getImmediate();const n=CD(t,{popupRedirectResolver:cV,persistence:[wj,lj,h1]}),r=IE("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=mV(i.toString());rj(n,o,()=>o(n.currentUser)),nj(n,a=>o(a))}}const s=xE("auth");return s&&DD(n,`http://${s}`),n}function yV(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}TD({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=In("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",yV().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});hV("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _1="firebasestorage.googleapis.com",vV="storageBucket",_V=2*60*1e3,wV=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn extends Rn{constructor(e,n,r=0){super(Uh(e),`Firebase Storage: ${n} (${Uh(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Nn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Uh(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var An;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(An||(An={}));function Uh(t){return"storage/"+t}function xV(){const t="An unknown error occurred, please check the error payload for server response.";return new Nn(An.UNKNOWN,t)}function EV(){return new Nn(An.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function IV(){return new Nn(An.CANCELED,"User canceled the upload/download.")}function TV(t){return new Nn(An.INVALID_URL,"Invalid URL '"+t+"'.")}function SV(t){return new Nn(An.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function A_(t){return new Nn(An.INVALID_ARGUMENT,t)}function w1(){return new Nn(An.APP_DELETED,"The Firebase app was deleted.")}function kV(t){return new Nn(An.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=on.makeFromUrl(e,n)}catch{return new on(e,"")}if(r.path==="")return r;throw SV(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function d(P){P.path_=decodeURIComponent(P.path)}const h="v[A-Za-z0-9_]+",p=n.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",v=new RegExp(`^https?://${p}/${h}/b/${s}/o${g}`,"i"),T={bucket:1,path:3},b=n===_1?"(?:storage.googleapis.com|storage.cloud.google.com)":n,E="([^?#]*)",_=new RegExp(`^https?://${b}/${s}/${E}`,"i"),I=[{regex:a,indices:l,postModify:i},{regex:v,indices:T,postModify:d},{regex:_,indices:{bucket:1,path:2},postModify:d}];for(let P=0;P<I.length;P++){const O=I[P],L=O.regex.exec(e);if(L){const S=L[O.indices.bucket];let x=L[O.indices.path];x||(x=""),r=new on(S,x),O.postModify(r);break}}if(r==null)throw TV(e);return r}}class bV{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AV(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let d=!1;function h(...E){d||(d=!0,e.apply(null,E))}function p(E){s=setTimeout(()=>{s=null,t(v,l())},E)}function g(){i&&clearTimeout(i)}function v(E,..._){if(d){g();return}if(E){g(),h.call(null,E,..._);return}if(l()||o){g(),h.call(null,E,..._);return}r<64&&(r*=2);let I;a===1?(a=2,I=0):I=(r+Math.random())*1e3,p(I)}let T=!1;function b(E){T||(T=!0,g(),!d&&(s!==null?(E||(a=2),clearTimeout(s),p(0)):E||(a=1)))}return p(0),i=setTimeout(()=>{o=!0,b(!0)},n),b}function RV(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NV(t){return t!==void 0}function R_(t,e,n,r){if(r<e)throw A_(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw A_(`Invalid value for '${t}'. Expected ${n} or less.`)}function CV(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Du;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Du||(Du={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PV(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DV{constructor(e,n,r,s,i,o,a,l,d,h,p,g=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=p,this.retry=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,T)=>{this.resolve_=v,this.reject_=T,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new cc(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Du.NO_ERROR,l=i.getStatus();if(!a||PV(l,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===Du.ABORT;r(!1,new cc(!1,null,h));return}const d=this.successCodes_.indexOf(l)!==-1;r(!0,new cc(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());NV(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=xV();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?w1():IV();o(l)}else{const l=EV();o(l)}};this.canceled_?n(!1,new cc(!1,null,!0)):this.backoffId_=AV(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&RV(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class cc{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function jV(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function VV(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function OV(t,e){e&&(t["X-Firebase-GMPID"]=e)}function MV(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function LV(t,e,n,r,s,i,o=!0){const a=CV(t.urlParams),l=t.url+a,d=Object.assign({},t.headers);return OV(d,e),jV(d,n),VV(d,i),MV(d,r),new DV(l,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FV(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function UV(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,n){this._service=e,n instanceof on?this._location=n:this._location=on.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ju(e,n)}get root(){const e=new on(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return UV(this._location.path)}get storage(){return this._service}get parent(){const e=FV(this._location.path);if(e===null)return null;const n=new on(this._location.bucket,e);return new ju(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw kV(e)}}function N_(t,e){const n=e==null?void 0:e[vV];return n==null?null:on.makeFromBucketSpec(n,t)}function zV(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:tR(s,t.app.options.projectId))}class BV{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=_1,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=_V,this._maxUploadRetryTime=wV,this._requests=new Set,s!=null?this._bucket=on.makeFromBucketSpec(s,this._host):this._bucket=N_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=on.makeFromBucketSpec(this._url,e):this._bucket=N_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){R_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){R_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ju(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new bV(w1());{const o=LV(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const C_="@firebase/storage",P_="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x1="storage";function $V(t=RE(),e){t=Pe(t);const r=ed(t,x1).getImmediate({identifier:e}),s=ZA("storage");return s&&qV(r,...s),r}function qV(t,e,n,r={}){zV(t,e,n,r)}function KV(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new BV(n,r,s,e,Ws)}function GV(){Cs(new zr(x1,KV,"PUBLIC").setMultipleInstances(!0)),En(C_,P_,""),En(C_,P_,"esm2017")}GV();const WV={apiKey:"AIzaSyAD_KizCwatRLLdqJFImEhMPMwUEkTR-3g",authDomain:"recet-up.firebaseapp.com",projectId:"recet-up",storageBucket:"recet-up.firebasestorage.app",messagingSenderId:"448988440440",appId:"1:448988440440:web:3fb31057e5702c8ac40a8d",measurementId:"G-6VEW0Y1VE8"},wg=AE(WV),fr=gV(wg),re=b2(wg,{localCache:K2({tabManager:Q2()})});$V(wg);const HV=(t,e)=>{const n=Ge(re,"conversations");return Ys(n,Id("lastMessageAt","desc"))},QV=t=>{const e=Ge(re,"messages");return Ys(e,gl("conversationId","==",t),Id("createdAt","asc"))},E1=C.createContext(void 0),JV=({children:t})=>{const[e,n]=C.useState(null),[r,s]=C.useState([]),[i,o]=C.useState(!0);C.useEffect(()=>{(async()=>{try{const T=Ge(re,"users"),E=(await Ja(T)).docs.map(_=>({uid:_.id,..._.data()}));s(E)}catch(T){console.error("Error fetching users:",T),s([])}})()},[]),C.useEffect(()=>{const v=sj(fr,async T=>{if(T)try{const E=(await Qa(Me(re,"users",T.uid))).data(),_={uid:T.uid,email:T.email,displayName:(E==null?void 0:E.displayName)||T.displayName,photoURL:(E==null?void 0:E.photoURL)||T.photoURL,bio:(E==null?void 0:E.bio)||"",phone:(E==null?void 0:E.phone)||"",location:(E==null?void 0:E.location)||"",following:(E==null?void 0:E.following)||[],followers:(E==null?void 0:E.followers)||[]};n(_),localStorage.setItem("user",JSON.stringify(_))}catch(b){console.error("Error fetching user data:",b),n(null),localStorage.removeItem("user")}else n(null),localStorage.removeItem("user");o(!1)});return()=>v()},[]);const a=async(v,T,b)=>{try{const E=await YD(fr,v,T),{user:_}=E;await v_(_,{displayName:b});const y={uid:_.uid,email:_.email,displayName:b,photoURL:`https://api.dicebear.com/7.x/avataaars/svg?seed=${_.uid}`,bio:"",phone:"",location:"",following:[],followers:[],createdAt:new Date().toISOString()};await B2(Me(re,"users",_.uid),y),n(y),s(I=>[...I,y]),localStorage.setItem("user",JSON.stringify(y))}catch(E){throw console.error("Error signing up:",E),E}},l=async(v,T)=>{try{const b=await XD(fr,v,T),{user:E}=b,y=(await Qa(Me(re,"users",E.uid))).data(),I={uid:E.uid,email:E.email,displayName:(y==null?void 0:y.displayName)||E.displayName,photoURL:(y==null?void 0:y.photoURL)||E.photoURL,bio:(y==null?void 0:y.bio)||"",phone:(y==null?void 0:y.phone)||"",location:(y==null?void 0:y.location)||"",following:(y==null?void 0:y.following)||[],followers:(y==null?void 0:y.followers)||[]};n(I),localStorage.setItem("user",JSON.stringify(I))}catch(b){throw console.error("Error signing in:",b),b}},d=async()=>{try{await ij(fr),n(null),localStorage.removeItem("user")}catch(v){throw console.error("Error signing out:",v),v}},h=async v=>{if(!(e!=null&&e.uid))throw new Error("No authenticated user");try{const T=Me(re,"users",e.uid);await kt(T,{...v,updatedAt:new Date().toISOString()}),fr.currentUser&&(v.displayName||v.photoURL)&&await v_(fr.currentUser,{displayName:v.displayName||void 0,photoURL:v.photoURL||void 0});const b={...e,...v};n(b),s(E=>E.map(_=>_.uid===e.uid?b:_)),localStorage.setItem("user",JSON.stringify(b))}catch(T){throw console.error("Error updating profile:",T),T}},p=async v=>{if(!(e!=null&&e.uid))throw new Error("Must be logged in to follow users");try{const T=Me(re,"users",e.uid),b=Me(re,"users",v);await kt(T,{following:dp(v)}),await kt(b,{followers:dp(e.uid)});const E={...e,following:[...e.following||[],v]};n(E),s(_=>_.map(y=>y.uid===e.uid?E:y.uid===v?{...y,followers:[...y.followers||[],e.uid]}:y))}catch(T){throw console.error("Error following user:",T),T}},g=async v=>{if(!(e!=null&&e.uid))throw new Error("Must be logged in to unfollow users");try{const T=Me(re,"users",e.uid),b=Me(re,"users",v);await kt(T,{following:hp(v)}),await kt(b,{followers:hp(e.uid)});const E={...e,following:(e.following||[]).filter(_=>_!==v)};n(E),s(_=>_.map(y=>y.uid===e.uid?E:y.uid===v?{...y,followers:(y.followers||[]).filter(I=>I!==e.uid)}:y))}catch(T){throw console.error("Error unfollowing user:",T),T}};return u.jsx(E1.Provider,{value:{user:e,users:r,loading:i,signUp:a,signIn:l,signOut:d,updateProfile:h,followUser:p,unfollowUser:g},children:t})},_e=()=>{const t=C.useContext(E1);if(t===void 0)throw new Error("useUser must be used within a UserProvider");return t},I1=C.createContext(void 0),YV=({children:t})=>{const[e,n]=C.useState([]),{user:r}=_e();C.useEffect(()=>{if(!(r!=null&&r.uid)){n([]);return}const l=Ge(re,"notifications"),d=Ys(l,gl("userId","==",r.uid)),h=ku(d,p=>{const g=p.docs.map(v=>({id:v.id,...v.data()}));n(g.sort((v,T)=>new Date(T.createdAt).getTime()-new Date(v.createdAt).getTime()))});return()=>h()},[r==null?void 0:r.uid]);const s=e.filter(l=>!l.read).length,i=async l=>{if(!(r!=null&&r.uid))return;const d=Me(re,"notifications",l);await kt(d,{read:!0})},o=async()=>{if(!(r!=null&&r.uid))return;const d=e.filter(h=>!h.read).map(h=>kt(Me(re,"notifications",h.id),{read:!0}));await Promise.all(d)},a=async l=>{if(!(r!=null&&r.uid))return;const d=Ge(re,"notifications");await Kr(d,{...l,read:!1,createdAt:bt()})};return u.jsx(I1.Provider,{value:{notifications:e,unreadCount:s,markAsRead:i,markAllAsRead:o,addNotification:a},children:t})},Rd=()=>{const t=C.useContext(I1);if(t===void 0)throw new Error("useNotifications must be used within a NotificationProvider");return t};function ro(t){if(!t)return"";const n=Math.floor((new Date().getTime()-t.getTime())/1e3);if(n<60)return" l'instant";const r=Math.floor(n/60);if(r<60)return`${r}m`;const s=Math.floor(r/60);if(s<24)return`${s}h`;const i=Math.floor(s/24);return i<7?`${i}j`:t.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})}const T1=({onClose:t})=>{const{notifications:e,markAllAsRead:n}=Rd(),[r,s]=Lr.useState(!1);return C.useEffect(()=>{(async()=>{r||(await n(),s(!0))})()},[r,n]),u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50",onClick:t,children:u.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-sm bg-white dark:bg-gray-800 shadow-lg",onClick:i=>i.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold dark:text-white",children:"Notifications"}),u.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:u.jsx(Jr,{size:20})})]}),u.jsx("div",{className:"overflow-y-auto h-full pb-20",children:e.length===0?u.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"Aucune notification"}):u.jsx("div",{className:"divide-y dark:divide-gray-700",children:e.map(i=>u.jsxs("div",{className:`p-4 ${i.read?"bg-white dark:bg-gray-800":"bg-blue-50 dark:bg-blue-900/20"}`,children:[u.jsx("p",{className:"text-gray-900 dark:text-white",children:i.message}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:ro(new Date(i.createdAt))})]},i.id))})})]})})},S1=C.createContext(void 0),XV=({children:t})=>{const[e,n]=C.useState([]),[r,s]=C.useState([]),{user:i,users:o}=_e(),{addNotification:a}=Rd(),l=C.useCallback(async()=>{var E;if(i)try{const _=Ge(re,"recipes"),I=(await Ja(_)).docs.map(S=>{var x,k;return{id:S.id,...S.data(),createdAt:((x=S.data().createdAt)==null?void 0:x.toDate())||new Date,updatedAt:((k=S.data().updatedAt)==null?void 0:k.toDate())||new Date}}),P=Me(re,"users",i.uid),L=((E=(await Qa(P)).data())==null?void 0:E.favorites)||[];n(I),s(L)}catch(_){console.error("Error fetching recipes:",_)}},[i]),d=async E=>{if(!i)throw new Error("Must be logged in to add recipes");try{const _={...E,authorId:i.uid,createdAt:bt(),updatedAt:bt(),rating:0,totalRatings:0,userRatings:{}},y=await Kr(Ge(re,"recipes"),_),I=o.find(L=>L.uid===i.uid),P=(I==null?void 0:I.displayName)||"Un utilisateur",O=o.filter(L=>{var S;return(S=L.following)==null?void 0:S.includes(i.uid)});for(const L of O)await a({userId:L.uid,type:"recipe_new",message:`${P} a publi une nouvelle recette : ${E.title}`,linkTo:`/recipe/${y.id}`});return n(L=>[...L,{id:y.id,..._,createdAt:new Date,updatedAt:new Date}]),y.id}catch(_){throw console.error("Error adding recipe:",_),_}},h=async(E,_)=>{try{const y=Me(re,"recipes",E);await kt(y,{..._,updatedAt:bt()}),n(I=>I.map(P=>P.id===E?{...P,..._,updatedAt:new Date}:P))}catch(y){throw console.error("Error updating recipe:",y),y}},p=async E=>{try{await OT(Me(re,"recipes",E)),n(_=>_.filter(y=>y.id!==E))}catch(_){throw console.error("Error deleting recipe:",_),_}},g=async E=>{if(i)try{const _=Me(re,"users",i.uid);r.includes(E)?(await kt(_,{favorites:hp(E)}),s(I=>I.filter(P=>P!==E))):(await kt(_,{favorites:dp(E)}),s(I=>[...I,E]))}catch(_){throw console.error("Error toggling favorite:",_),_}},v=async(E,_)=>{var y;if(!i)throw new Error("Must be logged in to rate recipes");try{const I=Me(re,"recipes",E),P=await Qa(I);if(!P.exists())throw new Error("Recipe not found");const O=P.data(),L=((y=O.userRatings)==null?void 0:y[i.uid])||0,S=L===0,k=(O.rating||0)*(O.totalRatings||0)-L+_,R=S?(O.totalRatings||0)+1:O.totalRatings||0,N=k/R;await kt(I,{[`userRatings.${i.uid}`]:_,rating:N,totalRatings:R,updatedAt:bt()}),n(D=>D.map(A=>A.id===E?{...A,rating:N,totalRatings:R,userRatings:{...A.userRatings,[i.uid]:_},updatedAt:new Date}:A))}catch(I){throw console.error("Error rating recipe:",I),I}},T=async(E,_)=>{if(i)try{const y=Ge(re,"comments");await Kr(y,{recipeId:E,userId:i.uid,content:_,createdAt:bt()})}catch(y){throw console.error("Error adding comment:",y),y}},b=async E=>{try{const _=Ge(re,"comments"),y=Ys(_,gl("recipeId","==",E));return(await Ja(y)).docs.map(P=>{var O;return{id:P.id,...P.data(),createdAt:(O=P.data().createdAt)==null?void 0:O.toDate()}})}catch(_){return console.error("Error fetching comments:",_),[]}};return u.jsx(S1.Provider,{value:{recipes:e,favorites:r,addRecipe:d,updateRecipe:h,deleteRecipe:p,fetchRecipes:l,toggleFavorite:g,rateRecipe:v,addComment:T,getComments:b},children:t})},fn=()=>{const t=C.useContext(S1);if(t===void 0)throw new Error("useRecipes must be used within a RecipeProvider");return t},zh=({icon:t,label:e,active:n,onClick:r})=>u.jsxs("button",{onClick:r,className:`flex items-center px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${n?"bg-accent/10 text-accent":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[u.jsx("span",{className:"mr-1.5",children:t}),e]}),ZV=({query:t,activeTab:e,recipes:n,users:r,onRecipeClick:s,onUserClick:i})=>t.trim()?e==="recipes"&&n.length===0?u.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:"Aucune recette trouve"}):e==="users"&&r.length===0?u.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:"Aucun utilisateur trouv"}):u.jsx("div",{className:"max-h-[calc(100vh-300px)] overflow-y-auto",children:e==="recipes"?u.jsx("div",{className:"divide-y dark:divide-gray-700",children:n.map(o=>u.jsxs("button",{onClick:()=>s(o.id),className:"w-full p-4 flex items-start space-x-4 hover:bg-gray-50 dark:hover:bg-gray-700 text-left transition-colors",children:[u.jsx("img",{src:o.imageUrl,alt:o.title,className:"w-16 h-16 rounded-lg object-cover flex-shrink-0"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:"font-medium text-gray-900 dark:text-white truncate",children:o.title}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 line-clamp-2 mt-1",children:o.description}),u.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-500 dark:text-gray-400",children:[u.jsxs("span",{className:"flex items-center",children:[u.jsx(Gs,{size:14,className:"mr-1"}),o.prepTime+o.cookTime," min"]}),u.jsxs("span",{className:"flex items-center",children:[u.jsx(Sn,{size:14,className:"mr-1"}),o.servings," portions"]})]})]})]},o.id))}):u.jsx("div",{className:"divide-y dark:divide-gray-700",children:r.map(o=>u.jsxs("button",{onClick:()=>i(o.uid),className:"w-full p-4 flex items-center space-x-4 hover:bg-gray-50 dark:hover:bg-gray-700 text-left transition-colors",children:[u.jsx("img",{src:o.photoURL||`https://api.dicebear.com/7.x/avataaars/svg?seed=${o.uid}`,alt:o.displayName||"",className:"w-12 h-12 rounded-full object-cover flex-shrink-0"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:o.displayName}),o.bio&&u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate mt-1",children:o.bio})]})]},o.uid))})}):u.jsxs("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:["Commencez  taper pour rechercher des ",e==="recipes"?"recettes":"utilisateurs"]}),k1=({onClose:t,onRecipeClick:e,onUserClick:n})=>{const[r,s]=C.useState(""),[i,o]=C.useState("all"),[a,l]=C.useState("recipes"),{recipes:d,favorites:h}=fn(),{user:p,users:g}=_e(),v=_=>{_.stopPropagation()},T=()=>{if(!r.trim())return[];const _=r.toLowerCase();let y=d;switch(i){case"my-recipes":y=d.filter(I=>I.authorId===(p==null?void 0:p.uid));break;case"favorites":y=d.filter(I=>h.includes(I.id));break;case"all":y=d.filter(I=>!I.isPrivate||I.authorId===(p==null?void 0:p.uid));break}return y.filter(I=>I.title.toLowerCase().includes(_)||I.description.toLowerCase().includes(_))},b=()=>{if(!r.trim()||!g)return[];const _=r.toLowerCase();return g.filter(y=>{var I,P,O;return(((I=y.displayName)==null?void 0:I.toLowerCase())||"").includes(_)||(((P=y.email)==null?void 0:P.toLowerCase())||"").includes(_)||(((O=y.bio)==null?void 0:O.toLowerCase())||"").includes(_)})},E=(_,y)=>{_==="recipe"?e(y):n(y),t()};return C.useEffect(()=>{const _=y=>{y.key==="Escape"&&t()};return document.addEventListener("keydown",_),()=>document.removeEventListener("keydown",_)},[t]),u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-start justify-center pt-20",onClick:t,children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-2xl rounded-lg shadow-xl mx-4",onClick:v,children:[u.jsxs("div",{className:"p-4 border-b dark:border-gray-700",children:[u.jsxs("div",{className:"relative flex items-center",children:[u.jsx(cu,{className:"absolute left-3 text-gray-400",size:20}),u.jsx("input",{type:"text",value:r,onChange:_=>s(_.target.value),placeholder:"Rechercher...",className:"w-full pl-10 pr-10 py-2 bg-gray-100 dark:bg-gray-700 border-none rounded-lg focus:ring-2 focus:ring-accent text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400",autoFocus:!0}),r&&u.jsx("button",{onClick:()=>s(""),className:"absolute right-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(Jr,{size:20})})]}),u.jsxs("div",{className:"flex items-center space-x-2 mt-4",children:[u.jsxs("button",{onClick:()=>l("recipes"),className:`px-4 py-2 rounded-lg text-sm font-medium flex items-center ${a==="recipes"?"bg-accent text-white":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[u.jsx(ja,{size:16,className:"mr-2"}),"Recettes"]}),u.jsxs("button",{onClick:()=>l("users"),className:`px-4 py-2 rounded-lg text-sm font-medium flex items-center ${a==="users"?"bg-accent text-white":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[u.jsx(qi,{size:16,className:"mr-2"}),"Utilisateurs"]})]}),a==="recipes"&&u.jsxs("div",{className:"flex items-center space-x-2 mt-3",children:[u.jsx(zh,{icon:u.jsx(hE,{size:16}),label:"Toutes",active:i==="all",onClick:()=>o("all")}),u.jsx(zh,{icon:u.jsx(ja,{size:16}),label:"Mes recettes",active:i==="my-recipes",onClick:()=>o("my-recipes")}),u.jsx(zh,{icon:u.jsx(Xu,{size:16}),label:"Favoris",active:i==="favorites",onClick:()=>o("favorites")})]})]}),u.jsx(ZV,{query:r,activeTab:a,recipes:T(),users:b(),onRecipeClick:_=>E("recipe",_),onUserClick:_=>E("user",_)})]})})},eO=()=>{const t=Vt(),e=il(),{user:n}=_e(),{unreadCount:r}=Rd(),[s,i]=Lr.useState(!1),[o,a]=Lr.useState(!1),l=e.pathname==="/",d=h=>{t(h)};return l?u.jsxs("header",{className:"fixed top-0 left-0 right-0 bg-white dark:bg-gray-800 z-30 border-b dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center justify-between px-4 h-16",children:[u.jsx("h1",{className:"text-xl font-bold text-accent",children:"Recet'Up"}),u.jsx("div",{className:"flex items-center space-x-4",children:n?u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>a(!0),className:"text-gray-600 dark:text-gray-300 hover:text-accent",children:u.jsx(cu,{size:24})}),u.jsxs("button",{onClick:()=>i(!0),className:"text-gray-600 dark:text-gray-300 hover:text-accent relative",children:[u.jsx(hm,{size:24}),r>0&&u.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center",children:r})]}),u.jsx("button",{onClick:()=>t(`/user/${n.uid}`),className:"w-8 h-8 rounded-full overflow-hidden hover:ring-2 hover:ring-accent transition-all",children:u.jsx("img",{src:n.photoURL||`https://api.dicebear.com/7.x/avataaars/svg?seed=${n.uid}`,alt:"Profile",className:"w-full h-full object-cover"})})]}):u.jsxs("button",{onClick:()=>t("/auth"),className:"flex items-center space-x-2 px-4 py-2 rounded-lg bg-accent text-white hover:bg-accent-dark transition-colors",children:[u.jsx(qi,{size:20}),u.jsx("span",{children:"Connexion"})]})})]}),s&&u.jsx(T1,{onClose:()=>i(!1)}),o&&u.jsx(k1,{onClose:()=>a(!1),onRecipeClick:h=>{t(`/recipe/${h}`),a(!1)},onUserClick:h=>{t(`/user/${h}`),a(!1)}})]}):u.jsxs("header",{className:"fixed top-0 left-0 right-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 py-3 flex items-center justify-between z-10",children:[u.jsx("div",{className:"flex items-center",children:u.jsx("h1",{onClick:()=>d("/"),className:"text-xl font-bold text-accent cursor-pointer",children:"Recet'Up"})}),u.jsx("div",{className:"flex items-center space-x-4",children:n?u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>a(!0),className:"text-gray-600 dark:text-gray-300 hover:text-accent dark:hover:text-accent",children:u.jsx(cu,{size:24})}),u.jsx("button",{onClick:()=>t(`/user/${n.uid}`),className:"w-8 h-8 rounded-full overflow-hidden hover:ring-2 hover:ring-accent transition-all",children:u.jsx("img",{src:n.photoURL||`https://api.dicebear.com/7.x/avataaars/svg?seed=${n.uid}`,alt:"Profile",className:"w-full h-full object-cover"})})]}):u.jsxs("button",{onClick:()=>d("/auth"),className:"flex items-center space-x-2 px-4 py-2 rounded-lg bg-accent text-white hover:bg-accent-dark transition-colors",children:[u.jsx(qi,{size:20}),u.jsx("span",{children:"Connexion"})]})})]})},li=({icon:t,label:e,isActive:n,onClick:r})=>u.jsxs("button",{onClick:r,className:`flex flex-col items-center justify-center w-16 ${n?"text-accent":"text-gray-600 dark:text-gray-400"}`,children:[t,u.jsx("span",{className:"text-xs mt-1",children:e})]}),tO=()=>{const t=Vt(),e=il(),{user:n}=_e(),r=e.pathname,s=i=>{t(i)};return n?u.jsxs("nav",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 h-16 flex items-center justify-around shadow-lg z-10",children:[u.jsx(li,{icon:u.jsx(Uv,{size:24}),label:"Accueil",isActive:r==="/",onClick:()=>s("/")}),u.jsx(li,{icon:u.jsx(ja,{size:24}),label:"Mes Recettes",isActive:r==="/my-recipes",onClick:()=>s("/my-recipes")}),u.jsx("div",{className:"relative -mt-8",children:u.jsx("button",{onClick:()=>s("/create"),className:"bg-accent text-white p-4 rounded-full shadow-lg hover:bg-accent-dark transition-all",children:u.jsx(Va,{size:24})})}),u.jsx(li,{icon:u.jsx(Sn,{size:24}),label:"Abonnements",isActive:r==="/following",onClick:()=>s("/following")}),u.jsx(li,{icon:u.jsx(BA,{size:24}),label:"Paramtres",isActive:r==="/settings",onClick:()=>s("/settings")})]}):u.jsxs("nav",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 h-16 flex items-center justify-around shadow-lg z-10",children:[u.jsx(li,{icon:u.jsx(Uv,{size:24}),label:"Accueil",isActive:r==="/",onClick:()=>s("/")}),u.jsx(li,{icon:u.jsx(fE,{size:24}),label:"Connexion",isActive:r==="/auth",onClick:()=>s("/auth")})]})},D_="https://images.unsplash.com/photo-1495521821757-a1efb6729352?auto=format&fit=crop&q=80&w=800&h=600",nO={soup:"Soupe",starter:"Entre",main:"Plat",dessert:"Dessert",other:"Autre"},Nd=({recipe:t})=>{const e=Vt(),{favorites:n,toggleFavorite:r}=fn(),{users:s}=_e(),i=n.includes(t.id),o=s.find(d=>d.uid===t.authorId),a=async d=>{d.stopPropagation();try{await r(t.id)}catch(h){console.error("Error toggling favorite:",h)}},l=d=>{d.currentTarget.src=D_};return u.jsxs("article",{onClick:()=>e(`/recipe/${t.id}`),className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-300 cursor-pointer group",children:[u.jsxs("div",{className:"relative h-48",children:[u.jsx("img",{src:t.imageUrl||D_,alt:t.title,className:"w-full h-full object-cover",onError:l}),u.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/0 to-black/0"}),u.jsx("button",{onClick:a,className:"absolute top-2 right-2 p-2 rounded-full bg-white/90 dark:bg-gray-800/90 opacity-0 group-hover:opacity-100 transition-opacity",children:u.jsx(Xu,{size:20,className:i?"fill-red-500 text-red-500":"text-gray-600 dark:text-gray-300"})}),t.isPrivate&&u.jsx("span",{className:"absolute top-2 left-2 bg-black/50 text-white px-2 py-1 rounded-full text-xs",children:"Priv"}),u.jsxs("span",{className:"absolute bottom-2 left-2 bg-accent text-white px-2 py-1 rounded-full text-xs flex items-center",children:[u.jsx(Ki,{size:12,className:"mr-1"}),nO[t.category]]})]}),u.jsxs("div",{className:"p-4",children:[u.jsx("h3",{className:"font-semibold text-lg mb-2 dark:text-white line-clamp-1",children:t.title}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-3 line-clamp-2",children:t.description}),u.jsxs("div",{className:"flex items-center justify-between text-sm",children:[u.jsxs("div",{className:"flex items-center space-x-4 text-gray-500 dark:text-gray-400",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(Gs,{size:16,className:"mr-1"}),u.jsxs("span",{children:[t.prepTime+t.cookTime," min"]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx(Sn,{size:16,className:"mr-1"}),u.jsx("span",{children:t.servings})]})]}),u.jsx("button",{onClick:d=>{d.stopPropagation(),e(`/user/${t.authorId}`)},className:"text-sm text-accent hover:text-accent-dark truncate max-w-[120px]",children:(o==null?void 0:o.displayName)||"Utilisateur"})]})]})]})},Oi=({icon:t,label:e,active:n,onClick:r,disabled:s=!1,compact:i=!1})=>u.jsxs("button",{onClick:r,disabled:s,className:`flex items-center whitespace-nowrap ${i?"px-3 py-1.5 text-xs":"px-4 py-2 text-sm"} rounded-full font-medium transition-colors ${n?"bg-accent text-white":s?"bg-gray-100 text-gray-400 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[u.jsx("span",{className:`${i?"mr-1":"mr-2"}`,children:t}),e]}),j_=[{value:"all",label:"Tout"},{value:"soup",label:"Soupes"},{value:"starter",label:"Entres"},{value:"main",label:"Plats"},{value:"dessert",label:"Desserts"},{value:"other",label:"Autres"}],rO=({activeCategory:t,onCategoryChange:e,isMobile:n=!1})=>n?u.jsx("div",{className:"grid grid-cols-2 gap-2",children:j_.map(r=>u.jsxs("button",{onClick:()=>e(r.value),className:`flex items-center justify-center px-3 py-2 rounded-lg text-sm font-medium ${t===r.value?"bg-accent text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300"}`,children:[u.jsx(Ki,{size:14,className:"mr-1.5"}),r.label]},r.value))}):u.jsx("div",{className:"flex items-center space-x-2 overflow-x-auto scrollbar-hide py-2",children:j_.map(r=>u.jsxs("button",{onClick:()=>e(r.value),className:`flex items-center px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap ${t===r.value?"bg-accent text-white":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[u.jsx(Ki,{size:14,className:"mr-1.5"}),r.label]},r.value))}),sO=({showSearch:t,setShowSearch:e,showNotifications:n,setShowNotifications:r})=>{const s=Vt(),{user:i}=_e(),{unreadCount:o}=Rd();return u.jsx("header",{className:"fixed top-0 left-0 right-0 bg-white dark:bg-gray-800 z-30",children:u.jsxs("div",{className:"flex items-center justify-between px-4 h-16 border-b dark:border-gray-700",children:[u.jsx("h1",{className:"text-xl font-bold text-accent",children:"Recet'Up"}),u.jsx("div",{className:"flex items-center space-x-4",children:i?u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>e(!0),className:"text-gray-600 dark:text-gray-300 hover:text-accent",children:u.jsx(cu,{size:24})}),u.jsxs("button",{onClick:()=>r(!0),className:"text-gray-600 dark:text-gray-300 hover:text-accent relative",children:[u.jsx(hm,{size:24}),o>0&&u.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center",children:o})]}),u.jsx("button",{onClick:()=>s(`/user/${i.uid}`),className:"w-8 h-8 rounded-full overflow-hidden hover:ring-2 hover:ring-accent transition-all",children:u.jsx("img",{src:i.photoURL||`https://api.dicebear.com/7.x/avataaars/svg?seed=${i.uid}`,alt:"Profile",className:"w-full h-full object-cover"})})]}):u.jsxs("button",{onClick:()=>s("/auth"),className:"flex items-center space-x-2 px-4 py-2 rounded-lg bg-accent text-white hover:bg-accent-dark transition-colors",children:[u.jsx(qi,{size:20}),u.jsx("span",{children:"Connexion"})]})})]})})};function iO(){const[t,e]=C.useState("up"),[n,r]=C.useState(0);return C.useEffect(()=>{const s=()=>{const i=window.scrollY,o=i>n?"down":"up";o!==t&&(i-n>10||i-n<-10)&&e(o),r(i>0?i:0)};return window.addEventListener("scroll",s),()=>window.removeEventListener("scroll",s)},[t,n]),t}const oO=()=>{const t=Vt(),{recipes:e,favorites:n,fetchRecipes:r}=fn(),{user:s}=_e(),[i,o]=C.useState(!0),[a,l]=C.useState(null),[d,h]=C.useState("all"),[p,g]=C.useState("all"),[v,T]=C.useState(!1),[b,E]=C.useState(!1),[_,y]=C.useState(!1),I=iO();C.useEffect(()=>{(async()=>{try{o(!0),l(null),await r()}catch(L){l("Une erreur est survenue lors du chargement des recettes"),console.error("Error fetching recipes:",L)}finally{o(!1)}})()},[r]);const P=Lr.useMemo(()=>{const O=e.filter(x=>!x.isPrivate||s&&x.authorId===s.uid),S=[...p==="all"?O:O.filter(x=>x.category===p)].sort((x,k)=>k.createdAt.getTime()-x.createdAt.getTime());if(!s)return S;switch(d){case"following":return S.filter(x=>{var k;return(k=s.following)==null?void 0:k.includes(x.authorId)});case"favorites":return S.filter(x=>n.includes(x.id));default:return S}},[e,s,n,d,p]);return i?u.jsx("div",{className:"flex-1 flex items-center justify-center",children:u.jsx("div",{className:"w-8 h-8 border-4 border-accent border-t-transparent rounded-full animate-spin"})}):a?u.jsx("div",{className:"flex-1 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("p",{className:"text-red-500 dark:text-red-400",children:a}),u.jsx("button",{onClick:()=>r(),className:"mt-4 px-4 py-2 bg-accent text-white rounded-lg hover:bg-accent-dark",children:"Ressayer"})]})}):u.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-900",children:[u.jsx(sO,{showSearch:v,setShowSearch:T,showNotifications:b,setShowNotifications:E}),u.jsxs("div",{className:`fixed left-0 right-0 bg-white dark:bg-gray-800 z-20 transition-transform duration-300 ${I==="down"?"-translate-y-full":"translate-y-0"}`,style:{top:"64px"},children:[u.jsx("div",{className:"border-b dark:border-gray-700",children:u.jsxs("div",{className:"flex items-center space-x-2 overflow-x-auto scrollbar-hide px-4 h-14",children:[u.jsx(Oi,{icon:u.jsx(Gs,{size:14}),label:"Rcents",active:d==="all",onClick:()=>h("all"),compact:!0}),s&&u.jsxs(u.Fragment,{children:[u.jsx(Oi,{icon:u.jsx(Sn,{size:14}),label:"Abonnements",active:d==="following",onClick:()=>h("following"),compact:!0}),u.jsx(Oi,{icon:u.jsx(Xu,{size:14}),label:"Favoris",active:d==="favorites",onClick:()=>h("favorites"),compact:!0})]})]})}),u.jsx("div",{className:"border-b dark:border-gray-700",children:u.jsxs("div",{className:"px-4 py-3",children:[u.jsxs("button",{onClick:()=>y(!_),className:"w-full flex items-center justify-between px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm text-gray-600 dark:text-gray-300",children:[u.jsx("span",{children:"Catgories"}),u.jsx(OA,{size:16,className:`transform transition-transform ${_?"rotate-180":""}`})]}),_&&u.jsx("div",{className:"mt-2",children:u.jsx(rO,{activeCategory:p,onCategoryChange:O=>{g(O),y(!1)},isMobile:!0})})]})})]}),u.jsx("div",{className:"pt-[144px] px-4 pb-20",children:u.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:P.length>0?P.map(O=>u.jsx(Nd,{recipe:O},O.id)):u.jsx("div",{className:"col-span-full text-center text-gray-500 dark:text-gray-400 py-8",children:d==="following"?u.jsx("p",{children:"Aucune recette de vos abonnements"}):d==="favorites"?u.jsx("p",{children:"Aucune recette dans vos favoris"}):u.jsx("p",{children:"Aucune recette disponible"})})})}),v&&u.jsx(k1,{onClose:()=>T(!1),onRecipeClick:O=>{t(`/recipe/${O}`),T(!1)},onUserClick:O=>{t(`/user/${O}`),T(!1)}}),b&&u.jsx(T1,{onClose:()=>E(!1)})]})},b1=C.createContext(void 0),aO=({children:t})=>{const{user:e}=_e(),[n,r]=C.useState({notifications:{recipes:!0,comments:!0,reminders:!0},privacy:{profileVisibility:"public",recipeDefaultVisibility:"public"},dietary:{preferences:(e==null?void 0:e.dietary)||[],allergies:[],restrictions:[]},theme:"light"}),s=l=>{r(d=>({...d,notifications:{...d.notifications,...l}}))},i=l=>{r(d=>({...d,privacy:{...d.privacy,...l}}))},o=l=>{r(d=>({...d,dietary:{...d.dietary,...l}}))},a=l=>{r(d=>({...d,theme:l}))};return u.jsx(b1.Provider,{value:{...n,updateNotifications:s,updatePrivacy:i,updateDietary:o,updateTheme:a},children:t})},A1=()=>{const t=C.useContext(b1);if(t===void 0)throw new Error("useSettings must be used within a SettingsProvider");return t},Vc=({label:t,description:e,checked:n,onChange:r})=>u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900",children:t}),e&&u.jsx("p",{className:"text-sm text-gray-500",children:e})]}),u.jsx("button",{type:"button",className:`${n?"bg-emerald-600":"bg-gray-200"} relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2`,role:"switch","aria-checked":n,onClick:()=>r(!n),children:u.jsx("span",{className:`${n?"translate-x-5":"translate-x-0"} pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out`})})]}),lO=()=>{const{notifications:t,updateNotifications:e}=A1();return u.jsxs("div",{className:"space-y-4",children:[u.jsx(Vc,{label:"Nouvelles recettes",description:"Recevez des notifications lorsque les personnes que vous suivez publient de nouvelles recettes",checked:t.recipes,onChange:n=>e({recipes:n})}),u.jsx(Vc,{label:"Commentaires",description:"Recevez des notifications pour les commentaires sur vos recettes",checked:t.comments,onChange:n=>e({comments:n})}),u.jsx(Vc,{label:"Rappels de repas",description:"Recevez des rappels pour vos repas planifis",checked:t.reminders,onChange:n=>e({reminders:n})})]})},V_=({label:t,value:e,onChange:n,options:r})=>u.jsxs("div",{className:"space-y-3",children:[u.jsx("label",{className:"text-sm font-medium text-gray-900",children:t}),u.jsx("div",{className:"space-y-2",children:r.map(s=>u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"radio",id:`${t}-${s.value}`,name:t,value:s.value,checked:e===s.value,onChange:i=>n(i.target.value),className:"h-4 w-4 border-gray-300 text-emerald-600 focus:ring-emerald-500"}),u.jsxs("label",{htmlFor:`${t}-${s.value}`,className:"ml-3",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.label}),s.description&&u.jsx("p",{className:"text-sm text-gray-500",children:s.description})]})]},s.value))})]}),cO=()=>{const{privacy:t,updatePrivacy:e}=A1();return u.jsxs("div",{className:"space-y-6",children:[u.jsx(V_,{label:"Visibilit du profil",value:t.profileVisibility,onChange:n=>e({profileVisibility:n}),options:[{value:"public",label:"Public",description:"Tout le monde peut voir votre profil"},{value:"private",label:"Priv",description:"Seuls vos abonns peuvent voir votre profil"}]}),u.jsx(V_,{label:"Visibilit par dfaut des recettes",value:t.recipeDefaultVisibility,onChange:n=>e({recipeDefaultVisibility:n}),options:[{value:"public",label:"Public",description:"Les nouvelles recettes sont publiques par dfaut"},{value:"private",label:"Priv",description:"Les nouvelles recettes sont prives par dfaut"}]})]})},R1=C.createContext(void 0),uO=({children:t})=>{const[e,n]=C.useState(()=>{const i=localStorage.getItem("theme");return i==="dark"||i==="light"?i:"light"}),[r,s]=C.useState(()=>localStorage.getItem("accentColor")||"orange");return C.useEffect(()=>{const i=window.document.documentElement;i.classList.remove("light","dark"),i.classList.add(e),localStorage.setItem("theme",e)},[e]),C.useEffect(()=>{window.document.documentElement.setAttribute("data-accent",r),localStorage.setItem("accentColor",r)},[r]),u.jsx(R1.Provider,{value:{theme:e,setTheme:n,accentColor:r,setAccentColor:s},children:t})},dO=()=>{const t=C.useContext(R1);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},hO=[{name:"orange",label:"Orange",class:"bg-orange-500"},{name:"emerald",label:"Vert",class:"bg-emerald-500"},{name:"blue",label:"Bleu",class:"bg-blue-500"},{name:"purple",label:"Violet",class:"bg-purple-500"},{name:"red",label:"Rouge",class:"bg-red-500"},{name:"indigo",label:"Indigo",class:"bg-indigo-500"}],fO=({currentTheme:t,currentAccent:e,onThemeChange:n,onAccentChange:r})=>u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-4",children:"Thme"}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("button",{type:"button",onClick:()=>n("light"),className:`flex items-center justify-center p-4 border rounded-lg text-sm ${t==="light"?"border-accent bg-accent/10 text-accent":"border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[u.jsx(qA,{size:16,className:"mr-2"}),"Clair"]}),u.jsxs("button",{type:"button",onClick:()=>n("dark"),className:`flex items-center justify-center p-4 border rounded-lg text-sm ${t==="dark"?"border-accent bg-accent/10 text-accent":"border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[u.jsx(UA,{size:16,className:"mr-2"}),"Sombre"]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-4",children:"Couleur d'accent"}),u.jsx("div",{className:"flex flex-wrap gap-3",children:hO.map(({name:s,label:i,class:o})=>u.jsx("button",{type:"button",onClick:()=>r(s),className:"relative",title:i,children:u.jsx("span",{className:`block w-8 h-8 rounded-full ${o} transition-transform ${e===s?"ring-2 ring-offset-2 ring-gray-900 dark:ring-gray-100 dark:ring-offset-gray-800 scale-110":"hover:scale-110"}`})},s))})]})]}),pO=({onClose:t})=>{const[e,n]=C.useState(""),[r,s]=C.useState(""),[i,o]=C.useState(""),[a,l]=C.useState("idle"),[d,h]=C.useState(""),p=async g=>{if(g.preventDefault(),!(!e||!r||!i)){if(r!==i){h("Les mots de passe ne correspondent pas");return}if(r.length<6){h("Le nouveau mot de passe doit contenir au moins 6 caractres");return}l("loading"),h("");try{const v=fr.currentUser;if(!(v!=null&&v.email))throw new Error("User not found");const T=Xs.credential(v.email,e);await QD(v,T),await ej(v,r),l("success")}catch(v){switch(console.error("Error changing password:",v),l("error"),v.code){case"auth/wrong-password":h("Mot de passe actuel incorrect");break;case"auth/weak-password":h("Le nouveau mot de passe est trop faible");break;default:h("Une erreur est survenue. Veuillez ressayer.")}}}};return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg w-full max-w-md",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold dark:text-white",children:"Changer le mot de passe"}),u.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:u.jsx(Jr,{size:20})})]}),u.jsx("div",{className:"p-4",children:a==="success"?u.jsxs("div",{className:"text-center py-4",children:[u.jsx("div",{className:"text-green-500 dark:text-green-400 mb-2",children:"Mot de passe modifi avec succs !"}),u.jsx("button",{onClick:t,className:"mt-4 px-4 py-2 bg-accent text-white rounded-lg hover:bg-accent-dark",children:"Fermer"})]}):u.jsxs("form",{onSubmit:p,className:"space-y-4",children:[d&&u.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-lg text-sm",children:d}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Mot de passe actuel"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Es,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"password",value:e,onChange:g=>n(g.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-accent focus:border-accent bg-white dark:bg-gray-700 dark:text-white",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nouveau mot de passe"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Es,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"password",value:r,onChange:g=>s(g.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-accent focus:border-accent bg-white dark:bg-gray-700 dark:text-white",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Confirmer le nouveau mot de passe"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Es,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"password",value:i,onChange:g=>o(g.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-accent focus:border-accent bg-white dark:bg-gray-700 dark:text-white",required:!0})]})]}),u.jsxs("div",{className:"flex justify-end space-x-3",children:[u.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:"Annuler"}),u.jsx("button",{type:"submit",disabled:a==="loading",className:"px-4 py-2 bg-accent text-white rounded-lg hover:bg-accent-dark disabled:opacity-50",children:a==="loading"?"Modification...":"Modifier"})]})]})})]})})},N1=({onClose:t})=>{const{user:e,updateProfile:n}=_e(),{theme:r,accentColor:s,setTheme:i,setAccentColor:o}=dO(),[a,l]=C.useState({name:(e==null?void 0:e.displayName)||"",email:(e==null?void 0:e.email)||"",bio:(e==null?void 0:e.bio)||"",phone:(e==null?void 0:e.phone)||"",location:(e==null?void 0:e.location)||""}),[d,h]=C.useState(null),[p,g]=C.useState(!1),[v,T]=C.useState(!1),[b,E]=C.useState(!1),_=O=>{const{name:L,value:S}=O.target;l(x=>({...x,[L]:S})),g(!0),h(null)},y=O=>{i(O),g(!0)},I=O=>{o(O),g(!0)},P=async O=>{if(O.preventDefault(),!(!e||!p)){T(!0),h(null);try{await n({displayName:a.name,bio:a.bio,phone:a.phone,location:a.location}),g(!1),t()}catch(L){console.error("Failed to update profile:",L),h("Une erreur est survenue lors de la mise  jour du profil. Veuillez ressayer.")}finally{T(!1)}}};return e?u.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 overflow-y-auto",children:[u.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg w-full max-w-2xl",children:[u.jsxs("div",{className:"flex items-center justify-between p-6 border-b dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold dark:text-white",children:"Modifier le profil"}),u.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:u.jsx(Jr,{size:20})})]}),u.jsxs("form",{onSubmit:P,className:"p-6 space-y-6",children:[d&&u.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-lg",children:d}),u.jsx("div",{className:"flex justify-center mb-8",children:u.jsxs("div",{className:"relative",children:[u.jsx("img",{src:e.photoURL||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.uid}`,alt:"Profile",className:"w-24 h-24 rounded-full object-cover"}),u.jsx("button",{type:"button",className:"absolute bottom-0 right-0 bg-accent text-white p-2 rounded-full shadow-lg hover:bg-accent-dark transition-colors",children:u.jsx(au,{size:16})})]})}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nom complet"}),u.jsx("input",{type:"text",name:"name",value:a.name,onChange:_,className:"w-full px-4 py-2",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email"}),u.jsx("input",{type:"email",name:"email",value:a.email,disabled:!0,className:"w-full px-4 py-2 bg-gray-100 dark:bg-gray-700 cursor-not-allowed"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Bio"}),u.jsx("textarea",{name:"bio",value:a.bio,onChange:_,rows:3,className:"w-full px-4 py-2 resize-none"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Tlphone"}),u.jsx("input",{type:"tel",name:"phone",value:a.phone,onChange:_,className:"w-full px-4 py-2"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Localisation"}),u.jsx("input",{type:"text",name:"location",value:a.location,onChange:_,className:"w-full px-4 py-2"})]}),u.jsxs("button",{type:"button",onClick:()=>E(!0),className:"flex items-center space-x-2 text-accent hover:text-accent-dark",children:[u.jsx(Es,{size:16}),u.jsx("span",{children:"Changer le mot de passe"})]})]}),u.jsx("div",{className:"mt-8",children:u.jsx(fO,{currentTheme:r,currentAccent:s,onThemeChange:y,onAccentChange:I})}),u.jsxs("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t dark:border-gray-700",children:[u.jsx("button",{type:"button",onClick:t,className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Annuler"}),u.jsx("button",{type:"submit",disabled:!p||v,className:`px-6 py-2 rounded-md text-white ${p&&!v?"bg-accent hover:bg-accent-dark":"bg-gray-400 cursor-not-allowed"}`,children:v?"Enregistrement...":"Enregistrer"})]})]})]})}),b&&u.jsx(pO,{onClose:()=>E(!1)})]}):null},C1=({conversations:t,selectedId:e,onSelect:n})=>t.length===0?u.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:"Aucune conversation"}):u.jsx("div",{className:"divide-y dark:divide-gray-700",children:t.map(r=>u.jsxs("button",{onClick:()=>n(r.id),className:`w-full p-4 flex items-start space-x-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ${e===r.id?"bg-gray-50 dark:bg-gray-700":""}`,children:[u.jsx("img",{src:r.userAvatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${r.userId}`,alt:r.userName,className:"w-10 h-10 rounded-full flex-shrink-0"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"font-medium text-gray-900 dark:text-white truncate",children:r.subject||"Sans titre"}),u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:ro(r.lastMessageAt)})]}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:r.lastMessage}),u.jsxs("div",{className:"flex items-center mt-1 space-x-2",children:[u.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${r.status==="open"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}`,children:r.status==="open"?"En cours":"Termin"}),u.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${r.type==="bug"?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400":r.type==="improvement"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}`,children:r.type==="bug"?"Bug":r.type==="improvement"?"Amlioration":"Autre"})]})]})]},r.id))}),mO=({conversationId:t,onBack:e})=>{const[n,r]=C.useState([]),[s,i]=C.useState(null),[o,a]=C.useState(""),[l,d]=C.useState(!1),{user:h}=_e(),p=C.useRef(null),g=(h==null?void 0:h.email)==="theo.labadie@outlook.com";C.useEffect(()=>{(async()=>{var P,O;const I=await Qa(Me(re,"conversations",t));I.exists()&&i({id:I.id,...I.data(),createdAt:(P=I.data().createdAt)==null?void 0:P.toDate(),lastMessageAt:(O=I.data().lastMessageAt)==null?void 0:O.toDate()})})();const E=Ge(re,"messages"),_=Ys(E,gl("conversationId","==",t),Id("createdAt","asc")),y=ku(_,I=>{const P=I.docs.map(O=>{var L;return{id:O.id,...O.data(),createdAt:((L=O.data().createdAt)==null?void 0:L.toDate())||new Date}});r(P),v()});return()=>y()},[t]);const v=()=>{p.current&&p.current.scrollIntoView({behavior:"smooth"})},T=async b=>{if(b.preventDefault(),!(!h||l||!o.trim()||!s)&&!(!g&&s.status==="closed")){d(!0);try{const E=Ge(re,"messages"),_={conversationId:t,content:o,senderId:h.uid,senderName:h.displayName,senderAvatar:h.photoURL||`https://api.dicebear.com/7.x/avataaars/svg?seed=${h.uid}`,createdAt:bt(),read:!1};await Kr(E,_);const y=Me(re,"conversations",t);await kt(y,{lastMessage:o,lastMessageAt:bt()}),a(""),v()}catch(E){console.error("Error sending message:",E)}finally{d(!1)}}};return s?u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsxs("div",{className:"border-b dark:border-gray-700 p-4 flex items-center justify-between",children:[u.jsx("button",{onClick:e,className:"lg:hidden text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:u.jsx(ol,{size:20})}),u.jsxs("div",{children:[u.jsx("h2",{className:"font-medium text-gray-900 dark:text-white",children:s.subject}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:ro(s.createdAt)}),u.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${s.status==="open"?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}`,children:s.status==="open"?"En cours":"Termin"})]})]})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[n.map(b=>u.jsx("div",{className:`flex ${b.senderId===(h==null?void 0:h.uid)?"justify-end":"justify-start"}`,children:u.jsxs("div",{className:"flex items-end space-x-2",children:[b.senderId!==(h==null?void 0:h.uid)&&u.jsx("img",{src:b.senderAvatar,alt:b.senderName,className:"w-8 h-8 rounded-full"}),u.jsxs("div",{className:`max-w-[70%] rounded-lg p-3 ${b.senderId===(h==null?void 0:h.uid)?"bg-accent text-white":"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white"}`,children:[u.jsx("p",{children:b.content}),u.jsxs("div",{className:"flex items-center justify-between mt-1 text-xs opacity-75",children:[u.jsx("span",{children:b.senderName}),u.jsx("span",{children:ro(b.createdAt)})]})]})]})},b.id)),u.jsx("div",{ref:p})]}),(g||s.status==="open")&&u.jsx("form",{onSubmit:T,className:"p-4 border-t dark:border-gray-700",children:u.jsxs("div",{className:"flex space-x-2",children:[u.jsx("input",{type:"text",value:o,onChange:b=>a(b.target.value),placeholder:s.status==="closed"&&!g?"Cette conversation est termine":"crivez votre message...",className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-accent focus:border-accent dark:bg-gray-700 dark:text-white",disabled:s.status==="closed"&&!g}),u.jsx("button",{type:"submit",disabled:l||!o.trim()||s.status==="closed"&&!g,className:"p-2 bg-accent text-white rounded-lg hover:bg-accent-dark disabled:opacity-50 disabled:cursor-not-allowed",children:u.jsx(pm,{size:20})})]})})]}):null},O_=[{value:"improvement",label:"Suggrer une amlioration"},{value:"bug",label:"Signaler un bug"},{value:"other",label:"Autre"}],gO=({onSubmit:t,onCancel:e})=>{const{user:n}=_e(),[r,s]=C.useState(""),[i,o]=C.useState(O_[0].value),[a,l]=C.useState(""),[d,h]=C.useState(!1),p=async g=>{if(g.preventDefault(),!(d||!a.trim()||!r.trim())){h(!0);try{await t(r,a,i)}catch(v){console.error("Error submitting message:",v)}finally{h(!1)}}};return n?u.jsxs("form",{onSubmit:p,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nom"}),u.jsx("input",{type:"text",value:n.displayName||"",disabled:!0,className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-gray-900 dark:text-white cursor-not-allowed"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Sujet"}),u.jsx("input",{type:"text",value:r,onChange:g=>s(g.target.value),required:!0,className:"w-full px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md text-gray-900 dark:text-white focus:ring-accent focus:border-accent",placeholder:"Rsum de votre demande"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Catgorie"}),u.jsx("select",{value:i,onChange:g=>o(g.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md text-gray-900 dark:text-white focus:ring-accent focus:border-accent",children:O_.map(g=>u.jsx("option",{value:g.value,children:g.label},g.value))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Message"}),u.jsx("textarea",{value:a,onChange:g=>l(g.target.value),rows:4,required:!0,className:"w-full px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md text-gray-900 dark:text-white focus:ring-accent focus:border-accent resize-none",placeholder:"Comment pouvons-nous vous aider ?"})]}),u.jsxs("div",{className:"flex justify-end space-x-3",children:[u.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:"Annuler"}),u.jsx("button",{type:"submit",disabled:d||!a.trim()||!r.trim(),className:"px-4 py-2 bg-accent text-white rounded-md hover:bg-accent-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Envoi...":"Envoyer"})]})]}):null},yO=({onClose:t})=>{const[e,n]=C.useState("list"),[r,s]=C.useState(null),[i,o]=C.useState([]),{user:a}=_e();C.useEffect(()=>{if(!a)return;(async()=>{try{const g=Ge(re,"conversations"),v=Ys(g,gl("userId","==",a.uid)),b=(await Ja(v)).docs.map(E=>{var _,y;return{id:E.id,...E.data(),createdAt:(_=E.data().createdAt)==null?void 0:_.toDate(),lastMessageAt:(y=E.data().lastMessageAt)==null?void 0:y.toDate()}});b.sort((E,_)=>{var y,I;return(((y=_.lastMessageAt)==null?void 0:y.getTime())||0)-(((I=E.lastMessageAt)==null?void 0:I.getTime())||0)}),o(b)}catch(g){console.error("Error fetching conversations:",g)}})()},[a]);const l=p=>{s(p),n("conversation")},d=()=>{n("new")},h=()=>{n("list"),s(null)};return u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg w-full max-w-2xl h-[80vh] flex flex-col overflow-hidden",onClick:p=>p.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold dark:text-white",children:"Aide et support"}),u.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:u.jsx(Jr,{size:20})})]}),u.jsxs("div",{className:"flex-1 min-h-0",children:[e==="list"&&u.jsxs("div",{className:"h-full flex flex-col",children:[u.jsx("div",{className:"p-4 border-b dark:border-gray-700",children:u.jsx("button",{onClick:d,className:"w-full px-4 py-2 text-white bg-accent rounded-lg hover:bg-accent-dark transition-colors",children:"Nouvelle conversation"})}),u.jsx("div",{className:"flex-1 overflow-y-auto",children:u.jsx(C1,{conversations:i,selectedId:r,onSelect:l})})]}),e==="conversation"&&r&&u.jsx(mO,{conversationId:r,onBack:h}),e==="new"&&u.jsx("div",{className:"h-full overflow-y-auto p-4",children:u.jsx(gO,{onSubmit:async(p,g,v)=>{if(a)try{const T=Ge(re,"conversations"),b=await Kr(T,{userId:a.uid,userName:a.displayName,userAvatar:a.photoURL||`https://api.dicebear.com/7.x/avataaars/svg?seed=${a.uid}`,subject:p,type:v,status:"open",createdAt:bt(),lastMessageAt:bt(),lastMessage:g}),E=Ge(re,"messages");await Kr(E,{conversationId:b.id,content:g,senderId:a.uid,senderName:a.displayName,senderAvatar:a.photoURL||`https://api.dicebear.com/7.x/avataaars/svg?seed=${a.uid}`,createdAt:bt()}),s(b.id),n("conversation")}catch(T){console.error("Error creating conversation:",T)}},onCancel:h})})]})]})})},vO=({users:t,recipes:e,onClose:n})=>{const r=i=>e.filter(o=>o.authorId===i).length,s=[...t].sort((i,o)=>{const a=r(i.uid);return r(o.uid)-a});return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg w-full max-w-2xl",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold dark:text-white",children:"Liste des utilisateurs"}),u.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:u.jsx(Jr,{size:20})})]}),u.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:u.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:s.map(i=>u.jsxs("div",{className:"flex items-center p-4 hover:bg-gray-50 dark:hover:bg-gray-700",children:[u.jsx("img",{src:i.photoURL||`https://api.dicebear.com/7.x/avataaars/svg?seed=${i.uid}`,alt:i.displayName||"",className:"w-10 h-10 rounded-full"}),u.jsxs("div",{className:"ml-4 flex-1",children:[u.jsx("h3",{className:"font-medium dark:text-white",children:i.displayName}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:i.email})]}),u.jsxs("div",{className:"flex items-center text-gray-500 dark:text-gray-400",children:[u.jsx(ja,{size:16,className:"mr-1"}),u.jsxs("span",{children:[r(i.uid)," recettes"]})]})]},i.uid))})})]})})},_O=()=>{const[t,e]=C.useState({totalRecipes:0,totalUsers:0}),[n,r]=C.useState(!0),[s,i]=C.useState(!1),{recipes:o}=fn(),{users:a}=_e();return C.useEffect(()=>{(async()=>{try{const d=Ge(re,"recipes"),h=Ge(re,"users"),[p,g]=await Promise.all([a_(d),a_(h)]);e({totalRecipes:p.data().count,totalUsers:g.data().count})}catch(d){console.error("Error fetching stats:",d)}finally{r(!1)}})()},[]),n?u.jsx("div",{className:"grid grid-cols-2 gap-4",children:[1,2].map(l=>u.jsxs("div",{className:"bg-gray-100 dark:bg-gray-700/50 rounded-lg p-4 animate-pulse",children:[u.jsx("div",{className:"h-6 w-24 bg-gray-200 dark:bg-gray-600 rounded mb-2"}),u.jsx("div",{className:"h-8 w-16 bg-gray-200 dark:bg-gray-600 rounded"})]},l))}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center space-x-2 text-accent mb-2",children:[u.jsx(ja,{size:20}),u.jsx("h3",{className:"font-medium",children:"Total Recettes"})]}),u.jsx("p",{className:"text-2xl font-bold dark:text-white",children:t.totalRecipes})]}),u.jsxs("button",{onClick:()=>i(!0),className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 text-left hover:bg-gray-100 dark:hover:bg-gray-600/50 transition-colors",children:[u.jsxs("div",{className:"flex items-center space-x-2 text-accent mb-2",children:[u.jsx(Sn,{size:20}),u.jsx("h3",{className:"font-medium",children:"Total Utilisateurs"})]}),u.jsx("p",{className:"text-2xl font-bold dark:text-white",children:t.totalUsers})]})]}),s&&u.jsx(vO,{users:a,recipes:o,onClose:()=>i(!1)})]})},M_=({title:t,onClose:e,children:n})=>u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg w-full max-w-md",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold dark:text-white",children:t}),u.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400",children:u.jsx(Jr,{size:20})})]}),u.jsx("div",{className:"p-4",children:n})]})}),wO=()=>{const[t,e]=C.useState(null),{user:n,signOut:r}=_e(),s=Vt();if(!n)return s("/auth"),null;const i=n.email==="theo.labadie@outlook.com",o=()=>e(null),a=async()=>{try{await r(),s("/")}catch(l){console.error("Error signing out:",l)}};return u.jsxs("div",{className:"flex-1 overflow-y-auto pb-20 pt-16",children:[u.jsxs("div",{className:"bg-white dark:bg-gray-800",children:[u.jsxs("div",{className:"p-6 flex items-center space-x-4 border-b border-gray-100 dark:border-gray-700",children:[u.jsxs("div",{className:"relative",children:[u.jsx("img",{src:n.photoURL||`https://api.dicebear.com/7.x/avataaars/svg?seed=${n.uid}`,alt:"Profile",className:"w-20 h-20 rounded-full object-cover"}),u.jsx("button",{onClick:()=>e("profile"),className:"absolute bottom-0 right-0 bg-accent p-2 rounded-full text-white",children:u.jsx(au,{size:16})})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("h2",{className:"text-xl font-semibold dark:text-white",children:n.displayName}),u.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:n.email})]})]}),i&&u.jsxs("div",{className:"p-6 border-b border-gray-100 dark:border-gray-700",children:[u.jsxs("h2",{className:"text-lg font-semibold mb-4 dark:text-white flex items-center",children:[u.jsx(VA,{className:"mr-2"}),"Statistiques"]}),u.jsx(_O,{})]}),u.jsxs("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:[u.jsxs("button",{onClick:()=>e("profile"),className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(qi,{className:"text-gray-500 dark:text-gray-400",size:20}),u.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:"Modifier le profil"})]}),u.jsx(Oo,{className:"text-gray-400",size:20})]}),u.jsxs("button",{onClick:()=>e("notifications"),className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(hm,{className:"text-gray-500 dark:text-gray-400",size:20}),u.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:"Notifications"})]}),u.jsx(Oo,{className:"text-gray-400",size:20})]}),u.jsxs("button",{onClick:()=>e("privacy"),className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(Es,{className:"text-gray-500 dark:text-gray-400",size:20}),u.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:"Confidentialit"})]}),u.jsx(Oo,{className:"text-gray-400",size:20})]}),i&&u.jsxs("button",{onClick:()=>s("/admin/messages"),className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(FA,{className:"text-accent",size:20}),u.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:"Messages Admin"}),u.jsx("span",{className:"bg-orange-500 text-white text-xs px-2 py-1 rounded-full",children:"Admin"})]}),u.jsx(Oo,{className:"text-gray-400",size:20})]}),u.jsxs("button",{onClick:()=>e("help"),className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(MA,{className:"text-gray-500 dark:text-gray-400",size:20}),u.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:"Aide et support"})]}),u.jsx(Oo,{className:"text-gray-400",size:20})]})]}),u.jsx("div",{className:"p-4",children:u.jsxs("button",{onClick:a,className:"w-full flex items-center justify-center space-x-2 p-3 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/10 rounded-lg transition-colors",children:[u.jsx(LA,{size:20}),u.jsx("span",{children:"Dconnexion"})]})})]}),t==="notifications"&&u.jsx(M_,{title:"Notifications",onClose:o,children:u.jsx(lO,{})}),t==="privacy"&&u.jsx(M_,{title:"Confidentialit",onClose:o,children:u.jsx(cO,{})}),t==="profile"&&u.jsx(N1,{onClose:o}),t==="help"&&u.jsx(yO,{onClose:o})]})},P1=({onImageSelect:t,defaultImage:e})=>{const n=C.useRef(null),[r,s]=Lr.useState(null),i=o=>{var l;const a=(l=o.target.files)==null?void 0:l[0];if(a){t(a);const d=new FileReader;d.onloadend=()=>{s(d.result)},d.readAsDataURL(a)}};return u.jsxs("div",{onClick:()=>{var o;return(o=n.current)==null?void 0:o.click()},className:"relative w-full h-48 bg-gray-100 dark:bg-gray-800 rounded-lg cursor-pointer overflow-hidden",children:[r||e?u.jsx("img",{src:r||e,alt:"Recipe preview",className:"w-full h-full object-cover"}):u.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:u.jsx(au,{size:48,className:"text-gray-400"})}),u.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 hover:bg-opacity-20 transition-opacity flex items-center justify-center",children:u.jsx(au,{size:24,className:"text-white opacity-0 hover:opacity-100 transition-opacity"})}),u.jsx("input",{ref:n,type:"file",accept:"image/*",onChange:i,className:"hidden"})]})},L_="https://images.unsplash.com/photo-1495521821757-a1efb6729352?auto=format&fit=crop&q=80&w=800&h=600",xO=[{value:"soup",label:"Soupe"},{value:"starter",label:"Entre"},{value:"main",label:"Plat"},{value:"dessert",label:"Dessert"},{value:"other",label:"Autre"}],EO=()=>{const t=Vt(),{addRecipe:e}=fn(),[n,r]=C.useState(!1),[s,i]=C.useState(""),[o,a]=C.useState(""),[l,d]=C.useState(15),[h,p]=C.useState(30),[g,v]=C.useState(4),[T,b]=C.useState([{id:"1",name:"",amount:"",unit:"g"}]),[E,_]=C.useState([""]),[y,I]=C.useState(null),[P,O]=C.useState(!1),[L,S]=C.useState("main"),x=ee=>{I(ee)},k=()=>{b([...T,{id:Date.now().toString(),name:"",amount:"",unit:"g"}])},R=ee=>{T.length>1&&b(T.filter(ue=>ue.id!==ee))},N=(ee,ue,F)=>{b(T.map(K=>K.id===ee?{...K,[ue]:F}:K))},D=()=>{_([...E,""])},A=ee=>{E.length>1&&_(E.filter((ue,F)=>F!==ee))},rt=(ee,ue)=>{_(E.map((F,K)=>K===ee?ue:F))},Zt=async ee=>{if(ee.preventDefault(),!n)try{r(!0);const ue=T.filter(J=>J.name.trim()).map(J=>`${J.amount}${J.unit} ${J.name}`),F={title:s,description:o,prepTime:l,cookTime:h,servings:g,ingredients:ue,steps:E.filter(J=>J.trim()),imageUrl:L_,isPrivate:P,category:L},K=await e(F);t(`/recipe/${K}`)}catch(ue){console.error("Error creating recipe:",ue)}finally{r(!1)}};return u.jsx("div",{className:"flex-1 overflow-y-auto pb-20 pt-16",children:u.jsxs("form",{onSubmit:Zt,className:"max-w-2xl mx-auto p-4 space-y-6",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsx(P1,{onImageSelect:x,defaultImage:L_}),u.jsx("input",{type:"text",placeholder:"Nom de la recette",value:s,onChange:ee=>i(ee.target.value),className:"w-full text-2xl font-bold border-none focus:ring-0 placeholder-gray-400 dark:bg-gray-800 dark:text-white",required:!0}),u.jsx("textarea",{placeholder:"Description",value:o,onChange:ee=>a(ee.target.value),className:"w-full h-20 resize-none border rounded-lg p-2 focus:ring-accent focus:border-accent dark:bg-gray-800 dark:text-white",required:!0}),u.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Gs,{size:20,className:"text-gray-500"}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-500",children:"Prparation (min)"}),u.jsx("input",{type:"number",value:l,onChange:ee=>d(Number(ee.target.value)),className:"w-full border rounded p-1 dark:bg-gray-800 dark:text-white",min:"0",required:!0})]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(fm,{size:20,className:"text-gray-500"}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-500",children:"Cuisson (min)"}),u.jsx("input",{type:"number",value:h,onChange:ee=>p(Number(ee.target.value)),className:"w-full border rounded p-1 dark:bg-gray-800 dark:text-white",min:"0",required:!0})]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Sn,{size:20,className:"text-gray-500"}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-500",children:"Portions"}),u.jsx("input",{type:"number",value:g,onChange:ee=>v(Number(ee.target.value)),className:"w-full border rounded p-1 dark:bg-gray-800 dark:text-white",min:"1",required:!0})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Catgorie"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Ki,{size:16,className:"text-gray-400"})}),u.jsx("select",{value:L,onChange:ee=>S(ee.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-accent focus:border-accent dark:bg-gray-800 dark:text-white",required:!0,children:xO.map(ee=>u.jsx("option",{value:ee.value,children:ee.label},ee.value))})]})]}),u.jsx(Vc,{label:"Recette prive",description:"Seul vous pourrez voir cette recette",checked:P,onChange:O})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"text-lg font-semibold dark:text-white",children:"Ingrdients"}),u.jsx("button",{type:"button",onClick:k,className:"text-accent hover:text-accent-dark",children:u.jsx(Va,{size:20})})]}),T.map(ee=>u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("input",{type:"text",placeholder:"Nom de l'ingrdient",value:ee.name,onChange:ue=>N(ee.id,"name",ue.target.value),className:"flex-1 border rounded p-2 dark:bg-gray-800 dark:text-white",required:!0}),u.jsx("input",{type:"text",placeholder:"Quantit",value:ee.amount,onChange:ue=>N(ee.id,"amount",ue.target.value),className:"w-20 border rounded p-2 dark:bg-gray-800 dark:text-white",required:!0}),u.jsxs("select",{value:ee.unit,onChange:ue=>N(ee.id,"unit",ue.target.value),className:"w-24 border rounded p-2 dark:bg-gray-800 dark:text-white",children:[u.jsx("option",{value:"g",children:"g"}),u.jsx("option",{value:"kg",children:"kg"}),u.jsx("option",{value:"ml",children:"ml"}),u.jsx("option",{value:"l",children:"l"}),u.jsx("option",{value:"c..c",children:"c..c"}),u.jsx("option",{value:"c..s",children:"c..s"}),u.jsx("option",{value:"tasse",children:"tasse"}),u.jsx("option",{value:"pice",children:"pice"})]}),u.jsx("button",{type:"button",onClick:()=>R(ee.id),className:"text-red-500 hover:text-red-700",children:u.jsx(lu,{size:20})})]},ee.id))]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"text-lg font-semibold dark:text-white",children:"Instructions"}),u.jsx("button",{type:"button",onClick:D,className:"text-accent hover:text-accent-dark",children:u.jsx(Va,{size:20})})]}),E.map((ee,ue)=>u.jsxs("div",{className:"flex items-start space-x-2",children:[u.jsxs("span",{className:"mt-2 text-gray-500",children:[ue+1,"."]}),u.jsx("textarea",{value:ee,onChange:F=>rt(ue,F.target.value),placeholder:"Dcrivez cette tape...",className:"flex-1 border rounded p-2 min-h-[80px] resize-none dark:bg-gray-800 dark:text-white",required:!0}),u.jsx("button",{type:"button",onClick:()=>A(ue),className:"text-red-500 hover:text-red-700",children:u.jsx(lu,{size:20})})]},ue))]}),u.jsx("button",{type:"submit",disabled:n,className:`fixed bottom-24 right-4 p-4 rounded-full shadow-lg transition-colors ${n?"bg-gray-400 cursor-not-allowed":"bg-accent hover:bg-accent-dark"} text-white`,children:u.jsx(mE,{size:24})})]})})},IO=[{value:"soup",label:"Soupe"},{value:"starter",label:"Entre"},{value:"main",label:"Plat"},{value:"dessert",label:"Dessert"},{value:"other",label:"Autre"}],TO=()=>{const{id:t}=dm(),e=Vt(),{recipes:n,updateRecipe:r}=fn(),s=n.find(F=>F.id===t),[i,o]=C.useState(!1),a=F=>F.map((K,J)=>{const ne=K.match(/^(\d+(?:\.\d+)?)\s*([a-zA-Z.]+)\s+(.+)$/);return ne?{id:J.toString(),amount:ne[1],unit:ne[2],name:ne[3]}:{id:J.toString(),amount:"",unit:"g",name:K}}),[l,d]=C.useState((s==null?void 0:s.title)||""),[h,p]=C.useState((s==null?void 0:s.description)||""),[g,v]=C.useState((s==null?void 0:s.prepTime)||15),[T,b]=C.useState((s==null?void 0:s.cookTime)||30),[E,_]=C.useState((s==null?void 0:s.servings)||4),[y,I]=C.useState((s==null?void 0:s.category)||"main"),[P,O]=C.useState(s?a(s.ingredients):[{id:"1",name:"",amount:"",unit:"g"}]),[L,S]=C.useState((s==null?void 0:s.steps)||[""]),[x,k]=C.useState(null);if(C.useEffect(()=>{s||e("/my-recipes")},[s,e]),!s)return null;const R=F=>{k(F)},N=()=>{O([...P,{id:Date.now().toString(),name:"",amount:"",unit:"g"}])},D=F=>{P.length>1&&O(P.filter(K=>K.id!==F))},A=(F,K,J)=>{O(P.map(ne=>ne.id===F?{...ne,[K]:J}:ne))},rt=()=>{S([...L,""])},Zt=F=>{L.length>1&&S(L.filter((K,J)=>J!==F))},ee=(F,K)=>{S(L.map((J,ne)=>ne===F?K:J))},ue=async F=>{if(F.preventDefault(),!i)try{o(!0);const K=P.filter(ne=>ne.name.trim()).map(ne=>`${ne.amount}${ne.unit} ${ne.name}`),J={title:l,description:h,prepTime:g,cookTime:T,servings:E,category:y,ingredients:K,steps:L.filter(ne=>ne.trim())};await r(s.id,J),e(`/recipe/${s.id}`)}catch(K){console.error("Error updating recipe:",K)}finally{o(!1)}};return u.jsx("div",{className:"flex-1 overflow-y-auto pb-20 pt-16",children:u.jsxs("form",{onSubmit:ue,className:"max-w-2xl mx-auto p-4 space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("button",{type:"button",onClick:()=>e(-1),className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200",children:u.jsx(ol,{size:24})}),u.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Modifier la recette"}),u.jsx("div",{className:"w-6"})," "]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx(P1,{onImageSelect:R,defaultImage:s.imageUrl}),u.jsx("input",{type:"text",placeholder:"Nom de la recette",value:l,onChange:F=>d(F.target.value),className:"w-full text-2xl font-bold border-none focus:ring-0 placeholder-gray-400 dark:bg-gray-800 dark:text-white",required:!0}),u.jsx("textarea",{placeholder:"Description",value:h,onChange:F=>p(F.target.value),className:"w-full h-20 resize-none border rounded-lg p-2 focus:ring-accent focus:border-accent dark:bg-gray-800 dark:text-white",required:!0}),u.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Gs,{size:20,className:"text-gray-500"}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-500",children:"Prparation (min)"}),u.jsx("input",{type:"number",value:g,onChange:F=>v(Number(F.target.value)),className:"w-full border rounded p-1 dark:bg-gray-800 dark:text-white",min:"0",required:!0})]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(fm,{size:20,className:"text-gray-500"}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-500",children:"Cuisson (min)"}),u.jsx("input",{type:"number",value:T,onChange:F=>b(Number(F.target.value)),className:"w-full border rounded p-1 dark:bg-gray-800 dark:text-white",min:"0",required:!0})]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Sn,{size:20,className:"text-gray-500"}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-500",children:"Portions"}),u.jsx("input",{type:"number",value:E,onChange:F=>_(Number(F.target.value)),className:"w-full border rounded p-1 dark:bg-gray-800 dark:text-white",min:"1",required:!0})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Catgorie"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Ki,{size:16,className:"text-gray-400"})}),u.jsx("select",{value:y,onChange:F=>I(F.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-accent focus:border-accent dark:bg-gray-800 dark:text-white",required:!0,children:IO.map(F=>u.jsx("option",{value:F.value,children:F.label},F.value))})]})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"text-lg font-semibold dark:text-white",children:"Ingrdients"}),u.jsx("button",{type:"button",onClick:N,className:"text-accent hover:text-accent-dark",children:u.jsx(Va,{size:20})})]}),P.map(F=>u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("input",{type:"text",placeholder:"Nom de l'ingrdient",value:F.name,onChange:K=>A(F.id,"name",K.target.value),className:"flex-1 border rounded p-2 dark:bg-gray-800 dark:text-white",required:!0}),u.jsx("input",{type:"text",placeholder:"Quantit",value:F.amount,onChange:K=>A(F.id,"amount",K.target.value),className:"w-20 border rounded p-2 dark:bg-gray-800 dark:text-white",required:!0}),u.jsxs("select",{value:F.unit,onChange:K=>A(F.id,"unit",K.target.value),className:"w-24 border rounded p-2 dark:bg-gray-800 dark:text-white",children:[u.jsx("option",{value:"g",children:"g"}),u.jsx("option",{value:"kg",children:"kg"}),u.jsx("option",{value:"ml",children:"ml"}),u.jsx("option",{value:"l",children:"l"}),u.jsx("option",{value:"c..c",children:"c..c"}),u.jsx("option",{value:"c..s",children:"c..s"}),u.jsx("option",{value:"tasse",children:"tasse"}),u.jsx("option",{value:"pice",children:"pice"})]}),u.jsx("button",{type:"button",onClick:()=>D(F.id),className:"text-red-500 hover:text-red-700",children:u.jsx(lu,{size:20})})]},F.id))]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"text-lg font-semibold dark:text-white",children:"Instructions"}),u.jsx("button",{type:"button",onClick:rt,className:"text-accent hover:text-accent-dark",children:u.jsx(Va,{size:20})})]}),L.map((F,K)=>u.jsxs("div",{className:"flex items-start space-x-2",children:[u.jsxs("span",{className:"mt-2 text-gray-500",children:[K+1,"."]}),u.jsx("textarea",{value:F,onChange:J=>ee(K,J.target.value),placeholder:"Dcrivez cette tape...",className:"flex-1 border rounded p-2 min-h-[80px] resize-none dark:bg-gray-800 dark:text-white",required:!0}),u.jsx("button",{type:"button",onClick:()=>Zt(K),className:"text-red-500 hover:text-red-700",children:u.jsx(lu,{size:20})})]},K))]}),u.jsx("button",{type:"submit",disabled:i,className:`fixed bottom-24 right-4 p-4 rounded-full shadow-lg transition-colors ${i?"bg-gray-400 cursor-not-allowed":"bg-accent hover:bg-accent-dark"} text-white`,children:u.jsx(mE,{size:24})})]})})},SO=({onClose:t})=>{const[e,n]=C.useState(""),[r,s]=C.useState("idle"),[i,o]=C.useState(""),a=async l=>{if(l.preventDefault(),!!e.trim()){s("loading"),o("");try{await JD(fr,e),s("success")}catch(d){switch(console.error("Error sending reset email:",d),s("error"),d.code){case"auth/user-not-found":o("Aucun compte associ  cet email");break;case"auth/invalid-email":o("Email invalide");break;default:o("Une erreur est survenue. Veuillez ressayer.")}}}};return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg w-full max-w-md",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[u.jsx("h2",{className:"text-lg font-semibold dark:text-white",children:"Rinitialiser le mot de passe"}),u.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:u.jsx(Jr,{size:20})})]}),u.jsx("div",{className:"p-4",children:r==="success"?u.jsxs("div",{className:"text-center py-4",children:[u.jsx("div",{className:"text-green-500 dark:text-green-400 mb-2",children:"Email envoy !"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Consultez votre bote mail pour rinitialiser votre mot de passe."}),u.jsx("button",{onClick:t,className:"mt-4 px-4 py-2 bg-accent text-white rounded-lg hover:bg-accent-dark",children:"Fermer"})]}):u.jsxs("form",{onSubmit:a,children:[u.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"Entrez votre adresse email pour recevoir un lien de rinitialisation."}),i&&u.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-lg text-sm",children:i}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(pE,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"email",value:e,onChange:l=>n(l.target.value),placeholder:"Adresse email",className:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-accent focus:border-accent bg-white dark:bg-gray-700 dark:text-white",required:!0})]}),u.jsxs("div",{className:"mt-4 flex justify-end space-x-3",children:[u.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:"Annuler"}),u.jsx("button",{type:"submit",disabled:r==="loading",className:"px-4 py-2 bg-accent text-white rounded-lg hover:bg-accent-dark disabled:opacity-50",children:r==="loading"?"Envoi...":"Envoyer"})]})]})})]})})},kO=()=>{const[t,e]=C.useState(!1),[n,r]=C.useState(""),[s,i]=C.useState(""),[o,a]=C.useState(""),[l,d]=C.useState(""),[h,p]=C.useState(!1),[g,v]=C.useState(!1),{signIn:T,signUp:b}=_e(),E=Vt(),_=async y=>{y.preventDefault(),d(""),p(!0);try{if(t){if(!o)throw new Error("Le nom est requis");await b(n,s,o)}else await T(n,s);E("/")}catch(I){switch(console.error("Auth error:",I),I.code){case"auth/invalid-credential":d("Email ou mot de passe incorrect");break;case"auth/email-already-in-use":d("Cet email est dj utilis");break;case"auth/weak-password":d("Le mot de passe doit contenir au moins 6 caractres");break;case"auth/invalid-email":d("Email invalide");break;default:d("Une erreur est survenue. Veuillez ressayer.")}}finally{p(!1)}};return u.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:[u.jsxs("div",{className:"max-w-md w-full space-y-8",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("h1",{className:"text-3xl font-bold text-accent mb-2",children:"Recet'Up"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t?"Crer un compte":"Se connecter"})]}),u.jsxs("form",{className:"mt-8 space-y-6",onSubmit:_,children:[l&&u.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 p-3 rounded-lg text-sm",children:l}),u.jsxs("div",{className:"space-y-4",children:[t&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"name",className:"sr-only",children:"Nom complet"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(qi,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{id:"name",name:"name",type:"text",required:t,value:o,onChange:y=>a(y.target.value),className:"appearance-none relative block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-white rounded-lg focus:outline-none focus:ring-accent focus:border-accent bg-white dark:bg-gray-800",placeholder:"Nom complet"})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"email",className:"sr-only",children:"Adresse email"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(pE,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:n,onChange:y=>r(y.target.value),className:"appearance-none relative block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-white rounded-lg focus:outline-none focus:ring-accent focus:border-accent bg-white dark:bg-gray-800",placeholder:"Adresse email"})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"password",className:"sr-only",children:"Mot de passe"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Es,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{id:"password",name:"password",type:"password",autoComplete:t?"new-password":"current-password",required:!0,value:s,onChange:y=>i(y.target.value),className:"appearance-none relative block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-white rounded-lg focus:outline-none focus:ring-accent focus:border-accent bg-white dark:bg-gray-800",placeholder:"Mot de passe"})]})]})]}),!t&&u.jsx("div",{className:"flex justify-end",children:u.jsx("button",{type:"button",onClick:()=>v(!0),className:"text-sm text-accent hover:text-accent-dark",children:"Mot de passe oubli ?"})}),u.jsx("div",{children:u.jsxs("button",{type:"submit",disabled:h,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-accent hover:bg-accent-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent disabled:opacity-50 disabled:cursor-not-allowed",children:[h?u.jsx("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:u.jsx("div",{className:"h-5 w-5 border-2 border-white border-t-transparent rounded-full animate-spin"})}):u.jsx("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:t?u.jsx(KA,{className:"h-5 w-5 text-white","aria-hidden":"true"}):u.jsx(fE,{className:"h-5 w-5 text-white","aria-hidden":"true"})}),t?"Crer un compte":"Se connecter"]})}),u.jsx("div",{className:"text-center",children:u.jsx("button",{type:"button",onClick:()=>{e(!t),d("")},className:"text-accent hover:text-accent-dark text-sm",children:t?"Dj un compte ? Se connecter":"Pas de compte ? S'inscrire"})})]})]}),g&&u.jsx(SO,{onClose:()=>v(!1)})]})},bO=({recipeId:t,initialRating:e=0,totalRatings:n=0,userRating:r=0,className:s=""})=>{const[i,o]=C.useState(null),[a,l]=C.useState(!1),{rateRecipe:d}=fn(),{user:h}=_e(),p=async v=>{if(!(!h||a))try{l(!0),await d(t,v)}catch(T){console.error("Error submitting rating:",T)}finally{l(!1)}},g=v=>{const T=i!==null?v<=i:v<=(r||e);return u.jsx("button",{onClick:()=>p(v),onMouseEnter:()=>o(v),onMouseLeave:()=>o(null),disabled:!h||a,className:`text-2xl transition-colors ${T?"text-yellow-400":"text-gray-300"} hover:text-yellow-400 disabled:cursor-not-allowed`,children:u.jsx($A,{className:"w-6 h-6",fill:T?"currentColor":"none"})},v)};return u.jsxs("div",{className:`flex items-center space-x-2 ${s}`,children:[u.jsx("div",{className:"flex",children:[1,2,3,4,5].map(v=>g(v))}),u.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.toFixed(1)," (",n," avis)"]})]})},AO=async(t,e,n)=>{try{const r=Ge(re,`recipes/${t}/comments`);await Kr(r,{recipeId:t,userId:n.uid,userName:n.displayName,userAvatar:n.photoURL||`https://api.dicebear.com/7.x/avataaars/svg?seed=${n.uid}`,content:e.content,parentId:e.parentId||null,createdAt:bt()})}catch(r){throw console.error("Error adding comment:",r),r}},RO=async t=>{try{const e=Ge(re,`recipes/${t}/comments`),n=Ys(e,Id("createdAt","desc"));return(await Ja(n)).docs.map(s=>{var i;return{id:s.id,...s.data(),createdAt:((i=s.data().createdAt)==null?void 0:i.toDate())||new Date}})}catch(e){throw console.error("Error fetching comments:",e),e}},NO=async(t,e)=>{try{await OT(Me(re,`recipes/${t}/comments/${e}`))}catch(n){throw console.error("Error deleting comment:",n),n}},D1=C.createContext(void 0),CO=({children:t})=>{const[e,n]=C.useState([]),[r,s]=C.useState(!1),[i,o]=C.useState(null),{user:a}=_e(),l=C.useCallback(async p=>{s(!0),o(null);try{const g=await RO(p);n(g)}catch(g){console.error("Error fetching comments:",g),o("Failed to load comments. Please try again later.")}finally{s(!1)}},[]),d=async(p,g)=>{if(!a)throw new Error("Must be logged in to comment");o(null);try{await AO(p,g,a),await l(p)}catch(v){throw console.error("Error adding comment:",v),o("Failed to add comment. Please try again."),v}},h=async(p,g)=>{if(a){o(null);try{await NO(p,g),n(v=>v.filter(T=>T.id!==g))}catch(v){throw console.error("Error deleting comment:",v),o("Failed to delete comment. Please try again."),v}}};return u.jsx(D1.Provider,{value:{comments:e,loading:r,error:i,addComment:d,deleteComment:h,fetchComments:l},children:t})},xg=()=>{const t=C.useContext(D1);if(t===void 0)throw new Error("useComments must be used within a CommentProvider");return t},PO=({comments:t,onReply:e,onCommentDeleted:n})=>{const{user:r}=_e(),{deleteComment:s,error:i}=xg();if(i)return u.jsx("div",{className:"text-center text-red-500 dark:text-red-400 py-4",children:i});const o=t.filter(d=>!d.parentId),a=d=>t.filter(h=>h.parentId===d),l=({comment:d,isReply:h=!1})=>{const p=(r==null?void 0:r.uid)===d.userId,g=a(d.id),v=async()=>{window.confirm("Are you sure you want to delete this comment?")&&(await s(d.recipeId,d.id),n())};return u.jsxs("div",{className:`${h?"ml-12":""}`,children:[u.jsxs("div",{className:"flex space-x-3",children:[u.jsx("img",{src:d.userAvatar,alt:d.userName,className:"w-8 h-8 rounded-full"}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:d.userName}),p&&u.jsx("button",{onClick:v,className:"text-red-500 hover:text-red-600",children:u.jsx(yE,{size:16})})]}),u.jsx("p",{className:"text-gray-700 dark:text-gray-300 mt-1",children:d.content})]}),u.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm",children:[u.jsxs("button",{onClick:()=>e(d.id),className:"flex items-center space-x-1 text-gray-500 hover:text-gray-700",children:[u.jsx(zA,{size:14}),u.jsx("span",{children:"Reply"})]}),u.jsx("span",{className:"text-gray-400",children:ro(d.createdAt)})]})]})]}),g.length>0&&u.jsx("div",{className:"mt-4 space-y-4",children:g.map(T=>u.jsx(l,{comment:T,isReply:!0},T.id))})]})};return u.jsx("div",{className:"space-y-6",children:o.length>0?o.map(d=>u.jsx(l,{comment:d},d.id)):u.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:u.jsx("p",{children:"No comments yet. Be the first to comment!"})})})},F_=({recipeId:t,parentId:e,onSuccess:n})=>{const[r,s]=C.useState(""),[i,o]=C.useState(!1),{addComment:a,error:l}=xg(),d=async h=>{if(h.preventDefault(),!(!r.trim()||i)){o(!0);try{const p={content:r.trim(),parentId:e};await a(t,p),s(""),n==null||n()}catch(p){console.error("Error submitting comment:",p)}finally{o(!1)}}};return u.jsxs("form",{onSubmit:d,className:"space-y-2",children:[l&&u.jsx("p",{className:"text-red-500 dark:text-red-400 text-sm",children:l}),u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx("div",{className:"flex-1",children:u.jsx("textarea",{value:r,onChange:h=>s(h.target.value),placeholder:"Add a comment...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-accent focus:border-accent dark:bg-gray-700 dark:text-white resize-none",rows:2})}),u.jsx("button",{type:"submit",disabled:!r.trim()||i,className:"px-4 py-2 bg-accent text-white rounded-lg hover:bg-accent-dark disabled:opacity-50 disabled:cursor-not-allowed",children:u.jsx(pm,{size:20})})]})]})},DO=({recipeId:t})=>{const{user:e}=_e(),{comments:n,fetchComments:r}=xg(),[s,i]=Lr.useState(null);return C.useEffect(()=>{t&&r(t)},[t,r]),e?u.jsxs("div",{className:"space-y-6",children:[u.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Commentaires (",n.length,")"]}),u.jsx(F_,{recipeId:t,onSuccess:()=>{i(null),r(t)}}),s&&u.jsx("div",{className:"mt-4 ml-12",children:u.jsx(F_,{recipeId:t,parentId:s,onSuccess:()=>{i(null),r(t)}})}),u.jsx(PO,{comments:n,onReply:i,onCommentDeleted:()=>r(t)})]}):u.jsx("div",{className:"text-center py-8",children:u.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Connectez-vous pour commenter cette recette"})})},U_="https://images.unsplash.com/photo-1495521821757-a1efb6729352?auto=format&fit=crop&q=80&w=800&h=600",jO={soup:"Soupe",starter:"Entre",main:"Plat",dessert:"Dessert",other:"Autre"},VO=()=>{var b;const{id:t}=dm(),e=Vt(),{recipes:n,deleteRecipe:r,toggleFavorite:s,favorites:i}=fn(),{user:o,users:a}=_e(),l=n.find(E=>E.id===t),d=a.find(E=>E.uid===(l==null?void 0:l.authorId));if(C.useEffect(()=>{l||e("/")},[l,e]),!l)return null;const h=(o==null?void 0:o.uid)===l.authorId,p=i.includes(t||""),g=async()=>{if(window.confirm("tes-vous sr de vouloir supprimer cette recette ?"))try{await r(l.id),e("/")}catch(E){console.error("Error deleting recipe:",E)}},v=async()=>{try{await s(l.id)}catch(E){console.error("Error toggling favorite:",E)}},T=E=>{E.currentTarget.src=U_};return u.jsxs("div",{className:"flex-1 overflow-y-auto pb-20 pt-16",children:[u.jsxs("div",{className:"relative h-96",children:[u.jsx("img",{src:l.imageUrl||U_,alt:l.title,className:"w-full h-full object-cover",onError:T}),u.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),u.jsxs("div",{className:"absolute top-4 left-4 right-4 flex justify-between items-center",children:[u.jsx("button",{onClick:()=>e(-1),className:"p-2 rounded-full bg-white/90 dark:bg-gray-800/90 text-gray-700 dark:text-gray-300 hover:bg-white dark:hover:bg-gray-700",children:u.jsx(ol,{size:24})}),o&&u.jsxs("div",{className:"flex items-center space-x-2",children:[h&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>e(`/recipe/${l.id}/edit`),className:"p-2 rounded-full bg-white/90 dark:bg-gray-800/90 text-gray-700 dark:text-gray-300 hover:bg-white dark:hover:bg-gray-700",children:u.jsx(gE,{size:24})}),u.jsx("button",{onClick:g,className:"p-2 rounded-full bg-white/90 dark:bg-gray-800/90 text-red-500 hover:bg-white dark:hover:bg-gray-700",children:u.jsx(yE,{size:24})})]}),u.jsx("button",{onClick:v,className:"p-2 rounded-full bg-white/90 dark:bg-gray-800/90 text-gray-700 dark:text-gray-300 hover:bg-white dark:hover:bg-gray-700",children:u.jsx(Xu,{size:24,className:p?"fill-red-500 text-red-500":""})})]})]})]}),u.jsx("div",{className:"px-4 py-6 -mt-12 relative",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:l.title}),u.jsxs("div",{className:"flex items-center space-x-2",children:[l.isPrivate&&u.jsx("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded-full text-sm",children:"Priv"}),u.jsxs("span",{className:"px-2 py-1 bg-accent text-white rounded-full text-sm flex items-center",children:[u.jsx(Ki,{size:12,className:"mr-1"}),jO[l.category]]})]})]}),u.jsx("div",{className:"flex items-center space-x-4 mb-6",children:u.jsxs("button",{onClick:()=>e(`/user/${l.authorId}`),className:"flex items-center space-x-2 text-accent hover:text-accent-dark",children:[u.jsx("img",{src:(d==null?void 0:d.photoURL)||`https://api.dicebear.com/7.x/avataaars/svg?seed=${l.authorId}`,alt:(d==null?void 0:d.displayName)||"",className:"w-8 h-8 rounded-full"}),u.jsx("span",{className:"font-medium",children:(d==null?void 0:d.displayName)||"Utilisateur"})]})}),u.jsxs("div",{className:"flex items-center space-x-6 text-gray-500 dark:text-gray-400 mb-6",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(Gs,{size:20,className:"mr-2"}),u.jsxs("span",{children:[l.prepTime+l.cookTime," min"]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx(fm,{size:20,className:"mr-2"}),u.jsxs("span",{children:[l.prepTime," min"]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx(Sn,{size:20,className:"mr-2"}),u.jsxs("span",{children:[l.servings," portions"]})]})]}),u.jsx(bO,{recipeId:l.id,initialRating:l.rating,totalRatings:l.totalRatings,userRating:(b=l.userRatings)==null?void 0:b[(o==null?void 0:o.uid)||""],className:"mb-6"}),u.jsx("div",{className:"prose dark:prose-invert max-w-none mb-8",children:u.jsx("p",{children:l.description})}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Ingrdients"}),u.jsx("ul",{className:"space-y-2",children:l.ingredients.map((E,_)=>u.jsxs("li",{className:"flex items-center text-gray-700 dark:text-gray-300",children:[u.jsx("span",{className:"w-2 h-2 bg-accent rounded-full mr-3"}),E]},_))})]}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Instructions"}),u.jsx("ol",{className:"space-y-4",children:l.steps.map((E,_)=>u.jsxs("li",{className:"flex",children:[u.jsx("span",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-accent text-white flex items-center justify-center mr-3",children:_+1}),u.jsx("p",{className:"text-gray-700 dark:text-gray-300 mt-1",children:E})]},_))})]}),u.jsx("div",{className:"mt-8 pt-8 border-t dark:border-gray-700",children:u.jsx(DO,{recipeId:l.id})})]})})]})},OO=()=>{const{recipes:t,fetchRecipes:e}=fn(),{user:n}=_e(),[r,s]=C.useState("recent");C.useEffect(()=>{e()},[e]);const i=t.filter(a=>a.authorId===(n==null?void 0:n.uid)),o=Lr.useMemo(()=>{let a=[...i];switch(r){case"public":a=a.filter(l=>!l.isPrivate);break;case"private":a=a.filter(l=>l.isPrivate);break}return a.sort((l,d)=>d.createdAt.getTime()-l.createdAt.getTime())},[i,r]);return n?u.jsxs("div",{className:"flex-1 overflow-y-auto pb-20",children:[u.jsx("div",{className:"fixed top-16 left-0 right-0 bg-white dark:bg-gray-800 z-10",children:u.jsx("div",{className:"flex items-center justify-between px-4 py-3 border-b dark:border-gray-700",children:u.jsxs("div",{className:"flex items-center space-x-2 overflow-x-auto scrollbar-hide",children:[u.jsx(Oi,{icon:u.jsx(Gs,{size:16}),label:"Rcentes",active:r==="recent",onClick:()=>s("recent")}),u.jsx(Oi,{icon:u.jsx(hE,{size:16}),label:"Publiques",active:r==="public",onClick:()=>s("public")}),u.jsx(Oi,{icon:u.jsx(Es,{size:16}),label:"Prives",active:r==="private",onClick:()=>s("private")})]})})}),u.jsx("div",{className:"pt-28 px-4",children:u.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:o.length>0?o.map(a=>u.jsx(Nd,{recipe:a},a.id)):u.jsx("div",{className:"col-span-full text-center text-gray-500 dark:text-gray-400 py-8",children:r==="public"?u.jsx("p",{children:"Vous n'avez pas encore de recettes publiques"}):r==="private"?u.jsx("p",{children:"Vous n'avez pas encore de recettes prives"}):u.jsx("p",{children:"Vous n'avez pas encore cr de recettes"})})})})]}):u.jsx("div",{className:"flex-1 flex items-center justify-center",children:u.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Connectez-vous pour voir vos recettes"})})},MO=({user:t,showFollowButton:e=!0,onClick:n})=>{var d;const{user:r,followUser:s,unfollowUser:i}=_e();if(!r)return null;const o=(d=r.following)==null?void 0:d.includes(t.uid),a=r.uid===t.uid,l=async h=>{h.stopPropagation();try{o?await i(t.uid):await s(t.uid)}catch(p){console.error("Error toggling follow:",p)}};return u.jsxs("div",{onClick:n,className:`bg-white dark:bg-gray-800 rounded-lg p-4 flex items-center space-x-4 ${n?"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700":""}`,children:[u.jsx("img",{src:t.photoURL||`https://api.dicebear.com/7.x/avataaars/svg?seed=${t.uid}`,alt:t.displayName||"",className:"w-12 h-12 rounded-full object-cover"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:"font-semibold dark:text-white truncate",children:t.displayName}),t.bio&&u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:t.bio})]}),e&&!a&&u.jsx("button",{onClick:l,className:`px-4 py-2 rounded-full text-sm font-medium ${o?"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white hover:bg-gray-200 dark:hover:bg-gray-600":"bg-accent text-white hover:bg-accent-dark"}`,children:o?"Abonn":"S'abonner"})]})},LO=()=>{const t=Vt(),{user:e,users:n}=_e();if(!e)return u.jsx("div",{className:"flex-1 flex items-center justify-center",children:u.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Connectez-vous pour voir vos abonnements"})});const r=n.filter(s=>{var i;return(i=e.following)==null?void 0:i.includes(s.uid)});return u.jsx("div",{className:"flex-1 overflow-y-auto pb-20 pt-16",children:u.jsxs("div",{className:"p-4",children:[u.jsx("h2",{className:"text-2xl font-bold mb-4 dark:text-white",children:"Abonnements"}),u.jsxs("div",{className:"space-y-4",children:[r.map(s=>u.jsx(MO,{user:s,onClick:()=>t(`/user/${s.uid}`)},s.uid)),r.length===0&&u.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 mt-8",children:u.jsx("p",{children:"Vous ne suivez personne pour le moment"})})]})]})})},FO=()=>{const{recipes:t,favorites:e,fetchRecipes:n}=fn();C.useEffect(()=>{n()},[n]);const r=t.filter(s=>e.includes(s.id));return u.jsx("div",{className:"flex-1 overflow-y-auto pb-20 pt-16",children:u.jsxs("div",{className:"p-4 grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[r.map(s=>u.jsx(Nd,{recipe:s},s.id)),r.length===0&&u.jsx("div",{className:"col-span-full text-center text-gray-500 dark:text-gray-400 py-8",children:u.jsx("p",{children:"Vous n'avez pas encore de recettes favorites"})})]})})},UO=()=>{var T,b;const{id:t}=dm(),e=Vt(),{users:n,user:r,followUser:s,unfollowUser:i}=_e(),{recipes:o}=fn(),[a,l]=C.useState(!1),d=n.find(E=>E.uid===t);if(!d)return u.jsx("div",{className:"flex-1 flex items-center justify-center",children:u.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Utilisateur non trouv"})});const h=(r==null?void 0:r.uid)===d.uid,p=(T=r==null?void 0:r.following)==null?void 0:T.includes(d.uid),g=o.filter(E=>E.authorId===d.uid&&(!E.isPrivate||h)),v=async()=>{try{p?await i(d.uid):await s(d.uid)}catch(E){console.error("Error toggling follow:",E)}};return u.jsxs("div",{className:"flex-1 overflow-y-auto pb-20 pt-16",children:[u.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-sm",children:u.jsxs("div",{className:"relative px-4 py-6",children:[u.jsx("button",{onClick:()=>e(-1),className:"absolute left-4 top-4 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200",children:u.jsx(ol,{size:24})}),h&&u.jsx("button",{onClick:()=>l(!0),className:"absolute right-4 top-4 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200",children:u.jsx(gE,{size:24})}),u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("img",{src:d.photoURL||`https://api.dicebear.com/7.x/avataaars/svg?seed=${d.uid}`,alt:d.displayName||"",className:"w-24 h-24 rounded-full object-cover mb-4"}),u.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",children:d.displayName}),d.bio&&u.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-4",children:d.bio}),u.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-600 dark:text-gray-400 mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(Sn,{size:16,className:"mr-1"}),u.jsxs("span",{children:[((b=d.followers)==null?void 0:b.length)||0," abonns"]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx(Sn,{size:16,className:"mr-1"}),u.jsxs("span",{children:[g.length," recettes"]})]})]}),!h&&r&&u.jsx("button",{onClick:v,className:`px-6 py-2 rounded-full text-sm font-medium ${p?"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white hover:bg-gray-200 dark:hover:bg-gray-600":"bg-accent text-white hover:bg-accent-dark"}`,children:p?"Abonn":"S'abonner"})]})]})}),u.jsxs("div",{className:"p-4",children:[u.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:"Recettes"}),u.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:g.map(E=>u.jsx(Nd,{recipe:E},E.id))}),g.length===0&&u.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 mt-8",children:u.jsx("p",{children:"Aucune recette publie"})})]}),a&&u.jsx(N1,{onClose:()=>l(!1)})]})},zO=({messages:t})=>{const{user:e}=_e(),n=C.useRef(null);C.useEffect(()=>{var s;(s=n.current)==null||s.scrollIntoView({behavior:"smooth"})},[t]);const r=s=>{const i=s.senderId===(e==null?void 0:e.uid);return u.jsx("div",{className:`flex ${i?"justify-end":"justify-start"} mb-4`,children:u.jsxs("div",{className:"flex items-end",children:[!i&&u.jsx("img",{src:s.senderAvatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${s.senderId}`,alt:"Avatar",className:"w-8 h-8 rounded-full mr-2"}),u.jsxs("div",{className:`max-w-xs md:max-w-md lg:max-w-lg px-4 py-2 rounded-lg ${i?"bg-accent text-white rounded-br-none":"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white rounded-bl-none"}`,children:[!i&&u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:s.senderName}),u.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:s.content}),u.jsx("p",{className:"text-xs mt-1 opacity-70",children:ro(s.createdAt)})]}),i&&u.jsx("img",{src:s.senderAvatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${s.senderId}`,alt:"Avatar",className:"w-8 h-8 rounded-full ml-2"})]})},s.id)};return u.jsxs("div",{className:"flex-1 p-4 space-y-4 overflow-y-auto",children:[t.map(r),u.jsx("div",{ref:n})]})},BO=({onSend:t,disabled:e})=>{const[n,r]=C.useState(""),[s,i]=C.useState(!1),o=async a=>{if(a.preventDefault(),!(!n.trim()||s))try{i(!0),await t(n),r("")}catch(l){console.error("Error sending message:",l)}finally{i(!1)}};return u.jsx("form",{onSubmit:o,className:"border-t dark:border-gray-700 p-4",children:u.jsxs("div",{className:"flex items-end space-x-2",children:[u.jsx("textarea",{value:n,onChange:a=>r(a.target.value),placeholder:"crivez votre message...",className:"flex-1 resize-none border-gray-300 dark:border-gray-600 rounded-lg focus:border-accent focus:ring-accent dark:bg-gray-700 dark:text-white min-h-[80px]",disabled:e||s}),u.jsx("button",{type:"submit",disabled:e||s||!n.trim(),className:"px-4 py-2 bg-accent text-white rounded-lg hover:bg-accent-dark disabled:opacity-50",children:u.jsx(pm,{size:20})})]})})},$O=async(t,e,n)=>{try{await Kr(Ge(re,"messages"),{conversationId:t,senderId:e.uid,senderName:e.displayName,senderAvatar:e.photoURL,content:n,createdAt:bt()});const r=Me(re,"conversations",t);await kt(r,{lastMessage:n,lastMessageAt:bt()})}catch(r){throw console.error("Error adding message:",r),r}},qO=async(t,e)=>{try{const n=Me(re,"conversations",t);await kt(n,{status:e})}catch(n){throw console.error("Error updating conversation status:",n),n}},KO=()=>{var d;Vt();const{user:t}=_e(),[e,n]=C.useState([]),[r,s]=C.useState(null),[i,o]=C.useState([]);C.useEffect(()=>{if(!t)return;const h=ku(HV(),p=>{const g=p.docs.map(v=>{var T,b;return{id:v.id,...v.data(),createdAt:(T=v.data().createdAt)==null?void 0:T.toDate(),lastMessageAt:(b=v.data().lastMessageAt)==null?void 0:b.toDate()}});n(g)});return()=>h()},[t]),C.useEffect(()=>{if(!r)return;const h=ku(QV(r),p=>{const g=p.docs.map(v=>{var T;return{id:v.id,...v.data(),createdAt:(T=v.data().createdAt)==null?void 0:T.toDate()}});o(g)});return()=>h()},[r]);const a=async h=>{!t||!r||await $O(r,t,h)},l=async()=>{if(!r)return;const h=e.find(p=>p.id===r);h&&await qO(r,h.status==="open"?"closed":"open")};return u.jsxs("div",{className:"fixed inset-0 pt-16 pb-16 flex",children:[u.jsxs("div",{className:"w-80 border-r dark:border-gray-700 flex flex-col bg-white dark:bg-gray-800",children:[u.jsx("div",{className:"p-4 border-b dark:border-gray-700",children:u.jsx("h2",{className:"text-lg font-semibold dark:text-white",children:"Messages"})}),u.jsx("div",{className:"flex-1 overflow-y-auto",children:u.jsx(C1,{conversations:e,selectedId:r,onSelect:s})})]}),u.jsx("div",{className:"flex-1 flex flex-col bg-white dark:bg-gray-800",children:r?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"border-b dark:border-gray-700 p-4 flex items-center justify-between",children:[u.jsx("button",{onClick:()=>s(null),className:"lg:hidden text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:u.jsx(ol,{size:20})}),u.jsxs("button",{onClick:l,className:"px-3 py-1 rounded-full text-sm font-medium bg-accent text-white hover:bg-accent-dark",children:["Marquer comme ",((d=e.find(h=>h.id===r))==null?void 0:d.status)==="open"?"termin":"en cours"]})]}),u.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[u.jsx("div",{className:"flex-1 overflow-y-auto",children:u.jsx(zO,{messages:i})}),u.jsx("div",{className:"border-t dark:border-gray-700",children:u.jsx(BO,{onSend:a})})]})]}):u.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500 dark:text-gray-400",children:"Slectionnez une conversation"})})]})},ur=({children:t})=>localStorage.getItem("user")!==null?u.jsx(u.Fragment,{children:t}):u.jsx(bA,{to:"/auth",replace:!0});function GO(){return u.jsx(PA,{children:u.jsx(uO,{children:u.jsx(JV,{children:u.jsx(YV,{children:u.jsx(XV,{children:u.jsx(CO,{children:u.jsx(aO,{children:u.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col",children:[u.jsx(eO,{}),u.jsxs(RA,{children:[u.jsx(Gt,{path:"/",element:u.jsx(oO,{})}),u.jsx(Gt,{path:"/auth",element:u.jsx(kO,{})}),u.jsx(Gt,{path:"/recipe/:id",element:u.jsx(VO,{})}),u.jsx(Gt,{path:"/recipe/:id/edit",element:u.jsx(ur,{children:u.jsx(TO,{})})}),u.jsx(Gt,{path:"/settings",element:u.jsx(ur,{children:u.jsx(wO,{})})}),u.jsx(Gt,{path:"/create",element:u.jsx(ur,{children:u.jsx(EO,{})})}),u.jsx(Gt,{path:"/my-recipes",element:u.jsx(ur,{children:u.jsx(OO,{})})}),u.jsx(Gt,{path:"/favorites",element:u.jsx(ur,{children:u.jsx(FO,{})})}),u.jsx(Gt,{path:"/following",element:u.jsx(ur,{children:u.jsx(LO,{})})}),u.jsx(Gt,{path:"/user/:id",element:u.jsx(ur,{children:u.jsx(UO,{})})}),u.jsx(Gt,{path:"/admin/messages",element:u.jsx(ur,{children:u.jsx(KO,{})})})]}),u.jsx(tO,{})]})})})})})})})})}Zx(document.getElementById("root")).render(u.jsx(C.StrictMode,{children:u.jsx(GO,{})}));
